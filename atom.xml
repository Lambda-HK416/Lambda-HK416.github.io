<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lambda🍃</title>
  
  
  <link href="https://www.wikunkun.asia/atom.xml" rel="self"/>
  
  <link href="https://www.wikunkun.asia/"/>
  <updated>2025-05-02T10:12:39.358Z</updated>
  <id>https://www.wikunkun.asia/</id>
  
  <author>
    <name>Lambda</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>insightface环境配置</title>
    <link href="https://www.wikunkun.asia/posts/ac8465fc.html"/>
    <id>https://www.wikunkun.asia/posts/ac8465fc.html</id>
    <published>2025-04-28T11:32:24.000Z</published>
    <updated>2025-05-02T10:12:39.358Z</updated>
    
    <content type="html"><![CDATA[<h2 id="环境配置">环境配置</h2><p>创建conda环境</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create -n insightface python=3.8</span><br></pre></td></tr></table></figure><p>激活环境</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda activate insightface</span><br></pre></td></tr></table></figure><p>配置环境</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">conda install pytorch==1.10.0 torchvision==0.11.0 torchaudio==0.10.0 -c pytorch</span><br><span class="line">conda install cudatoolkit=11.3</span><br><span class="line">conda install cudnn==8.2.1</span><br><span class="line">pip install onnxruntime-gpu==1.14.1</span><br><span class="line">pip install opencv-contrib-python</span><br></pre></td></tr></table></figure><div class="tip bell"><p>注意安装<code>onnxruntime-gpu</code>记得去查询<code>CUDA</code>和<code>cuDNN</code>的版本对应关系<a href="https://onnxruntime.ai/docs/execution-providers/CUDA-ExecutionProvider.html">NVIDIA - CUDA | onnxruntime</a></p></div><h2 id="环境测试">环境测试</h2><p>创建文件<code>test.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> onnxruntime <span class="keyword">as</span> ort</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否有CUDA加速</span></span><br><span class="line">available_providers = ort.get_available_providers()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Available providers: <span class="subst">&#123;available_providers&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查当前设备是GPU还是CPU</span></span><br><span class="line">device = ort.get_device()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Current device: <span class="subst">&#123;device&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>查看运行结果(如果<code>Current device: GPU</code>,则表示正确)</p><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250428194655440.png" alt="image-20250428194655440"></p><p>创建文件<code>main.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> insightface</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = insightface.app.FaceAnalysis(providers=[<span class="string">&#x27;CUDAExecutionProvider&#x27;</span>])</span><br><span class="line">app.prepare(ctx_id=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;insightface 初始化成功&quot;</span>)</span><br></pre></td></tr></table></figure><details class="folding-tag" yellow><summary> 可能会遇到的问题 </summary>              <div class='content'>              <p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250428194842995.png" alt="image-20250428194842995"></p><p>修改代码为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在任何库导入前设置</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">&#x27;NO_ALBUMENTATIONS_UPDATE&#x27;</span>] = <span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="keyword">import</span> insightface</span><br><span class="line"></span><br><span class="line">app = insightface.app.FaceAnalysis(providers=[<span class="string">&#x27;CUDAExecutionProvider&#x27;</span>])</span><br><span class="line">app.prepare(ctx_id=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;insightface 初始化成功&quot;</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250428195113745.png" alt="image-20250428195113745"></p><p>配置成功</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;环境配置&quot;&gt;环境配置&lt;/h2&gt;
&lt;p&gt;创建conda环境&lt;/p&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span</summary>
        
      
    
    
    
    
  </entry>
  
  <entry>
    <title>深度学习环境搭建</title>
    <link href="https://www.wikunkun.asia/posts/d7842877.html"/>
    <id>https://www.wikunkun.asia/posts/d7842877.html</id>
    <published>2025-04-28T07:47:21.000Z</published>
    <updated>2025-05-02T10:12:39.361Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Anaconda安装">Anaconda安装</h2><p><a href="https://www.wikunkun.asia/posts/692adf87.html">Anaconda安装教程 | Lambda🍃</a></p><h2 id="Cuda安装">Cuda安装</h2><h3 id="检查当前电脑环境">检查当前电脑环境</h3><p>鼠标右键桌面,然后点击<code>NVIDIA控制面板</code></p><p><img src="https://lambda-image-1.pages.dev/20250428181817935.webp" alt="image-20250427210157553"></p><p>点击<code>系统信息</code></p><p><img src="https://lambda-image-1.pages.dev/20250428181817936.webp" alt="image-20250427210314766"></p><p>查看所支持的最大<code>cuda</code>版本(<strong>下载时的版本要小于或等于该版本</strong>)</p><p><img src="https://lambda-image-1.pages.dev/20250428181817937.webp" alt="image-20250427210336566"></p><h3 id="安装Cuda">安装Cuda</h3><p><a href="https://developer.nvidia.com/cuda-toolkit-archive">CUDA Toolkit Archive | NVIDIA Developer</a></p><p><img src="https://lambda-image-1.pages.dev/20250428181817938.webp" alt="image-20250428161014657"></p><h2 id="cuDNN安装">cuDNN安装</h2><p><a href="https://developer.nvidia.com/rdp/cudnn-archive">cuDNN Archive | NVIDIA Developer</a></p><p>安装与<code>Cuda</code>相对应的版本</p><p><img src="https://lambda-image-1.pages.dev/20250428181817939.webp" alt="image-20250428175319808"></p><p>解压下载的文件</p><p><img src="https://lambda-image-1.pages.dev/20250428181817940.webp" alt="image-20250428175637753"></p><p>把这里的文件全部丢到<code>cuda</code>的安装路径下，我的安装路径<code>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.7</code></p><p>为<code>cuDNN</code>添加环境变量,确保有以下环境变量</p><p><img src="https://lambda-image-1.pages.dev/20250428181817941.webp" alt="image-20250428180003397"></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;Anaconda安装&quot;&gt;Anaconda安装&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://www.wikunkun.asia/posts/692adf87.html&quot;&gt;Anaconda安装教程 | Lambda🍃&lt;/a&gt;&lt;/p&gt;
&lt;h2</summary>
        
      
    
    
    
    
  </entry>
  
  <entry>
    <title>PyTorch安装</title>
    <link href="https://www.wikunkun.asia/posts/c9383eae.html"/>
    <id>https://www.wikunkun.asia/posts/c9383eae.html</id>
    <published>2025-04-27T12:58:31.000Z</published>
    <updated>2025-05-02T10:12:39.356Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装">安装</h2><p><a href="https://pytorch.org/">PyTorch</a></p><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250427210127133.png" alt="image-20250427210127133"></p><p>查看</p><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250427210157553.png" alt="image-20250427210157553"></p><p>查看</p><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250427210314766.png" alt="image-20250427210314766"></p><p>查看</p><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250427210336566.png" alt="image-20250427210336566"></p><p>cuda版本要小于你显卡所支持的</p><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250427210500696.png" alt="image-20250427210500696"></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;安装&quot;&gt;安装&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://pytorch.org/&quot;&gt;PyTorch&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img</summary>
        
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Notebook配置</title>
    <link href="https://www.wikunkun.asia/posts/39b1e76d.html"/>
    <id>https://www.wikunkun.asia/posts/39b1e76d.html</id>
    <published>2025-04-06T08:36:06.000Z</published>
    <updated>2025-04-14T09:05:46.408Z</updated>
    
    <content type="html"><![CDATA[<h2 id="配置默认路径">配置默认路径</h2><p>生成配置文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter notebook --generate-config</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/20250414162142308.webp" alt="image-20250406163716586"></p><p>修改默认路径</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c.NotebookApp.notebook_dir = <span class="string">&#x27;D:\JupyterNotebook&#x27;</span></span><br></pre></td></tr></table></figure><p>修改快捷方式</p><p><img src="https://lambda-image-1.pages.dev/20250414162142309.webp" alt="image-20250406163852110"></p><p>删除<code>&quot;%USERPROFILE%/&quot;</code>后缀</p><p><img src="https://lambda-image-1.pages.dev/20250414162142310.webp" alt="image-20250406164047441"></p><h2 id="安装插件">安装插件</h2><p>首先得安装 <a href="https://github.com/ipython-contrib/jupyter_contrib_nbextensions">jupyter_contrib_nbextensions</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda install -c conda-forge jupyter_contrib_nbextensions</span><br><span class="line">jupyter contrib nbextension install --user</span><br></pre></td></tr></table></figure><p>安装图形化界面</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install -c conda-forge jupyter_nbextensions_configurator</span><br></pre></td></tr></table></figure><h3 id="代码美化插件">代码美化插件</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install -c conda-forge yapf</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/20250414162142311.webp" alt="image-20250406202447023"></p><h3 id="按标题折叠">按标题折叠</h3><p><img src="https://lambda-image-1.pages.dev/20250414162142312.webp" alt="image-20250406202551359"></p><h3 id="显示时间">显示时间</h3><p><img src="https://lambda-image-1.pages.dev/20250414162142313.webp" alt="image-20250406202629078"></p><h3 id="补全显示">补全显示</h3><p><img src="https://lambda-image-1.pages.dev/20250414162142314.webp" alt="image-20250406202713610"></p><h3 id="显示行号">显示行号</h3><p><img src="https://lambda-image-1.pages.dev/20250414162142315.webp" alt="image-20250406202749164"></p><p>变量检查器</p><p><img src="https://lambda-image-1.pages.dev/20250414162142316.webp" alt="image-20250406202814799"></p><h2 id="添加内核">添加内核</h2><p>在<code>Anaconda Prompt (Anaconda3)</code>中执行以下内容</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 ipykernel</span></span><br><span class="line">conda install ipykernel</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将环境注册到 Jupyter</span></span><br><span class="line">python -m ipykernel install --user --name 环境名称 --display-name <span class="string">&quot;内核显示名称&quot;</span></span><br></pre></td></tr></table></figure><h2 id="删除多余的内核">删除多余的内核</h2><p>列出所有已安装的内核</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">jupyter kernelspec list</span></span><br></pre></td></tr></table></figure><p>删除指定内核</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter kernelspec <span class="built_in">remove</span> 内核名称</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;配置默认路径&quot;&gt;配置默认路径&lt;/h2&gt;
&lt;p&gt;生成配置文件&lt;/p&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span</summary>
        
      
    
    
    
    <category term="开发环境搭建" scheme="https://www.wikunkun.asia/categories/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
    <category term="Python" scheme="https://www.wikunkun.asia/tags/Python/"/>
    
    <category term="Notebook" scheme="https://www.wikunkun.asia/tags/Notebook/"/>
    
  </entry>
  
  <entry>
    <title>Anaconda安装教程</title>
    <link href="https://www.wikunkun.asia/posts/692adf87.html"/>
    <id>https://www.wikunkun.asia/posts/692adf87.html</id>
    <published>2025-04-06T07:06:20.000Z</published>
    <updated>2025-04-28T11:45:49.431Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Anaconda的卸载">Anaconda的卸载</h2><p>打开<code>cmd</code>窗口,输入</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install anaconda-clean</span><br></pre></td></tr></table></figure><p>输入以下命令卸载</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anaconda-clean --<span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>找到<code>Anaconda</code>的安装目录点击<code>Uninstall-Anaconda3.exe</code></p><p><img src="https://lambda-image-1.pages.dev/20250414161825522.webp" alt="image-20250406150956481"></p><h2 id="Anaconda的安装">Anaconda的安装</h2><h3 id="清华源下载和安装">清华源下载和安装</h3><p>访问<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/">清华源的镜像</a>,下载<code>Anaconda3</code>(最好下载后面是带有年份的这种)</p><p><img src="https://lambda-image-1.pages.dev/20250414161825523.webp" alt="image-20250406201304156"></p><p>下载完成后打开,选择安装路径</p><p><img src="https://lambda-image-1.pages.dev/20250414161825524.webp" alt="image-20250406152815178"></p><p>勾选这两项</p><p><img src="https://lambda-image-1.pages.dev/20250414161825526.webp" alt="image-20250406152926348"></p><h3 id="验证是否安装成功">验证是否安装成功</h3><p>打开<code>cmd</code>窗口,输入以下命令</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda --version</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/20250414161825527.webp" alt="image-20250406153554937"></p><h2 id="环境配置">环境配置</h2><h3 id="Anaconda环境配置">Anaconda环境配置</h3><p>删除(或者清空)<code>.condarc</code>文件</p><p><img src="https://lambda-image-1.pages.dev/20250414161825528.webp" alt="image-20250406155009210"></p><p>生成对应的配置文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>在<code>.condarc</code>中写入以下内容(直接全部替换)</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">channels:</span><br><span class="line">  - defaults</span><br><span class="line">show_channel_urls: true</span><br><span class="line">default_channels:</span><br><span class="line">  - https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/anaconda/</span>pkgs/main</span><br><span class="line">  - https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/anaconda/</span>pkgs/r</span><br><span class="line">  - https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/anaconda/</span>pkgs/msys2</span><br><span class="line">custom_channels:</span><br><span class="line">  conda-forge: https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/anaconda/</span>cloud</span><br><span class="line">  pytorch: https:<span class="regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="regexp">/anaconda/</span>cloud</span><br></pre></td></tr></table></figure><p>使用下列命令清除索引缓存，并安装常用包测试一下。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda clean -i</span><br><span class="line">conda create -n myenv numpy</span><br></pre></td></tr></table></figure><h3 id="添加环境变量">添加环境变量</h3><p>将<code>Anaconda</code>安装目录下的<code>Scripts</code>路径添加到<code>Path</code>中</p><p><img src="https://lambda-image-1.pages.dev/20250427210642291.webp" alt="image-20250427195207246"></p><h3 id="pip环境配置">pip环境配置</h3><p>删除<code>pip</code>的残留配置(如果你之前有配置过<code>pip</code>的情况)</p><div class="tip bell"><p>以下的方法仅仅用于参考,最佳办法还是把之前的pip配置文件删除</p></div><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 移除全局 index-url</span></span><br><span class="line">pip config <span class="built_in">unset</span> global.index-url</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移除 trusted-host</span></span><br><span class="line">pip config <span class="built_in">unset</span> install.trusted-host</span><br></pre></td></tr></table></figure><p><code>pip</code>配置清华源</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置全局索引地址为清华源</span></span><br><span class="line">pip config <span class="built_in">set</span> global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"></span><br><span class="line"><span class="comment"># 信任清华源（避免 SSL 证书报错）</span></span><br><span class="line">pip config <span class="built_in">set</span> install.trusted-host pypi.tuna.tsinghua.edu.cn</span><br></pre></td></tr></table></figure><p>查看是否配置成功</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip config list</span><br></pre></td></tr></table></figure><h2 id="Anaconda的使用">Anaconda的使用</h2><div class="tip bell"><p>配置了清华源,在使用<code>anaconda</code>的时候记得把科学上网工具关闭,否则可能出现<code>SSL</code>错误</p></div><h3 id="创建虚拟环境">创建虚拟环境</h3><p>把<code>name</code>换成你要创建的虚拟环境的名称,并且指定<code>python</code>的版本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create -n name python=3.6</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/20250414161825529.webp" alt="image-20250406155159081"></p><p>验证安装环境是否创建成功</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda info --envs</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/20250414161825530.webp" alt="image-20250406155211564"></p><h3 id="进入和退出虚拟环境">进入和退出虚拟环境</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入虚拟环境，name 为环境名</span></span><br><span class="line">activate name</span><br><span class="line"></span><br><span class="line"><span class="comment">#退出虚拟环境</span></span><br><span class="line">deactivate</span><br><span class="line"></span><br><span class="line"><span class="comment">#删除虚拟环境，需要先退出到base环境</span></span><br><span class="line">conda remove -n name --all</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;Anaconda的卸载&quot;&gt;Anaconda的卸载&lt;/h2&gt;
&lt;p&gt;打开&lt;code&gt;cmd&lt;/code&gt;窗口,输入&lt;/p&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span</summary>
        
      
    
    
    
    <category term="开发环境搭建" scheme="https://www.wikunkun.asia/categories/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    
    
    <category term="Anaconda" scheme="https://www.wikunkun.asia/tags/Anaconda/"/>
    
    <category term="pip" scheme="https://www.wikunkun.asia/tags/pip/"/>
    
    <category term="Python" scheme="https://www.wikunkun.asia/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>加密内容</title>
    <link href="https://www.wikunkun.asia/posts/b6063e27.html"/>
    <id>https://www.wikunkun.asia/posts/b6063e27.html</id>
    <published>2025-02-13T11:51:51.000Z</published>
    <updated>2025-02-13T14:33:43.648Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="eb4e30aa440b944eca0dd1f40bd65f84ef974dcdd54089ae1229d9737b6f08e5">d7e284ce31b69fc89742012cc772daee6d0df62fc70926dcc5a4fb75ca81a4f9</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-blink">      <input class="hbe hbe-input-field hbe-input-field-blink" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-blink" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-blink" data-content="您好, 这里需要密码.">您好, 这里需要密码.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">加密内容,个人自用</summary>
    
    
    
    <category term="加密内容" scheme="https://www.wikunkun.asia/categories/%E5%8A%A0%E5%AF%86%E5%86%85%E5%AE%B9/"/>
    
    
    <category term="加密文章" scheme="https://www.wikunkun.asia/tags/%E5%8A%A0%E5%AF%86%E6%96%87%E7%AB%A0/"/>
    
  </entry>
  
  <entry>
    <title>Github图床搭建</title>
    <link href="https://www.wikunkun.asia/posts/241081b5.html"/>
    <id>https://www.wikunkun.asia/posts/241081b5.html</id>
    <published>2025-01-14T12:26:02.000Z</published>
    <updated>2025-02-13T12:53:01.882Z</updated>
    
    <content type="html"><![CDATA[<h2 id="创建Github仓库">创建Github仓库</h2><p>登录<code>github</code>账号,然后创建仓库</p><p><img src="https://lambda-image-1.pages.dev/20250213205220217.webp" alt="image-20250114202726724"></p><p>输入<strong>仓库名</strong>(可随意),选择<code>Public</code>,勾选<code>Add a README file</code>(最后勾选这个,不然等下你还要自己创建分支)</p><p><img src="https://lambda-image-1.pages.dev/20250213205220218.webp" alt="image-20250114204937245"></p><h2 id="创建Token">创建Token</h2><p>现在仓库创建完毕了,当时我们现在用相关的软件还是无法操作我们刚才创建的仓库,因此我们需要创建个<code>Token</code></p><p><img src="https://lambda-image-1.pages.dev/20250213205220219.webp" alt="image-20250114203014968"></p><p>点击<code>Developer settings</code></p><p><img src="https://lambda-image-1.pages.dev/20250213205220220.webp" alt="image-20250114203249114"></p><p>选择<code>Tokens(classic)</code>,然后<code>Generate new token</code>,选择<code>Generate new token(classic)</code></p><p><img src="https://lambda-image-1.pages.dev/20250213205220221.webp" alt="image-20250114203440351"></p><p>输入<code>token</code>名称,设置<code>token</code>有效期,选择<code>No expiration</code>,在<code>Select scopes</code>中勾选<code>repo</code></p><p><img src="https://lambda-image-1.pages.dev/20250213205220223.webp" alt="image-20250114203604622"></p><p>记录生成的<code>token</code></p><p><img src="https://lambda-image-1.pages.dev/20250213205220224.webp" alt="image-20250114203710736"></p><h2 id="使用Cloudflare进行加速">使用<code>Cloudflare</code>进行加速</h2><p>现在github图床搭建完毕了,但是在国内访问的话速度会很慢,有可能还无法访问,因此我们要用一些手段来进行加速,把项目部署到<code>Cloudflare</code>中只是其中的一种方法,如果你有更好的方法的话,这部分可以跳过</p><p><img src="https://lambda-image-1.pages.dev/20250213205220225.webp" alt="image-20250114204231646"></p><p>连接我们的<code>github</code></p><p><img src="https://lambda-image-1.pages.dev/20250213205220226.webp" alt="image-20250114204302615"></p><p>登录后进入这个页面,如果没有我们刚刚创建的仓库的话,点击<code>Cloudflare Pages</code></p><p><img src="https://lambda-image-1.pages.dev/20250213205220227.webp" alt="image-20250114204424957"></p><p>把我们刚刚创建的仓库添加进去</p><p><img src="https://lambda-image-1.pages.dev/20250213205220228.webp" alt="image-20250114204507453"></p><p>设置完成后回到刚刚的页面,选择我们刚刚创建的仓库,点击保存并部署</p><p><img src="https://lambda-image-1.pages.dev/20250213205220229.webp" alt="image-20250114205117414"></p><p>记住等下我们要使用的<code>域名</code></p><p><img src="https://lambda-image-1.pages.dev/20250213205220230.webp" alt="image-20250114211956068"></p><h2 id="使用PicList上传图片">使用PicList上传图片</h2><p>先下载<a href="https://piclist.cn/">PicList</a></p><p>下载完成后运行<code>PicList</code>,点击图床,然后选择<code>Github</code></p><p><img src="https://lambda-image-1.pages.dev/20250213205220231.webp" alt="image-20250114211715695"></p><p>添加新图床</p><p><img src="https://lambda-image-1.pages.dev/20250213205220232.webp" alt="image-20250114211758706"></p><p>输入相关配置信息</p><p><img src="https://lambda-image-1.pages.dev/20250213205220233.webp" alt="image-20250114212143176"></p><p>开始上传图片</p><p><img src="https://lambda-image-1.pages.dev/20250213205220234.webp" alt="image-20250114212246760"></p><p>这是本文待会要上传的图片</p><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://lambda-image-1.pages.dev/20250117155624667.webp" alt=""></p>              </div>            </details><p>可以看到刚刚上传的图片,并且域名也是我们刚刚配置的,以后就可以用该链接访问我们上传的图片了</p><p><img src="https://lambda-image-1.pages.dev/20250213205220235.webp" alt="image-20250114212803314"></p><h2 id="Typora中配置图片上传">Typora中配置图片上传</h2><p>下载<a href="https://typoraio.cn/">Typora</a></p><p>现在我们配置好了PicList,接下来就是把他与我们的<code>Typora</code>进行关联</p><p>打开偏好设置,选择上传服务</p><p><img src="https://lambda-image-1.pages.dev/20250213205220236.webp" alt="image-20250114213133590"></p><p>配置完成后可以点击旁边的<code>验证图片上传选项</code>测试是否可以正常上传图片,如果可以正常上传,至此就全部结束了</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;创建Github仓库&quot;&gt;创建Github仓库&lt;/h2&gt;
&lt;p&gt;登录&lt;code&gt;github&lt;/code&gt;账号,然后创建仓库&lt;/p&gt;
&lt;p&gt;&lt;img</summary>
        
      
    
    
    
    <category term="工具使用" scheme="https://www.wikunkun.asia/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
    
    <category term="教程" scheme="https://www.wikunkun.asia/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="GitHub" scheme="https://www.wikunkun.asia/tags/GitHub/"/>
    
    <category term="图床" scheme="https://www.wikunkun.asia/tags/%E5%9B%BE%E5%BA%8A/"/>
    
  </entry>
  
  <entry>
    <title>CMake添加本地库的方法</title>
    <link href="https://www.wikunkun.asia/posts/9c7cff54.html"/>
    <id>https://www.wikunkun.asia/posts/9c7cff54.html</id>
    <published>2025-01-14T05:40:31.000Z</published>
    <updated>2025-02-13T10:39:02.422Z</updated>
    
    <content type="html"><![CDATA[<h2 id="CMake添加本地库">CMake添加本地库</h2><p>主要目录结构</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> project/</span><br><span class="line"><span class="bullet">  -</span> src/</span><br><span class="line"><span class="bullet">    -</span> main.cpp</span><br><span class="line"><span class="bullet">    -</span> utils.h</span><br><span class="line"><span class="bullet">  -</span> include/</span><br><span class="line"><span class="bullet">    -</span> header.h</span><br><span class="line"><span class="bullet">  -</span> build/</span><br><span class="line"><span class="bullet">  -</span> lib/</span><br><span class="line"><span class="bullet">    -</span> lib1.c</span><br><span class="line"><span class="bullet">    -</span> lib1.h</span><br><span class="line"><span class="bullet">    -</span> ...</span><br><span class="line"><span class="bullet">    -</span> CMakeLists.txt</span><br><span class="line"><span class="bullet">  -</span> CMakeLists.txt</span><br><span class="line"><span class="bullet">  -</span> ...</span><br></pre></td></tr></table></figure><p><code>lib</code>中的<code>CMakeLists.txt</code>添加以下内容</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 lib 文件夹中的所有 C 文件加入到变量</span></span><br><span class="line"><span class="keyword">file</span>(GLOB LIB_SOURCES *.c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个静态库或共享库（根据需要修改为 `STATIC` 或 `SHARED`）</span></span><br><span class="line"><span class="keyword">add_library</span>(MyLibrary STATIC <span class="variable">$&#123;LIB_SOURCES&#125;</span>)</span><br><span class="line"><span class="comment"># 可选：指定包含目录（如有头文件）</span></span><br><span class="line"><span class="keyword">target_include_directories</span>(MyLibrary PUBLIC <span class="variable">$&#123;CMAKE_CURRENT_SOURCE_DIR&#125;</span>)</span><br></pre></td></tr></table></figure><p>项目的<code>CMakeLists.txt</code>添加以下内容</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_subdirectory</span>(lib)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(<span class="variable">$&#123;PROJECT_NAME&#125;</span> MyLibrary)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;CMake添加本地库&quot;&gt;CMake添加本地库&lt;/h2&gt;
&lt;p&gt;主要目录结构&lt;/p&gt;
&lt;figure class=&quot;highlight markdown&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span</summary>
        
      
    
    
    
    <category term="CMake 教程" scheme="https://www.wikunkun.asia/categories/CMake-%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="C/C++" scheme="https://www.wikunkun.asia/tags/C-C/"/>
    
    <category term="CMake" scheme="https://www.wikunkun.asia/tags/CMake/"/>
    
    <category term="构建工具" scheme="https://www.wikunkun.asia/tags/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/"/>
    
    <category term="本地库配置" scheme="https://www.wikunkun.asia/tags/%E6%9C%AC%E5%9C%B0%E5%BA%93%E9%85%8D%E7%BD%AE/"/>
    
  </entry>
  
  <entry>
    <title>Linux上安装conan 并且与CLion与cmake结合使用</title>
    <link href="https://www.wikunkun.asia/posts/c5c01ec0.html"/>
    <id>https://www.wikunkun.asia/posts/c5c01ec0.html</id>
    <published>2025-01-13T09:14:19.000Z</published>
    <updated>2025-02-13T10:39:02.420Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装Conan">安装Conan</h2><p><code>Conan</code> 是一个 <code>Python</code> 包，可以通过 <code>pip</code> 安装。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install conan</span><br></pre></td></tr></table></figure><p>确认是否安装成功</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conan  -v</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250113171627006.png" alt="image-20250113171627006"></p><p>初始化配置</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conan profile detect --force</span><br></pre></td></tr></table></figure><h2 id="配置CLion">配置CLion</h2><p>安装对应的插件</p><p><img src="https://lambda-image-1.pages.dev/image-20250113171831214.png" alt="image-20250113171831214"></p><p>使用下载的插件</p><p><img src="https://lambda-image-1.pages.dev/image-20250113172039155.png" alt="image-20250113172039155"></p><p>配置<code>CMake</code></p><p>输入以下内容(build/<strong>Debug</strong>/generators/conan_toolchain.cmake,这里的<strong>Debug</strong>值要于下面的构建类型的值一致)</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">-DCMAKE_TOOLCHAIN_FILE</span>=build/Debug/generators/conan_toolchain.cmake</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250114133144427.png" alt="image-20250114133144427"></p><p>查找想要安装的内容,并且添加到当前项目中</p><p><img src="https://lambda-image-1.pages.dev/image-20250113172129376.png" alt="image-20250113172129376"></p><p>安装对应的文件(build_type=Debug这个不能少,并且要与前面的<strong>构建类型</strong>的值相对应)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conan install . --build=missing -s build_type=Debug</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250113172700450.png" alt="image-20250113172700450"></p><p>运行完毕后记得查看导入代码</p><p><img src="https://lambda-image-1.pages.dev/image-20250113172836981.png" alt="image-20250113172836981"></p><p>打开<code>CMakeLists.txt</code>写入,刚才的代码</p><p><img src="https://lambda-image-1.pages.dev/image-20250113173110706.png" alt="image-20250113173110706"></p><p>重新加载<code>CMake</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250113173132752.png" alt="image-20250113173132752"></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;安装Conan&quot;&gt;安装Conan&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Conan&lt;/code&gt; 是一个 &lt;code&gt;Python&lt;/code&gt; 包，可以通过 &lt;code&gt;pip&lt;/code&gt; 安装。&lt;/p&gt;
&lt;figure class=&quot;highlight</summary>
        
      
    
    
    
    <category term="Linux平台开发" scheme="https://www.wikunkun.asia/categories/Linux%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="Linux" scheme="https://www.wikunkun.asia/tags/Linux/"/>
    
    <category term="C/C++" scheme="https://www.wikunkun.asia/tags/C-C/"/>
    
  </entry>
  
  <entry>
    <title>Linux系统编程学习</title>
    <link href="https://www.wikunkun.asia/posts/115b96c9.html"/>
    <id>https://www.wikunkun.asia/posts/115b96c9.html</id>
    <published>2025-01-12T19:27:14.000Z</published>
    <updated>2025-02-13T10:47:20.313Z</updated>
    
    <content type="html"><![CDATA[<h2 id="常用头文件">常用头文件</h2><table><thead><tr><th>头文件</th><th>作用</th></tr></thead><tbody><tr><td><strong><code>&lt;stdio.h&gt;</code></strong></td><td>标准输入输出库函数的声明，包括 <code>printf</code>、<code>scanf</code>、<code>fopen</code> 等。</td></tr><tr><td><strong><code>&lt;stdlib.h&gt;</code></strong></td><td>提供通用的工具函数，如动态内存分配 (<code>malloc</code>)、进程控制 (<code>exit</code>) 等。</td></tr><tr><td><strong><code>&lt;string.h&gt;</code></strong></td><td>字符串操作函数的声明，如 <code>strlen</code>、<code>strcpy</code>、<code>strcmp</code> 等。</td></tr><tr><td><strong><code>&lt;math.h&gt;</code></strong></td><td>提供数学计算函数的声明，如 <code>sin</code>、<code>cos</code>、<code>sqrt</code> 等。</td></tr><tr><td><strong><code>&lt;time.h&gt;</code></strong></td><td>时间和日期操作函数的声明，如 <code>time</code>、<code>localtime</code>、<code>strftime</code> 等。</td></tr><tr><td><strong><code>&lt;unistd.h&gt;</code></strong></td><td>定义 POSIX 标准的 API，如文件操作（<code>read</code>、<code>write</code>）、进程管理等。</td></tr><tr><td><strong><code>&lt;fcntl.h&gt;</code></strong></td><td>文件控制相关函数和常量的声明，如 <code>open</code>、文件访问模式常量等。</td></tr><tr><td><strong><code>&lt;sys/types.h&gt;</code></strong></td><td>定义数据类型，如 <code>pid_t</code>、<code>uid_t</code>、<code>gid_t</code> 等，用于系统调用。</td></tr><tr><td><strong><code>&lt;sys/stat.h&gt;</code></strong></td><td>文件状态操作函数的声明，如 <code>stat</code>、<code>chmod</code>、<code>mkdir</code> 等。</td></tr><tr><td><strong><code>&lt;errno.h&gt;</code></strong></td><td>定义全局错误变量 <code>errno</code> 及错误码常量，如 <code>EACCES</code>、<code>ENOENT</code> 等。</td></tr><tr><td><strong><code>&lt;signal.h&gt;</code></strong></td><td>提供信号处理相关函数，如 <code>signal</code>、<code>raise</code>、<code>kill</code> 等。</td></tr><tr><td><strong><code>&lt;pthread.h&gt;</code></strong></td><td>POSIX 线程库的头文件，用于多线程编程，如 <code>pthread_create</code> 等。</td></tr><tr><td><strong><code>&lt;sys/socket.h&gt;</code></strong></td><td>提供套接字编程相关函数和结构体，如 <code>socket</code>、<code>bind</code>、<code>connect</code> 等。</td></tr><tr><td><strong><code>&lt;netinet/in.h&gt;</code></strong></td><td>定义网络地址相关的结构体和常量，如 <code>sockaddr_in</code>、<code>INADDR_ANY</code> 等。</td></tr><tr><td><strong><code>&lt;arpa/inet.h&gt;</code></strong></td><td>提供 IP 地址转换函数，如 <code>inet_pton</code>、<code>inet_ntoa</code> 等。</td></tr><tr><td><strong><code>&lt;sys/wait.h&gt;</code></strong></td><td>提供进程等待相关函数，如 <code>wait</code>、<code>waitpid</code> 等。</td></tr><tr><td><strong><code>&lt;sys/mman.h&gt;</code></strong></td><td>提供内存映射相关函数，如 <code>mmap</code>、<code>munmap</code> 等。</td></tr><tr><td><strong><code>&lt;sys/epoll.h&gt;</code></strong></td><td>提供 epoll 多路复用接口函数，如 <code>epoll_create</code>、<code>epoll_wait</code> 等。</td></tr><tr><td><strong><code>&lt;poll.h&gt;</code></strong></td><td>提供 <code>poll</code> 多路复用接口的相关函数和常量。</td></tr><tr><td><strong><code>&lt;termios.h&gt;</code></strong></td><td>提供终端 I/O 控制接口，如设置串口属性的 <code>tcsetattr</code> 等。</td></tr><tr><td><strong><code>&lt;sys/ioctl.h&gt;</code></strong></td><td>提供设备 I/O 控制接口，如 <code>ioctl</code> 调用。</td></tr><tr><td><strong><code>&lt;ctype.h&gt;</code></strong></td><td>定义字符操作函数，如 <code>isalpha</code>、<code>isdigit</code>、<code>toupper</code> 等。</td></tr><tr><td><strong><code>&lt;assert.h&gt;</code></strong></td><td>提供断言功能，用于调试时检查程序中的逻辑条件。</td></tr><tr><td><strong><code>&lt;limits.h&gt;</code></strong></td><td>定义各种数据类型的限制值，如 <code>INT_MAX</code>、<code>CHAR_BIT</code> 等。</td></tr><tr><td><strong><code>&lt;float.h&gt;</code></strong></td><td>定义浮点类型的限制值，如 <code>FLT_MAX</code>、<code>DBL_MIN</code> 等。</td></tr><tr><td><strong><code>&lt;locale.h&gt;</code></strong></td><td>提供本地化支持函数，如 <code>setlocale</code>、<code>localeconv</code> 等。</td></tr><tr><td><strong><code>&lt;grp.h&gt;</code></strong></td><td>提供组信息相关函数，如 <code>getgrgid</code>、<code>getgrnam</code> 等。</td></tr><tr><td><strong><code>&lt;pwd.h&gt;</code></strong></td><td>提供用户信息相关函数，如 <code>getpwnam</code>、<code>getpwuid</code> 等。</td></tr><tr><td><strong><code>&lt;sys/resource.h&gt;</code></strong></td><td>提供系统资源限制相关函数，如 <code>getrlimit</code>、<code>setrlimit</code> 等。</td></tr></tbody></table><h2 id="系统数据类型选录">系统数据类型选录</h2><table><thead><tr><th>数据类型</th><th>SUSv3 类型需求</th><th>描述</th></tr></thead><tbody><tr><td><code>blkcnt_t</code></td><td>有符号整型</td><td>文件块数量（15.1 节）</td></tr><tr><td><code>blksize_t</code></td><td>有符号整型</td><td>文件块大小（15.1 节）</td></tr><tr><td><code>cc_t</code></td><td>无符号整型</td><td>终端特殊字符（62.4 节）</td></tr><tr><td><code>clock_t</code></td><td>整型或浮点型实数</td><td>以时钟周期计量的系统时间（10.7 节）</td></tr><tr><td><code>clockid_t</code></td><td>运算类型之一</td><td>针对 POSIX.1b 时钟和定时器函数的时钟标识符</td></tr><tr><td><code>comp_t</code></td><td>SUSv3 未作规范</td><td>经由压缩处理的时钟周期（28.1 节）</td></tr><tr><td><code>dev_t</code></td><td>运算类型之一</td><td>设备号，包含主、次设备号（15.1 节）</td></tr><tr><td><code>DIR</code></td><td>无类型要求</td><td>目录流（18.8 节）</td></tr><tr><td><code>fd_set</code></td><td>结构类型</td><td><code>select()</code>（63.2.1 节）中的文件描述符集合</td></tr><tr><td><code>fsblkcnt_t</code></td><td>无符号整型</td><td>文件系统块数量（14.11 节）</td></tr><tr><td><code>fsfilcnt_t</code></td><td>无符号整型</td><td>文件数量（14.11 节）</td></tr><tr><td><code>gid_t</code></td><td>整型</td><td>数值型组标识符（8.3 节）</td></tr><tr><td><code>id_t</code></td><td>整型</td><td>用以存放标识符的通用类型，其大小至少可放置 <code>pid_t</code>、<code>uid_t</code> 和 <code>gid_t</code> 类型</td></tr><tr><td><code>in_addr_t</code></td><td>32 位无符号整型</td><td>IPv4 地址（59.4 节）</td></tr><tr><td><code>in_port_t</code></td><td>16 位无符号整型</td><td>IP 端口号（59.4 节）</td></tr><tr><td><code>ino_t</code></td><td>无符号整型</td><td>文件 i-node 号（15.1 节）</td></tr><tr><td><code>key_t</code></td><td>运算类型之一</td><td>System V IPC 键（45.2 节）</td></tr><tr><td><code>mode_t</code></td><td>整型</td><td>文件权限及类型（15.1 节）</td></tr><tr><td><code>mqd_t</code></td><td>无类型要求</td><td>POSIX 消息队列描述符</td></tr><tr><td><code>msglen_t</code></td><td>无符号整型</td><td>System V 消息队列所允许的字节数（46.4 节）</td></tr><tr><td><code>msgqnum_t</code></td><td>无符号整型</td><td>System V 消息队列中的消息数量（46.4 节）</td></tr><tr><td><code>nfds_t</code></td><td>无符号整型</td><td><code>poll()</code>（63.2.2 节）中的文件描述符数量</td></tr><tr><td><code>nlink_t</code></td><td>整型</td><td>文件的（硬）连接数量（15.1 节）</td></tr><tr><td><code>off_t</code></td><td>有符号整型</td><td>文件偏移量或大小（4.7 节及 15.1 节）</td></tr><tr><td><code>pid_t</code></td><td>有符号整型</td><td>进程 ID、进程组 ID 或会话 ID（6.3 节、34.2 节、34.3 节）</td></tr><tr><td><code>ptrdiff_t</code></td><td>有符号整型</td><td>两指针差值，为有符号整型</td></tr><tr><td><code>rlim_t</code></td><td>无符号整型</td><td>资源限制（36.2 节）</td></tr><tr><td><code>sa_family_t</code></td><td>无符号整型</td><td>套接字地址族（56.4 节）</td></tr><tr><td><code>shmatt_t</code></td><td>无符号整型</td><td>与 System V 共享内存段相连的进程数量</td></tr><tr><td><code>sig_atomic_t</code></td><td>整型</td><td>可进行原子访问的数据类型（21.1.3 节）</td></tr><tr><td><code>siginfo_t</code></td><td>结构类型</td><td>信号起源的相关信息（21.4 节）</td></tr><tr><td><code>sigset_t</code></td><td>整型或结构类型</td><td>信号集合（20.9 节）</td></tr><tr><td><code>size_t</code></td><td>无符号整型</td><td>对象大小（以字节数计）</td></tr><tr><td><code>socklen_t</code></td><td>至少 32 位的整型</td><td>套接字地址结构大小（以字节数计）（56.3 节）</td></tr><tr><td><code>speed_t</code></td><td>无符号整型</td><td>终端线速度（62.7 节）</td></tr><tr><td><code>ssize_t</code></td><td>有符号整型</td><td>字节数或（为负时）标识错误</td></tr><tr><td><code>stack_t</code></td><td>结构类型</td><td>对备选信号栈的描述（21.3 节）</td></tr><tr><td><code>suseconds_t</code></td><td>有符号整型，范围为 [-1,1000000]</td><td>微秒级的时间间隔（10.1 节）</td></tr><tr><td><code>tcflag_t</code></td><td>无符号整型</td><td>终端模式标志位的位掩码（62.2 节）</td></tr><tr><td><code>time_t</code></td><td>整型或浮点型实数</td><td>自所谓纪元（Epoch）（10.1 节）始，以秒计的日历时间</td></tr><tr><td><code>timer_t</code></td><td>运算类型之一</td><td>POSIX.1b 间隔定时器函数（23.6 节）的定时器标识符</td></tr><tr><td><code>uid_t</code></td><td>整型</td><td>数值型用户标识符（8.1 节）</td></tr></tbody></table><h2 id="文件-I-O：通用的-I-O-模型">文件 I/O：通用的 I/O 模型</h2><h3 id="概述">概述</h3><p>所有执行 <strong>I/O 操作的系统调用</strong>都以<strong>文件描述符</strong>，一个<strong>非负整数</strong>（通常是小整数），来指代打开的文件。文件描述符用以表示所有类型的已打开文件，包括管道（pipe）、FIFO、socket、终端、设备和普通文件。针对每个进程，文件描述符都自成一套按照。惯例，大多数程序都期望能够使用 3 种标准的文件描述符，如下表</p><table><thead><tr><th>文件描述符</th><th>用 途</th><th><strong>POSIX</strong> 名称</th><th><strong>stdio</strong> 流</th></tr></thead><tbody><tr><td>0</td><td>标准输入</td><td>STDIN_FILENO</td><td>stdin</td></tr><tr><td>1</td><td>标准输出</td><td>STDOUT_FILENO</td><td>stdout</td></tr><tr><td>2</td><td>标准错误</td><td>STDERR_FILENO</td><td>stder</td></tr></tbody></table><p><strong>I/O 操作的 4 个主要系统调用</strong></p><p>1.<code>int open(const char *pathname, int flags, mode_t mode);</code></p><p>2.<code>ssize_t read(int fd, void *buffer, size_t count);</code></p><p>3.<code>ssize_t write(int fd, const void *buffer, size_t count);</code></p><p>4.<code>int close(int fd);</code></p><h3 id="通用-I-O">通用 I/O</h3><p>UNIX I/O 模型的显著特点之一是其输入/输出的<strong>通用性</strong>概念。这意味着使用 4 个同样的系统调用 open()、read()、write()和 close()可以对<strong>所有类型的文件</strong>执行 I/O 操作，包括终端之类的设备。因此，仅使用这些系统调用编写的程序，将对任何类型的文件有效。</p><h3 id="open-函数">open()函数</h3><p>open()调用既能打开一个业已存在的文件，也能<strong>创建</strong>并打开一个新文件。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">open</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">int</span> flags, <span class="type">mode_t</span> mode)</span>;</span><br></pre></td></tr></table></figure><p><strong>文件访问模式标志</strong></p><p><code>O_RDONLY</code>,<code>O_WRONLY</code>和<code>O_RDWR</code>这三种只能选择一种</p><table><thead><tr><th>标志</th><th>用途</th><th>统一 UNIX 规范版本</th></tr></thead><tbody><tr><td><code>O_RDONLY</code></td><td>以只读方式打开</td><td>v3</td></tr><tr><td><code>O_WRONLY</code></td><td>以只写方式打开</td><td>v3</td></tr><tr><td><code>O_RDWR</code></td><td>以读写方式打开</td><td>v3</td></tr><tr><td><code>O_CLOEXEC</code></td><td>设置 close-on-exec 标志（自 Linux 2.6.23 版本开始）</td><td>v4</td></tr><tr><td><code>O_CREAT</code></td><td>若文件不存在则创建之</td><td>v3</td></tr><tr><td><code>O_DIRECT</code></td><td>无缓冲的输入/输出</td><td></td></tr><tr><td><code>O_DIRECTORY</code></td><td>如果 pathname 不是目录，则失败</td><td>v4</td></tr><tr><td><code>O_EXCL</code></td><td>结合 O_CREAT 参数使用，专门用于创建文件</td><td>v3</td></tr><tr><td><code>O_LARGEFILE</code></td><td>在 32 位系统中使用此标志打开大文件</td><td></td></tr><tr><td><code>O_NOATIME</code></td><td>调用 read() 时，不修改文件最近访问时间（自 Linux 2.6.8 版本开始）</td><td></td></tr><tr><td><code>O_NOCTTY</code></td><td>不要让 pathname（所指向的终端设备）成为控制终端</td><td>v3</td></tr><tr><td><code>O_NOFOLLOW</code></td><td>对符号链接不予解引用</td><td>v4</td></tr><tr><td><code>O_TRUNC</code></td><td>截断已有文件，使其长度为零</td><td>v3</td></tr><tr><td><code>O_APPEND</code></td><td>总在文件尾部追加数据</td><td>v3</td></tr><tr><td><code>O_ASYNC</code></td><td>当 I/O 操作可行时，产生信号（signal）通知进程</td><td></td></tr><tr><td><code>O_DSYNC</code></td><td>提供同步的 I/O 数据完整性（自 Linux 2.6.33 版本开始）</td><td>v3</td></tr><tr><td><code>O_NONBLOCK</code></td><td>以非阻塞方式打开</td><td>v3</td></tr><tr><td><code>O_SYNC</code></td><td>以同步方式写入文件</td><td>v3</td></tr></tbody></table><p><strong><code>open()</code> 函数的常见错误</strong></p><table><thead><tr><th>错误代码</th><th>描述</th></tr></thead><tbody><tr><td><code>EACCES</code></td><td>无权限以指定方式打开文件，可能因目录权限限制、文件不存在且无法创建。</td></tr><tr><td><code>EISDIR</code></td><td>尝试以写方式打开目录文件（不允许）。</td></tr><tr><td><code>EMFILE</code></td><td>进程已打开文件描述符数量达到限制。</td></tr><tr><td><code>ENFILE</code></td><td>系统文件打开数量达到上限。</td></tr><tr><td><code>ENOENT</code></td><td>文件不存在且未指定 <code>O_CREAT</code>，或路径中目录不存在。</td></tr><tr><td><code>EROFS</code></td><td>文件隶属只读文件系统，试图以写方式打开。</td></tr><tr><td><code>ETXTBSY</code></td><td>文件为正在运行的可执行文件，系统禁止修改。</td></tr></tbody></table><blockquote><p><strong>注意</strong>: 更多错误原因可查看 <code>man 2 open</code> 手册。</p></blockquote><h3 id="creat-函数">creat()函数</h3><p>在早期的 UNIX 实现中，open()只有两个参数，无法创建新文件，而是使用 creat()系统调用来创建并打开一个新文件。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">creat</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname,<span class="type">mode_t</span> mode)</span>;</span><br></pre></td></tr></table></figure><p>creat()系统调用根据 <code>pathname</code> 参数创建并打开一个文件，若文件已存在，则打开文件，并清空文件内容，将其长度清 0。creat()返回一文件描述符，供后续系统调用使用。<code>creat()</code>系统调用等价于如下 <code>open()</code>调用：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fd =open(pathname,<span class="number">0</span>_WRONLY | O_CREAT | O_TRUNC,mode);</span><br></pre></td></tr></table></figure><h3 id="read-函数">read()函数</h3><p>read()系统调用从文件描述符 fd 所指代的打开文件中读取数据。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">ssizet <span class="title function_">read</span><span class="params">(<span class="type">int</span> fd,<span class="type">void</span> *buffer,sizet count)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回读取的字节数，EOF（文件结束）时返回 0，出错时返回 -1</span></span><br></pre></td></tr></table></figure><p><code>count</code> 参数指定最多能读取的字节数。（<code>size_t </code>数据类型属于无符号整数类型。）<code>buffer</code> 参数提供用来存放输入数据的内存缓冲区地址。缓冲区至少应有 <code>count</code> 个字节。</p><h3 id="write-函数">write()函数</h3><p>write()系统调用将数据写入一个已打开的文件中。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd,h&gt;</span></span></span><br><span class="line"></span><br><span class="line">ssize t <span class="title function_">write</span><span class="params">(<span class="type">int</span> fd,<span class="type">void</span> *buffer,sizet count)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回写入的字节数，出错时返回 -1</span></span><br></pre></td></tr></table></figure><p><code>write()</code>调用的参数含义与 <code>read()</code>调用相类似。<code>buffer</code> 参数为要写入文件中数据的内存地址，<code>count</code>参数为欲从<code> buffer</code> 写入文件的数据字节数，<code>fd</code> 参数为一文件描述符，指代数据要写入的文件。如果 <code>write()</code>调用成功，将返回实际写入文件的字节数，该返回值可能小于 <code>count</code> 参数值。这被称为“部分写”。对磁盘文件来说，造成“部分写”的原因可能是由于磁盘已满，或是因为进程资源对文件大小的限制。</p><h3 id="close-函数">close()函数</h3><p>close()系统调用关闭一个打开的文件描述符，并将其释放回调用进程，供该进程继续使用。当一进程终止时，将<strong>自动关闭</strong>其已打开的所有文件描述符。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd,h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">close</span><span class="params">(<span class="type">int</span> fd)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功时返回 0，出错时返回 -1</span></span><br></pre></td></tr></table></figure><h3 id="lseek-函数">lseek()函数</h3><p>对于每个打开的文件，系统内核会记录其文件偏移量，有时也将文件偏移量称为读写偏移量或指针。文件偏移量是指执行下一个 <code>read()</code>或 <code>write()</code>操作的文件起始位置，会以相对于文件头部起始点的文件当前位置来表示。文件第一个字节的偏移量为 0。文件打开时，会将文件偏移量设置为指向文件开始，以后每次<code>read()</code>或 <code>write()</code>调用将自动对其进行调整，以指向已读或已写数据后的下一字节。因此，连续的 <code>read()</code>和 <code>write()</code>调用将按顺序递进，对文件进行操作。针对文件描述符 <code>fd</code> 参数所指代的已打开文件，<code>lseek()</code>系统调用依照 <code>offset</code> 和 <code>whence</code> 参数值调整该文件的偏移量。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">off t <span class="title function_">lseek</span><span class="params">(<span class="type">int</span> fd,off t offset,<span class="type">int</span> whence)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功时返回新的文件偏移量，出错时返回 -1</span></span><br></pre></td></tr></table></figure><p><code>offset</code> 参数指定了一个以字节为单位的数值。（SUSv3 规定 off_t 数据类型为有符号整型数。）<code>whence</code> 参数则表明应参照哪个基点来解释 <code>offset</code> 参数，应为下列其中之一：</p><table><thead><tr><th>标志</th><th>描述</th></tr></thead><tbody><tr><td>SEEK_SET</td><td>将文件偏移量设置为从文件头部起始点开始的 offset 个字节。</td></tr><tr><td>SEEK_CUR</td><td>相对于当前文件偏移量，将文件偏移量调整 offset 个字节。</td></tr><tr><td>SEEK_END</td><td>将文件偏移量设置为起始于文件尾部的 offset 个字节。offset 参数从文件最后一个字节之后算起。</td></tr></tbody></table><h2 id="深入探究文件-I-O">深入探究文件 I/O</h2><h3 id="fcntl-函数">fcntl()函数</h3><p><code>fcntl()</code>系统调用对一个打开的文件描述符执行一系列控制操作。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl,h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">fcntl</span><span class="params">(<span class="type">int</span> fd,<span class="type">int</span> cmd,...)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//成功时返回取决于cmd，错误时返回-1</span></span><br></pre></td></tr></table></figure><p>cmd 参数所支持的操作范围很广,常用来获取/设置文件描述符标志,获取/设置文件状态标志,设置/获取文件锁,复制文件描述符。fcntl()的第三个参数以省略号来表示，这意味着可以将其设置为不同的类型，或者加以省略。内核会依据 cmd 参数（如果有的话）的值来确定该参数的数据类型。</p><details class="folding-tag" green><summary> 使用示例(获取和设置文件描述符标志：`F_GETFD` 和 `F_SETFD`) </summary>              <div class='content'>              <p>获取或设置文件描述符的标志，例如 <code>FD_CLOEXEC</code>（关闭文件时不被子进程继承）。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;example.txt&quot;</span>, O_WRONLY | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取文件描述符标志</span></span><br><span class="line">    <span class="type">int</span> flags = fcntl(fd, F_GETFD);</span><br><span class="line">    <span class="keyword">if</span> (flags == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;fcntl F_GETFD&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Initial FD flags: %d\n&quot;</span>, flags);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置 FD_CLOEXEC 标志</span></span><br><span class="line">    flags |= FD_CLOEXEC;</span><br><span class="line">    <span class="keyword">if</span> (fcntl(fd, F_SETFD, flags) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;fcntl F_SETFD&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;FD_CLOEXEC flag set.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 使用示例(获取和设置文件状态标志：`F_GETFL` 和 `F_SETFL`) </summary>              <div class='content'>              <p>获取或修改文件的状态标志，例如非阻塞模式（<code>O_NONBLOCK</code>）或追加模式（<code>O_APPEND</code>）。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;example.txt&quot;</span>, O_WRONLY | O_CREAT | O_APPEND, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取文件状态标志</span></span><br><span class="line">    <span class="type">int</span> flags = fcntl(fd, F_GETFL);</span><br><span class="line">    <span class="keyword">if</span> (flags == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;fcntl F_GETFL&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Initial file status flags: %d\n&quot;</span>, flags);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加非阻塞标志</span></span><br><span class="line">    flags |= O_NONBLOCK;</span><br><span class="line">    <span class="keyword">if</span> (fcntl(fd, F_SETFL, flags) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;fcntl F_SETFL&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;O_NONBLOCK flag set.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 使用示例(文件锁：`F_SETLK` 和`F_SETLKW`和 `F_GETLK`) </summary>              <div class='content'>              <p>设置、获取或阻塞文件锁（适合实现进程间文件同步）。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;example.txt&quot;</span>, O_WRONLY | O_CREAT, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">flock</span> <span class="title">lock</span>;</span></span><br><span class="line">    lock.l_type = F_WRLCK;  <span class="comment">// 写锁</span></span><br><span class="line">    lock.l_whence = SEEK_SET;</span><br><span class="line">    lock.l_start = <span class="number">0</span>;       <span class="comment">// 从文件开头</span></span><br><span class="line">    lock.l_len = <span class="number">0</span>;         <span class="comment">// 锁住整个文件</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 尝试设置锁</span></span><br><span class="line">    <span class="keyword">if</span> (fcntl(fd, F_SETLK, &amp;lock) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;fcntl F_SETLK&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;File locked.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 模拟文件操作</span></span><br><span class="line">    sleep(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 释放锁</span></span><br><span class="line">    lock.l_type = F_UNLCK;</span><br><span class="line">    <span class="keyword">if</span> (fcntl(fd, F_SETLK, &amp;lock) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;fcntl F_SETLK&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;File unlocked.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 使用示例(复制文件描述符：`F_DUPFD` 和 `F_DUPFD_CLOEXEC`) </summary>              <div class='content'>              <p>类似于 <code>dup()</code> 和 <code>dup3()</code>，但支持更精细的控制。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;example.txt&quot;</span>, O_WRONLY | O_CREAT, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 复制文件描述符，最小值为 5</span></span><br><span class="line">    <span class="type">int</span> new_fd = fcntl(fd, F_DUPFD, <span class="number">5</span>);</span><br><span class="line">    <span class="keyword">if</span> (new_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;fcntl F_DUPFD&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;New file descriptor: %d\n&quot;</span>, new_fd);</span><br><span class="line"></span><br><span class="line">    write(new_fd, <span class="string">&quot;Hello, fcntl!\n&quot;</span>, <span class="number">14</span>);</span><br><span class="line"></span><br><span class="line">    close(fd);</span><br><span class="line">    close(new_fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="dup-函数">dup()函数</h3><p>dup()调用复制一个打开的文件描述符 oldfd，并返回一个新描述符，二者都指向同一打开的文件句柄。系统会保证新描述符一定是编号值最低的未用文件描述符。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">dup</span><span class="params">(<span class="type">int</span> oldfd)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功时返回（新）文件描述符，错误时返回-1</span></span><br></pre></td></tr></table></figure><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;example.txt&quot;</span>, O_WRONLY | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> new_fd = dup(fd);</span><br><span class="line">    <span class="keyword">if</span> (new_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;dup&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    write(new_fd, <span class="string">&quot;Hello, dup!\n&quot;</span>, <span class="number">12</span>);</span><br><span class="line">    close(fd);</span><br><span class="line">    close(new_fd);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行完毕后文件 <code>example.txt</code> 会包含 <code>Hello, dup!</code></p>              </div>            </details><h3 id="dup2-函数">dup2()函数</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd,h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">dup2</span><span class="params">(<span class="type">int</span> oldfd,<span class="type">int</span> newfd)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功时返回（新）文件描述符，错误时返回-1</span></span><br></pre></td></tr></table></figure><p><code>dup2()</code>系统调用会为 <code>oldfd</code> 参数所指定的文件描述符创建副本，其编号由 <code>newfd</code> 参数指定。如果由 <code>newfd</code> 参数所指定编号的文件描述符之前已经打开，那么 <code>dup2()</code>会首先将其关闭。（<code>dup2()</code>调用会默然忽略 <code>newfd</code> 关闭期间出现的任何错误。故此，编码时更为安全的做法是：在调用<code>dup2()</code>之前，若 <code>newfd</code> 已经打开，则应显式调用 <code>close()</code>将其关闭。）如果 <code>oldfd</code> 和 <code>newfd</code> 相同，<code>dup2()</code> 直接返回 <code>newfd</code>，不会关闭或复制。</p><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;example.txt&quot;</span>, O_WRONLY | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dup2(fd, STDOUT_FILENO);  <span class="comment">// 重定向标准输出到文件</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;这将被写入文件而不是终端.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行完毕后文件<code>example.txt</code> 会包含重定向后的输出内容<code>&quot;这将被写入文件而不是终端.&quot;</code>。</p>              </div>            </details><h3 id="dup3-函数">dup3()函数</h3><p>dup3()系统调用完成的工作与 dup2()相同，只是新增了一个附加参数 flag，这是一个可以修改系统调用行为的位掩码。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> GNU SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">dup3</span><span class="params">(<span class="type">int</span> oldfd,<span class="type">int</span> newfd,<span class="type">int</span> flags)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功时返回（新）文件描述符，错误时返回-1</span></span><br></pre></td></tr></table></figure><p>目前，dup3()只支持一个标志 O_CLOEXEC，这将促使内核为新文件描述符设置 close-on-exec标志（FD_CLOEXEC）。</p><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd = open(<span class="string">&quot;example.txt&quot;</span>, O_WRONLY | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;open&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dup3(fd, <span class="number">5</span>, O_CLOEXEC);  <span class="comment">// 复制到文件描述符 5，并设置 O_CLOEXEC</span></span><br><span class="line">    write(<span class="number">5</span>, <span class="string">&quot;Hello, dup3!\n&quot;</span>, <span class="number">13</span>);</span><br><span class="line"></span><br><span class="line">    close(fd);</span><br><span class="line">    close(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行完毕后文件<code>example.txt</code> 会包含 <code>Hello, dup3!</code></p>              </div>            </details><h3 id="pread-函数">pread()函数</h3><p>系统调用 <code>pread()</code>完成与 <code>read()</code>相类似的工作，只是前者会在 <code>offset</code> 参数所指定的位置进行文件 <code>I/O</code> 操作，而非始于文件的当前偏移量处，且它们不会改变文件的当前偏移量。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd,h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">pread</span><span class="params">(<span class="type">int</span> fd,<span class="type">void</span> *buf,<span class="type">size_t</span> count,<span class="type">off_t</span> offset)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回读取的字节数，EOF（文件结束）时返回 0，发生错误时返回 -1。</span></span><br></pre></td></tr></table></figure><p><code>pread()</code>系统调用相当于把下面的操作,纳入了原子操作</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">off_t</span> = orig;</span><br><span class="line"><span class="type">ssize_t</span> t;</span><br><span class="line"><span class="type">char</span> buf[<span class="number">1024</span>]; <span class="comment">// 定义一个大小为 1024 字节的缓冲区</span></span><br><span class="line"><span class="comment">// 获取当前文件描述符 fd 的文件偏移量，并将其保存到 orig 中,SEEK_CUR 表示相对于当前偏移量的位置。</span></span><br><span class="line">orig = lseek(fd,<span class="number">0</span>,SEEK_CUR);</span><br><span class="line"><span class="comment">// 将文件偏移量移动到指定的 offset 位置。SEEK_SET 表示从文件的开头计算偏移量。</span></span><br><span class="line">lseek(fd,offset,SEEK_SET);</span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">read</span><span class="params">(fd, buf, len)</span>;</span><br><span class="line"><span class="comment">// 从文件描述符 fd 处读取最多 len 字节的数据到缓冲区 buf 中，返回实际读取的字节数。</span></span><br><span class="line">s = read(fd,buf,len);</span><br><span class="line"><span class="comment">// 将文件偏移量恢复到之前保存的 orig 值。这样，文件的读取或写入位置不会因为这段操作而改变。</span></span><br><span class="line"><span class="number">1</span>seek(fd,orig,SEEK_SET);</span><br></pre></td></tr></table></figure><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">char</span> buf[<span class="number">20</span>];</span><br><span class="line">    <span class="type">ssize_t</span> bytesRead;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开文件</span></span><br><span class="line">    fd = open(<span class="string">&quot;example.txt&quot;</span>, O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从偏移量 10 开始读取 15 个字节</span></span><br><span class="line">    bytesRead = pread(fd, buf, <span class="number">15</span>, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">if</span> (bytesRead &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;pread failed&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加字符串结束符</span></span><br><span class="line">    buf[bytesRead] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打印读取的数据</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Data read: %s\n&quot;</span>, buf);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭文件</span></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>example.txt</code>的文件内容</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br></pre></td></tr></table></figure><p>运行上述程序会输出：</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Data <span class="built_in">read</span>: ABCDEFGHIJKLM</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="pwrite-函数">pwrite()函数</h3><p>系统调用 <code>pwrite()</code>完成与 <code>write()</code>相类似的工作，只是前者会在 <code>offset</code> 参数所指定的位置进行文件 <code>I/O</code> 操作，而非始于文件的当前偏移量处，且它们不会改变文件的当前偏移量。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd,h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">pwrite</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> count, <span class="type">off_t</span> offset)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回写入的字节数，EOF（文件结束）时返回 0，发生错误时返回 -1。</span></span><br></pre></td></tr></table></figure><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *data = <span class="string">&quot;Hello, pwrite!&quot;</span>;</span><br><span class="line">    <span class="type">ssize_t</span> bytesWritten;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开文件（如果文件不存在则创建）</span></span><br><span class="line">    fd = open(<span class="string">&quot;example.txt&quot;</span>, O_WRONLY | O_CREAT, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从偏移量 5 开始写入数据</span></span><br><span class="line">    bytesWritten = pwrite(fd, data, <span class="built_in">strlen</span>(data), <span class="number">5</span>);</span><br><span class="line">    <span class="keyword">if</span> (bytesWritten &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;pwrite failed&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Bytes written: %zd\n&quot;</span>, bytesWritten);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭文件</span></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>example.txt</code>的文件内容</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1234567890</span></span><br></pre></td></tr></table></figure><p>运行程序后，<code>example.txt</code> 内容变为：</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">12345</span>Hello, pwrite!</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="readv-函数">readv()函数</h3><p><code>readv()</code> 是一种 POSIX 系统调用，用于从文件描述符中读取数据到多个缓冲区。它的主要功能是将数据按顺序填充到指定的多个缓冲区中，而不是将数据集中到一个缓冲区中。这样可以减少内存拷贝，提高性能。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/uio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">readv</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> iovec *iov, <span class="type">int</span> iovcnt)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功返回读取的总字节数，即所有缓冲区中实际填充的字节数的总和。返回 -1，并设置全局变量 errno 表示错误原因。</span></span><br></pre></td></tr></table></figure><p>这些系统调用并非只对单个缓冲区进行读写操作，而是一次即可传输多个缓冲区的数据。数组 <code>iov</code> 定义了一组用来传输数据的缓冲区。整型数 <code>iovcnt</code> 则指定了 <code>iov</code> 的成员个数。<code>iov</code> 中的每个成员都是如下形式的数据结构。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/uio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> &#123;</span></span><br><span class="line">    <span class="type">void</span>  *iov_base;  <span class="comment">// 指向缓冲区的起始地址</span></span><br><span class="line">    <span class="type">size_t</span> iov_len;   <span class="comment">// 缓冲区的长度（以字节为单位）</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/uio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">ssize_t</span> bytesRead;</span><br><span class="line">    <span class="type">char</span> buf1[<span class="number">10</span>];</span><br><span class="line">    <span class="type">char</span> buf2[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开文件</span></span><br><span class="line">    fd = open(<span class="string">&quot;example.txt&quot;</span>, O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义两个 iovec 缓冲区</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> <span class="title">iov</span>[2];</span></span><br><span class="line">    iov[<span class="number">0</span>].iov_base = buf1;          <span class="comment">// 第一个缓冲区</span></span><br><span class="line">    iov[<span class="number">0</span>].iov_len = <span class="keyword">sizeof</span>(buf1);  <span class="comment">// 第一个缓冲区大小</span></span><br><span class="line"></span><br><span class="line">    iov[<span class="number">1</span>].iov_base = buf2;          <span class="comment">// 第二个缓冲区</span></span><br><span class="line">    iov[<span class="number">1</span>].iov_len = <span class="keyword">sizeof</span>(buf2);  <span class="comment">// 第二个缓冲区大小</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从文件中读取数据到 iov 中的缓冲区</span></span><br><span class="line">    bytesRead = readv(fd, iov, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (bytesRead &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;readv failed&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打印读取到的内容</span></span><br><span class="line">    buf1[iov[<span class="number">0</span>].iov_len - <span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;  <span class="comment">// 确保缓冲区末尾有 &#x27;\0&#x27;</span></span><br><span class="line">    buf2[bytesRead - <span class="keyword">sizeof</span>(buf1) - <span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Buffer 1: %s\n&quot;</span>, buf1);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Buffer 2: %s\n&quot;</span>, buf2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭文件</span></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>example.txt</code>的文件内容</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">HelloWorldThisIsReadvExample</span></span><br></pre></td></tr></table></figure><p>运行程序后，输出为：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Buffer</span> <span class="number">1</span>: HelloWorl</span><br><span class="line"><span class="attribute">Buffer</span> <span class="number">2</span>: dThisIsReadvEx</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="writev-函数">writev()函数</h3><p><code>writev()</code> 是一个系统调用，允许程序将多个非连续缓冲区的数据写入到文件描述符中。它可以一次性地将分散的多个缓冲区内容输出到目标文件（或套接字）中，而不需要手动合并数据，从而提高性能。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/uio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">writev</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> iovec *iov, <span class="type">int</span> iovcnt)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功：返回实际写入的字节数。失败：返回 -1 并设置 errno 以指示错误。</span></span><br></pre></td></tr></table></figure><p><code>writev()</code>系统调用实现了集中输出：将 <code>iov</code> 所指定的所有缓冲区中的数据拼接（“集中”）起来，然后以连续的字节序列写入文件描述符 <code>fd</code> 指代的文件中。对缓冲区中数据的“集中”始于<code>iov[0]</code>所指定的缓冲区，并按数组顺序展开。像 <code>readv()</code>调用一样，<code>writev()</code>调用也属于原子操作，即所有数据将一次性地从用户内存传输到 <code>fd</code> 指代的文件中。因此，在向普通文件写入数据时，<code>writev()</code>调用会把所有的请求数据连续写入文件，而不会在其他进程（或线程）写操作的影响下1 分散地写入文件2 。如同 <code>write()</code>调用，<code>writev()</code>调用也可能存在部分写的问题。因此，必须检查 <code>writev()</code>调用的返回值，以确定写入的字节数是否与要求相符。</p><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/uio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">ssize_t</span> bytesWritten;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开文件以写入</span></span><br><span class="line">    fd = open(<span class="string">&quot;example.txt&quot;</span>, O_WRONLY | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义两个缓冲区</span></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *buf1 = <span class="string">&quot;Hello, &quot;</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *buf2 = <span class="string">&quot;World!\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置 iovec 数组</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> <span class="title">iov</span>[2];</span></span><br><span class="line">    <span class="comment">// void * 是 C 和 C++ 语言中一种通用的指针类型，表示 &quot;指向未知类型的指针&quot;。</span></span><br><span class="line">    iov[<span class="number">0</span>].iov_base = (<span class="type">void</span> *)buf1;  <span class="comment">// 第一个缓冲区</span></span><br><span class="line">    iov[<span class="number">0</span>].iov_len = <span class="built_in">strlen</span>(buf1);  <span class="comment">// 第一个缓冲区的长度</span></span><br><span class="line"></span><br><span class="line">    iov[<span class="number">1</span>].iov_base = (<span class="type">void</span> *)buf2;  <span class="comment">// 第二个缓冲区</span></span><br><span class="line">    iov[<span class="number">1</span>].iov_len = <span class="built_in">strlen</span>(buf2);  <span class="comment">// 第二个缓冲区的长度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 writev 写入文件</span></span><br><span class="line">    bytesWritten = writev(fd, iov, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (bytesWritten &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;writev failed&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Successfully written %zd bytes.\n&quot;</span>, bytesWritten);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭文件</span></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行程序后，<code>example.txt</code>文件内容为：</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Hello,</span> World!</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="preadv-函数">preadv()函数</h3><p><code>preadv()</code> 是 Linux 和 Unix 系统中的系统调用，用于 <strong>从文件描述符的指定偏移量读取数据，并存储到多个缓冲区中</strong>。与 <code>readv()</code> 不同，<code>preadv()</code> 的一个显著特性是它是一个 <strong>“原子” 操作</strong>，它结合了 <code>readv()</code> 和 <code>lseek()</code> 的功能，同时不会更改文件描述符的文件偏移量。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/uio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">preadv</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> iovec *iov, <span class="type">int</span> iovcnt, <span class="type">off_t</span> offset)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功：返回实际读取的字节数。失败：返回 -1，并设置 errno 指定错误原因。</span></span><br></pre></td></tr></table></figure><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/uio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">ssize_t</span> bytesRead;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> <span class="title">iov</span>[2];</span></span><br><span class="line">    <span class="type">char</span> buf1[<span class="number">10</span>], buf2[<span class="number">20</span>];</span><br><span class="line">    <span class="type">off_t</span> offset = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开文件</span></span><br><span class="line">    fd = open(<span class="string">&quot;example.txt&quot;</span>, O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置 iovec 缓冲区</span></span><br><span class="line">    iov[<span class="number">0</span>].iov_base = buf1;</span><br><span class="line">    iov[<span class="number">0</span>].iov_len = <span class="keyword">sizeof</span>(buf1);</span><br><span class="line">    iov[<span class="number">1</span>].iov_base = buf2;</span><br><span class="line">    iov[<span class="number">1</span>].iov_len = <span class="keyword">sizeof</span>(buf2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 preadv 从偏移量读取数据</span></span><br><span class="line">    bytesRead = preadv(fd, iov, <span class="number">2</span>, offset);</span><br><span class="line">    <span class="keyword">if</span> (bytesRead == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;preadv failed&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Bytes read: %zd\n&quot;</span>, bytesRead);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Buffer 1: %.*s\n&quot;</span>, (<span class="type">int</span>)iov[<span class="number">0</span>].iov_len, buf1);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Buffer 2: %.*s\n&quot;</span>, (<span class="type">int</span>)(bytesRead - iov[<span class="number">0</span>].iov_len), buf2);</span><br><span class="line"></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>文件 <code>example.txt</code> 的内容是：</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">HelloWorldThisIspreadvExample</span></span><br></pre></td></tr></table></figure><p>运行程序后，输出结果为</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Buffer</span> <span class="number">1</span>: WorldThis</span><br><span class="line"><span class="attribute">Buffer</span> <span class="number">2</span>: IspreadvExampl</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="pwritev-函数">pwritev()函数</h3><p><code>pwritev()</code> 是 Linux 和 Unix 系统中的系统调用，用于 <strong>从多个缓冲区将数据写入文件的指定偏移量</strong>。与 <code>writev()</code> 的区别在于，<code>pwritev()</code> 提供了一个显式的偏移量参数，写操作从文件中的指定位置开始，而不会更改文件描述符的当前偏移量。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/uio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">pwritev</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="keyword">struct</span> iovec *iov, <span class="type">int</span> iovcnt, <span class="type">off_t</span> offset)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功：返回实际写入的字节数。失败：返回 -1，并设置 errno 指定错误原因。</span></span><br></pre></td></tr></table></figure><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/uio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">ssize_t</span> bytesWritten;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">iovec</span> <span class="title">iov</span>[2];</span></span><br><span class="line">    <span class="type">char</span> buf1[] = <span class="string">&quot;Hello &quot;</span>;</span><br><span class="line">    <span class="type">char</span> buf2[] = <span class="string">&quot;World!&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开文件</span></span><br><span class="line">    fd = open(<span class="string">&quot;example.txt&quot;</span>, O_WRONLY | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置 iovec 缓冲区</span></span><br><span class="line">    iov[<span class="number">0</span>].iov_base = buf1;</span><br><span class="line">    iov[<span class="number">0</span>].iov_len = <span class="built_in">strlen</span>(buf1);</span><br><span class="line">    iov[<span class="number">1</span>].iov_base = buf2;</span><br><span class="line">    iov[<span class="number">1</span>].iov_len = <span class="built_in">strlen</span>(buf2);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 pwritev 从偏移量 0 开始写入数据</span></span><br><span class="line">    bytesWritten = pwritev(fd, iov, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (bytesWritten == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;pwritev failed&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Bytes written: %zd\n&quot;</span>, bytesWritten);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭文件</span></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行程序后，<code>example.txt</code>文件内容为</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello World!</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Bytes</span> written: <span class="number">12</span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="truncate-函数">truncate() 函数</h3><p><code>truncate()</code> 是一个文件操作系统调用，用于将指定文件的大小调整为指定值。如果文件变小，超出部分将被截断；如果文件变大，扩展部分通常填充为零。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">truncate</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *path, <span class="type">off_t</span> length)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//成功：返回 0。失败：返回 -1，并设置 errno 指定错误原因。</span></span><br></pre></td></tr></table></figure><p><strong><code>path</code></strong>:表示文件路径，指向需要调整大小的文件。</p><p><strong><code>length</code></strong>:新的文件大小（以字节为单位）。若文件当前大小大于 <code>length</code>，多余部分会被删除。若文件当前大小小于 <code>length</code>，文件会被扩展，新增部分通常填充为零（文件系统依赖）。</p><details class="folding-tag" green><summary> 使用示例(截断文件) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *filePath = <span class="string">&quot;example.txt&quot;</span>;</span><br><span class="line">    <span class="type">off_t</span> newSize = <span class="number">5</span>;  <span class="comment">// 截断到 5 字节</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开或创建文件并写入内容</span></span><br><span class="line">    <span class="type">int</span> fd = open(filePath, O_WRONLY | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">    write(fd, <span class="string">&quot;Hello, World!&quot;</span>, <span class="number">13</span>);</span><br><span class="line">    close(fd);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 截断文件</span></span><br><span class="line">    <span class="keyword">if</span> (truncate(filePath, newSize) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;truncate failed&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;File &#x27;%s&#x27; has been truncated to %ld bytes.\n&quot;</span>, filePath, (<span class="type">long</span>)newSize);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行程序后，<code>example.txt</code>文件内容为</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Hello</span></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 使用示例(扩展文件大小) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *filePath = <span class="string">&quot;example.txt&quot;</span>;</span><br><span class="line">    <span class="type">off_t</span> newSize = <span class="number">20</span>;  <span class="comment">// 扩展到 20 字节</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建并写入初始内容</span></span><br><span class="line">    <span class="type">int</span> fd = open(filePath, O_WRONLY | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">    write(fd, <span class="string">&quot;Hello&quot;</span>, <span class="number">5</span>);</span><br><span class="line">    close(fd);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 扩展文件大小</span></span><br><span class="line">    <span class="keyword">if</span> (truncate(filePath, newSize) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;truncate failed&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;File &#x27;%s&#x27; has been extended to %ld bytes.\n&quot;</span>, filePath, (<span class="type">long</span>)newSize);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行程序后，<code>example.txt</code>文件内容为</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Hello</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="ftruncate-函数">ftruncate()函数</h3><p><code>ftruncate()</code> 是一个文件操作系统调用，用于通过文件描述符调整打开文件的大小。如果文件变小，超出部分会被截断；如果文件变大，扩展部分通常填充为零。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">ftruncate</span><span class="params">(<span class="type">int</span> fd, <span class="type">off_t</span> length)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功：返回 0。失败：返回 -1，并设置 errno 以指示错误原因。</span></span><br></pre></td></tr></table></figure><p><strong><code>fd</code></strong>:打开文件的文件描述符。文件描述符必须是可写的。</p><p><strong><code>length</code></strong>:调整后的文件大小（以字节为单位）。若文件当前大小大于 <code>length</code>，多余部分会被删除。若文件当前大小小于 <code>length</code>，文件会被扩展，新增部分通常填充为零（文件系统依赖）。</p><details class="folding-tag" green><summary> 使用示例(截断文件) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *filePath = <span class="string">&quot;example.txt&quot;</span>;</span><br><span class="line">    <span class="type">off_t</span> newSize = <span class="number">5</span>;  <span class="comment">// 将文件大小调整为 5 字节</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开文件</span></span><br><span class="line">    <span class="type">int</span> fd = open(filePath, O_RDWR | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入初始内容</span></span><br><span class="line">    write(fd, <span class="string">&quot;Hello, World!&quot;</span>, <span class="number">13</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调整文件大小</span></span><br><span class="line">    <span class="keyword">if</span> (ftruncate(fd, newSize) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;ftruncate failed&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;File &#x27;%s&#x27; truncated to %ld bytes.\n&quot;</span>, filePath, (<span class="type">long</span>)newSize);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭文件</span></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行程序后，<code>example.txt</code>文件内容为</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Hello</span></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 使用示例(扩展文件大小) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *filePath = <span class="string">&quot;example.txt&quot;</span>;</span><br><span class="line">    <span class="type">off_t</span> newSize = <span class="number">20</span>;  <span class="comment">// 将文件大小扩展为 20 字节</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开文件</span></span><br><span class="line">    <span class="type">int</span> fd = open(filePath, O_RDWR | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;Failed to open file&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入初始内容</span></span><br><span class="line">    write(fd, <span class="string">&quot;Hello&quot;</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调整文件大小</span></span><br><span class="line">    <span class="keyword">if</span> (ftruncate(fd, newSize) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;ftruncate failed&quot;</span>);</span><br><span class="line">        close(fd);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;File &#x27;%s&#x27; extended to %ld bytes.\n&quot;</span>, filePath, (<span class="type">long</span>)newSize);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭文件</span></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行程序后，<code>example.txt</code>文件内容为</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Hello</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="mkstemp-函数">mkstemp()函数</h3><p><code>mkstemp()</code> 是一个用于创建临时文件的系统调用。它会创建一个唯一命名的临时文件，防止文件名冲突，并返回一个文件描述符，用于后续文件操作。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">mkstemp</span><span class="params">(<span class="type">char</span> *template)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功：返回一个打开的文件描述符（以读写模式打开）。失败：返回 -1，并设置 errno 以指示错误原因。</span></span><br></pre></td></tr></table></figure><p><strong><code>template</code></strong>:是一个指向以 NULL 结尾的字符串的指针。此字符串必须以 <strong>六个连续的 X</strong> 结尾（如 <code>&quot;tempXXXXXX&quot;</code>）。<code>mkstemp()</code> 会用唯一的文件名替换这些 X，生成文件。注意：该字符串会被修改，最终包含生成的文件名。</p><details class="folding-tag" green><summary> 使用示例(创建临时文件) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> template[] = <span class="string">&quot;/tmp/mytempXXXXXX&quot;</span>;  <span class="comment">// 模板必须以 6 个 X 结尾</span></span><br><span class="line">    <span class="type">int</span> fd = mkstemp(template);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;mkstemp failed&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Temporary file created: %s\n&quot;</span>, template);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入数据</span></span><br><span class="line">    write(fd, <span class="string">&quot;Hello, World!\n&quot;</span>, <span class="number">14</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭并删除文件</span></span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="comment">// 调用 unlink() 删除临时文件。</span></span><br><span class="line">    unlink(template);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 使用示例(在指定目录中创建临时文件) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span> template[] = <span class="string">&quot;./tempXXXXXX&quot;</span>;  <span class="comment">// 在当前目录创建临时文件</span></span><br><span class="line">    <span class="type">int</span> fd = mkstemp(template);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;mkstemp failed&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Temporary file created: %s\n&quot;</span>, template);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 不删除文件，仅关闭描述符</span></span><br><span class="line">    close(fd);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p><strong>注意事项</strong></p><p><strong>安全性</strong></p><ul><li>避免使用不安全的函数（如 <code>tmpnam()</code>），<code>mkstemp()</code> 能更好地防止文件名冲突和竞态条件。</li></ul><p><strong>目录权限</strong></p><ul><li>如果指定路径中的目录不可写，<code>mkstemp()</code> 会失败。</li></ul><p><strong>文件名限制</strong></p><ul><li>模板中的 X 必须不少于 6 个，否则 <code>mkstemp()</code> 会报错。</li></ul><p><strong>文件清理</strong></p><ul><li>创建的临时文件不会自动删除，开发者需要在不使用时调用 <code>unlink()</code> 手动删除文件。</li></ul><h3 id="tmpfile-函数">tmpfile()函数</h3><p><code>tmpfile()</code> 是一个标准 C 库函数，用于创建临时文件。它会创建一个匿名的临时文件，该文件在关闭时或程序退出时会自动删除。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">FILE *<span class="title function_">tmpfile</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功：返回指向临时文件的文件指针 (FILE *)。失败：返回 NULL，并设置 errno 表示错误原因。</span></span><br></pre></td></tr></table></figure><p>tmpfile()函数执行成功，将返回一个文件流供 stdio 库函数使用。文件流关闭后将自动删除临时文件。为达到这一目的，tmpfile()函数会在打开文件后，从内部立即调用 unlink()来删除该文件名 。</p><details class="folding-tag" green><summary> 使用示例(创建并写入临时文件) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    FILE *fp = tmpfile();</span><br><span class="line">    <span class="keyword">if</span> (fp == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;tmpfile failed&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入数据到临时文件</span></span><br><span class="line">    <span class="built_in">fprintf</span>(fp, <span class="string">&quot;This is a temporary file.\n&quot;</span>);</span><br><span class="line">    <span class="built_in">fprintf</span>(fp, <span class="string">&quot;It will be automatically deleted.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将文件指针重置到文件开头</span></span><br><span class="line">    rewind(fp);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取并打印数据</span></span><br><span class="line">    <span class="type">char</span> buffer[<span class="number">128</span>];</span><br><span class="line">    <span class="keyword">while</span> (fgets(buffer, <span class="keyword">sizeof</span>(buffer), fp) != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, buffer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭临时文件（自动删除）</span></span><br><span class="line">    fclose(fp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 使用示例(临时文件用于交换数据) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    FILE *tempFile = tmpfile();</span><br><span class="line">    <span class="keyword">if</span> (tempFile == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;tmpfile failed&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> data[] = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;;</span><br><span class="line">    <span class="type">size_t</span> count = <span class="keyword">sizeof</span>(data) / <span class="keyword">sizeof</span>(data[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 写入数据到临时文件</span></span><br><span class="line">    fwrite(data, <span class="keyword">sizeof</span>(<span class="type">int</span>), count, tempFile);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将文件指针重置到文件开头</span></span><br><span class="line">    rewind(tempFile);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取数据并打印</span></span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">while</span> (fread(&amp;value, <span class="keyword">sizeof</span>(<span class="type">int</span>), <span class="number">1</span>, tempFile) == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关闭临时文件</span></span><br><span class="line">    fclose(tempFile);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="进程">进程</h2><h3 id="getpid-函数">getpid()函数</h3><p><code>getpid()</code> 是一个标准的系统调用，用于获取当前进程的进程标识符（PID）。</p><p>每个进程都有一个进程号（PID），进程号是一个正数，用以唯一标识系统中的某个进程。对各种系统调用而言，进程号有时可以作为传入参数，有时可以作为返回值。比如，系统调用<code>kill()</code>允许调用者向拥有特定进程号的进程发送一个信号。当需要创建一个对某进程而言唯一的标识符时，进程号就会派上用场。常见的例子是将进程号作为与进程相关文件名的一部分。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">pid_t</span> <span class="title function_">getpid</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回当前进程的 ID (pid_t 类型)。通常，进程 ID 是一个大于零的整数。</span></span><br></pre></td></tr></table></figure><p>getpid()返回值的数据类型为 pid_t，该类型是由 SUSv3 所规定的整数类型，专用于存储进程号。除了少数系统进程外，比如 init 进程（进程号为 1），程序与运行该程序进程的进程号之间没有固定关系。Linux 内核限制进程号需小于等于 32767。新进程创建时，内核会按顺序将下一个可用的进程号分配给其使用。每当进程号达到 32767 的限制时，内核将重置进程号计数器，以便从小整数开始分配。</p><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">pid_t</span> pid = getpid();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Current Process ID: %d\n&quot;</span>, pid);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="getppid-函数">getppid()函数</h3><p><code>getppid()</code> 是一个系统调用，用于获取当前进程的父进程标识符（Parent Process ID, PPID）。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">pid_t</span> <span class="title function_">getppid</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回当前进程的父进程的 ID (pid_t 类型)。通常是一个非负整数。特殊情况：当父进程被杀死后，当前进程的父进程会变为系统的 init 进程或其现代替代进程（如 systemd），这时返回的 PPID 为 1。</span></span><br></pre></td></tr></table></figure><p>实际上，每个进程的父进程号属性反映了系统上所有进程间的树状关系。每个进程的父进程又有自己的父进程，以此类推，回溯到 1 号进程—init 进程，即所有进程的始祖。使用pstree(1)命令可以查看到这一“家族树”（family tree）。如果子进程的父进程终止，则子进程就会变成“孤儿”，init 进程随即将收养该进程，子进程后续对 getppid()的调用将返回进程号 1。通过查看由 Linux 系统所特有的/proc/PID/status 文件所提供的 PPid 字段，可以获知每个进程的父进程。</p><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">pid_t</span> ppid = getppid();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Parent Process ID: %d\n&quot;</span>, ppid);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="getenv-函数">getenv()函数</h3><p><code>getenv()</code>函数能够从进程环境中检索单个值。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> *<span class="title function_">getenv</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *name)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 成功： 返回一个指向环境变量值的指针。如果环境变量存在，则返回其值的字符串指针。返回的值是指向环境变量中存储数据的内存，不要修改此内存的内容。失败： 返回 NULL，表示未找到指定的环境变量。</span></span><br></pre></td></tr></table></figure><p><strong><code>name</code></strong>: 环境变量的名称，必须是一个以空字符 <code>'\0'</code> 结尾的字符串。</p><p>功能说明:<strong><code>getenv()</code></strong> 检索环境变量的值。<strong>环境变量</strong> 是键值对形式的字符串，通常用于存储配置信息，如用户路径、系统设置等。如果环境变量存在，则返回指向该变量值的指针；如果不存在，则返回 <code>NULL</code>。</p><details class="folding-tag" green><summary> 使用示例 </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 获取 PATH 环境变量</span></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *path = getenv(<span class="string">&quot;PATH&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (path == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Environment variable PATH not found.\n&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;PATH: %s\n&quot;</span>, path);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取不存在的环境变量</span></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *notExist = getenv(<span class="string">&quot;NOT_EXIST&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (notExist == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Environment variable NOT_EXIST not found.\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出内容</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">PATH</span>: <span class="regexp">/usr/bin</span><span class="symbol">:/bin</span><span class="symbol">:/usr/sbin</span><span class="symbol">:/sbin</span><span class="symbol">:/usr/local/bin</span></span><br><span class="line"><span class="title class_">Environment</span> variable <span class="variable constant_">NOT_EXIST</span> <span class="keyword">not</span> found.</span><br></pre></td></tr></table></figure>              </div>            </details><p><strong>注意事项</strong></p><ol><li><p><strong>检查返回值</strong>： 环境变量可能不存在，使用前需检查返回值是否为 <code>NULL</code>。</p></li><li><p><strong>多线程使用</strong>： 在多线程程序中避免直接调用 <code>getenv()</code>，需要同步或使用线程安全的替代方法。</p></li><li><p><strong>与环境变量的关系</strong>： 环境变量由系统和用户定义，通常可以通过 <code>export</code> 命令设置。例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> MYVAR=<span class="string">&quot;HelloWorld&quot;</span></span><br></pre></td></tr></table></figure><p>然后可以在 C 程序中使用 <code>getenv(&quot;MYVAR&quot;)</code> 获取其值。</p></li></ol><h3 id="putenv-函数">putenv()函数</h3><p><code>putenv()</code> 是一个标准 C 库函数，用于向环境中添加新的环境变量或修改已有的环境变量。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">putenv</span><span class="params">(<span class="type">char</span> *<span class="built_in">string</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回值0: 成功。-1: 失败（例如，内存不足时）。</span></span><br></pre></td></tr></table></figure><p><strong><code>string</code></strong>:一个以 <code>name=value</code> 格式表示的字符串，用于设置环境变量。<code>name</code> 是环境变量的名称，<code>value</code> 是对应的值。必须确保传递的字符串格式正确，且以 <code>\0</code> 结尾。</p><details class="folding-tag" green><summary> 使用示例(添加新变量) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 添加环境变量</span></span><br><span class="line">    <span class="keyword">if</span> (putenv(<span class="string">&quot;MYVAR=HelloWorld&quot;</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;putenv failed&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> EXIT_FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 验证变量是否已添加</span></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *value = getenv(<span class="string">&quot;MYVAR&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (value == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Environment variable MYVAR not found.\n&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;MYVAR: %s\n&quot;</span>, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 使用示例(修改已有变量) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 设置环境变量</span></span><br><span class="line">    <span class="type">char</span> env[] = <span class="string">&quot;MYVAR=InitialValue&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (putenv(env) != <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;putenv failed&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> EXIT_FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Before modification: %s\n&quot;</span>, getenv(<span class="string">&quot;MYVAR&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 修改变量的值</span></span><br><span class="line">    <span class="built_in">strcpy</span>(env, <span class="string">&quot;MYVAR=ModifiedValue&quot;</span>); <span class="comment">// 修改内存内容</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;After modification: %s\n&quot;</span>, getenv(<span class="string">&quot;MYVAR&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p><strong>注意事项</strong></p><ol><li><strong><code>string</code> 的内存管理</strong>：<ul><li><code>putenv()</code> 不复制传递的字符串，直接使用它的指针。</li><li>如果 <code>string</code> 是动态分配的，释放该内存可能导致环境变量变为非法。</li></ul></li><li><strong>修改内容的副作用</strong>：<ul><li>修改传递给 <code>putenv()</code> 的字符串内容会直接影响环境变量。</li><li>示例中，通过 <code>strcpy</code> 修改 <code>env</code> 后，<code>getenv()</code> 的返回值也会随之改变。</li></ul></li><li><strong>格式要求</strong>：<ul><li>必须以 <code>name=value</code> 格式传递字符串。</li><li>如果格式不正确，可能会导致不可预期的行为。</li></ul></li><li><strong>线程安全性</strong>：<ul><li><code>putenv()</code> 是 <strong>非线程安全</strong> 的。</li><li>在多线程程序中调用时，需确保同步机制，避免竞争条件。</li></ul></li><li><strong>性能问题</strong>：<ul><li>每次调用 <code>putenv()</code> 都可能导致环境变量表重新分配内存，影响性能。</li></ul></li><li><strong>建议使用 <code>setenv()</code> 替代</strong>：<ul><li><code>setenv()</code> 是线程安全的，并且会复制传入的值，避免了许多 <code>putenv()</code> 的问题。</li></ul></li></ol><h3 id="setenv-函数">setenv()函数</h3><p><code>setenv()</code> 是一个标准 C 库函数，用于添加新的环境变量或修改现有的环境变量。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">setenv</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *name, <span class="type">const</span> <span class="type">char</span> *value, <span class="type">int</span> overwrite)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0: 成功。-1: 失败（例如，内存不足或参数无效）。错误时，errno 会被设置为具体错误码。</span></span><br></pre></td></tr></table></figure><p><strong><code>name</code></strong>:环境变量的名称。必须是有效的字符串，不能包含等号 (<code>=</code>)，且不能为空。</p><p><strong><code>value</code></strong>:环境变量的值。如果为空字符串，表示设置该变量为空值。</p><p><strong><code>overwrite</code></strong>:一个整型标志，用于指示是否允许覆盖已有的环境变量：<strong>非零值</strong>：如果环境变量已存在，将覆盖其值。<strong>零值</strong>：如果环境变量已存在，则不改变其值。</p><details class="folding-tag" green><summary> 使用示例(添加新环境变量) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 添加新的环境变量</span></span><br><span class="line">    <span class="keyword">if</span> (setenv(<span class="string">&quot;MYVAR&quot;</span>, <span class="string">&quot;HelloWorld&quot;</span>, <span class="number">1</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;setenv failed&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> EXIT_FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 验证是否添加成功</span></span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> *value = getenv(<span class="string">&quot;MYVAR&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;MYVAR: %s\n&quot;</span>, value);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Environment variable MYVAR not found.\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 使用示例(覆盖已有变量) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 设置环境变量</span></span><br><span class="line">    setenv(<span class="string">&quot;MYVAR&quot;</span>, <span class="string">&quot;InitialValue&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;MYVAR before overwrite: %s\n&quot;</span>, getenv(<span class="string">&quot;MYVAR&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 修改已有变量</span></span><br><span class="line">    setenv(<span class="string">&quot;MYVAR&quot;</span>, <span class="string">&quot;ModifiedValue&quot;</span>, <span class="number">1</span>);  <span class="comment">// 允许覆盖</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;MYVAR after overwrite: %s\n&quot;</span>, getenv(<span class="string">&quot;MYVAR&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 使用示例(不覆盖已有变量) </summary>              <div class='content'>              <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 设置环境变量</span></span><br><span class="line">    setenv(<span class="string">&quot;MYVAR&quot;</span>, <span class="string">&quot;InitialValue&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;MYVAR before overwrite: %s\n&quot;</span>, getenv(<span class="string">&quot;MYVAR&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 尝试不覆盖已有变量</span></span><br><span class="line">    setenv(<span class="string">&quot;MYVAR&quot;</span>, <span class="string">&quot;IgnoredValue&quot;</span>, <span class="number">0</span>);  <span class="comment">// 禁止覆盖</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;MYVAR after no-overwrite attempt: %s\n&quot;</span>, getenv(<span class="string">&quot;MYVAR&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><p><strong>注意事项</strong></p><ol><li><strong>参数验证</strong>：<ul><li><code>name</code> 不能为空，且不能包含等号 (<code>=</code>)。</li><li>若传递非法参数，<code>setenv()</code> 将返回错误并设置 <code>errno</code>。</li></ul></li><li><strong>线程安全</strong>：<ul><li>多线程环境下，<code>setenv()</code> 是安全的。</li><li>但需要注意并发操作中对同一环境变量的竞争条件。</li></ul></li><li><strong>内存分配</strong>：<ul><li><code>setenv()</code> 会分配内存来存储环境变量，用户无需关心内存管理。</li><li>但频繁设置环境变量可能导致内存碎片化。</li></ul></li><li><strong>性能开销</strong>：<ul><li><code>setenv()</code> 每次调用可能需要重新调整环境表，频繁调用可能影响性能。</li></ul></li><li><strong>与 <code>putenv()</code> 的区别</strong>：<ul><li><code>setenv()</code> 复制输入字符串，<code>putenv()</code> 不会复制，直接使用指针。</li><li><code>setenv()</code> 更安全，但开销可能略高于 <code>putenv()</code>。</li></ul></li><li><strong>与 <code>unsetenv()</code> 配合使用</strong>：<ul><li>可以使用 <code>unsetenv()</code> 删除环境变量，确保环境表保持干净。</li></ul></li></ol><h2 id="进程的创建">进程的创建</h2><h3 id="fork-函数">fork()函数</h3><p>在诸多应用中，创建多个进程是任务分解时行之有效的方法。例如，某一网络服务器进程可在侦听客户端请求的同时，为处理每一请求而创建一新的子进程，与此同时，服务器进程会继续侦听更多的客户端连接请求。以此类手法分解任务，通常会简化应用程序的设计，同时提高了系统的并发性。（即，可同时处理更多的任务或请求。）系统调用 fork()创建一新进程（child），几近于对调用进程（parent）的翻版。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">pid t <span class="title function_">fork</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在父进程中：成功时返回子进程的进程 ID，出错时返回 -1；</span></span><br><span class="line"><span class="comment">//在成功创建的子进程中：始终返回 0。</span></span><br></pre></td></tr></table></figure><p>理解 fork()的诀窍是，要意识到，完成对其调用后将存在两个进程，且每个进程都会从 fork()的返回处继续执行。这两个进程将执行相同的程序文本段，但却各自拥有不同的栈段、数据段以及堆段拷贝。子进程的栈、数据以及栈段开始时是对父进程内存相应各部分的完全复制。执行 fork()之后，每个进程均可修改各自的栈数据、以及堆段中的变量，而并<strong>不影响另一进程</strong>。</p><p>程序代码则可通过 fork()的返回值来区分父、子进程。在父进程中，fork()将返回新创建子进程的进程 ID。鉴于父进程可能需要创建，进而追踪多个子进程（通过 wait()或类似方法），这种安排还是很实用的。而 fork()在子进程中则返回 0。如有必要，子进程可调用 getpid()以获取自身的进程 ID，调用 getppid()以获取父进程 ID。</p><p>当无法创建子进程时，fork()将返回-1。失败的原因可能在于，进程数量要么超出了系统针对此真实用户（real user ID）在进程数量上所施加的限制，要么是触及允许该系统创建的最大进程数这一系统级上限。</p><p>调用 fork()时，有时会采用如下习惯用语：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">pid_t</span> childPid;</span><br><span class="line"><span class="keyword">switch</span> (childPid = fork())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">        <span class="comment">//处理错误</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="comment">//子进程行为</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="comment">//父进程行为</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用 fork()之后，系统将率先“垂青”于哪个进程（即调度其使用 CPU），是无法确定的，意识到这一点极为重要。在设计拙劣的程序中，这种不确定性可能会导致所谓“竞争条件（race condition）”的错误</p><h3 id="vfork-函数">vfork()函数</h3><p>在早期的 BSD 实现中，fork()会对父进程的数据段、堆和栈施行严格的复制。如前所述，这是一种浪费，尤其是在调用 fork()后立即执行 exec()的情况下。出于这一原因，BSD 的后期版本引入了 vfork()系统调用，尽管其运作含义稍微有些不同（实则有些怪异），但效率要远高于 BSD fork()。现代 UNIX 采用写时复制技术来实现 fork()，其效率较之于早期的 fork()实现要高出许多，进而将对 vfork()的需求剔除殆尽。虽然如此，Linux（如同许多其他的 UNIX 实现一样）还是提供了具有 BSD 语义的 vfork()系统调用，以期为程序提供尽可能快的 fork 功能。不过，鉴于 vfork()的怪异语义可能会导致一些难以察觉的程序缺陷（bug），除非能给性能带来重大提升（这种情况发生的概率极小），否则应当尽量避免使用这一调用。</p><p>类似于 fork()，vfork()可以为调用进程创建一个新的子进程。然而，vfork()是为子进程立即执行 exec()的程序而专门设计的。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd,h&gt;</span></span></span><br><span class="line"></span><br><span class="line">pid t <span class="title function_">vfork</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在父进程中：成功时返回子进程的进程 ID，失败时返回 -1；</span></span><br><span class="line"><span class="comment">//在成功创建的子进程中：始终返回 0。</span></span><br></pre></td></tr></table></figure><p>vfork()因为如下两个特性而更具效率，这也是其与 fork()的区别所在。</p><ul><li>无需为子进程复制虚拟内存页或页表。相反，子进程共享父进程的内存，直至其成功执行了 exec()或是调用_exit()退出。</li><li>在子进程调用 exec()或_exit()之前，将暂停执行父进程。</li></ul><h3 id="exit-函数">_exit()函数</h3><p>通常，进程有两种终止方式。其一为异常（abnormal）终止，由对一信号的接收而引发，该信号的默认动作为终止当前进程，可能产生核心转储（core dump）。此外，进程可使用_exit()系统调用正常（normally）终止。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd,h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">exit</span><span class="params">(<span class="type">int</span> status)</span>;</span><br></pre></td></tr></table></figure><p>_exit()的 status 参数定义了进程的终止状态（termination status），父进程可调用 wait()以获取该状态。虽然将其定义为 int 类型，但仅有低 8 位可为父进程所用。按照惯例，终止状态为 0 表示进程“功成身退”，而非 0 值则表示进程因异常而退出。对非 0 返回值的解释则并无定例；不同的应用程序自成一派，并会在文档中加以描述。SUSv3 规定有两个常量：EXIT_SUCCESS(0)和 EXIT_FAILURE(1)，本书中大部分程序就采用了这一约定。</p><p>调用_exit()的程序总会成功终止（即，_exit()从不返回）。</p><h3 id="wait-函数">wait()函数</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">pid t <span class="title function_">wait</span><span class="params">(<span class="type">int</span> *stalus)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//返回已终止子进程的进程 ID，或者在出错时返回 -1。</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2</summary>
        
      
    
    
    
    <category term="操作系统" scheme="https://www.wikunkun.asia/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    
    
    <category term="Linux" scheme="https://www.wikunkun.asia/tags/Linux/"/>
    
    <category term="远程开发" scheme="https://www.wikunkun.asia/tags/%E8%BF%9C%E7%A8%8B%E5%BC%80%E5%8F%91/"/>
    
    <category term="C/C++" scheme="https://www.wikunkun.asia/tags/C-C/"/>
    
    <category term="系统调用" scheme="https://www.wikunkun.asia/tags/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>Linux上的vcpkg安装</title>
    <link href="https://www.wikunkun.asia/posts/2338738d.html"/>
    <id>https://www.wikunkun.asia/posts/2338738d.html</id>
    <published>2025-01-12T08:06:38.000Z</published>
    <updated>2025-02-13T10:39:02.420Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装vcpkg">安装vcpkg</h2><p>安装可能会用到的依赖</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install -y git curl zip unzip tar cmake g++ build-essential</span><br><span class="line"><span class="built_in">sudo</span> apt-get install pkg-config</span><br></pre></td></tr></table></figure><p>克隆github仓库</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/microsoft/vcpkg.git</span><br></pre></td></tr></table></figure><p>如果克隆不下来的话,就使用https://ghproxy.cc加速</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">git <span class="built_in">clone</span> https://ghproxy.cc/https://github.com/microsoft/vcpkg.git</span><br></pre></td></tr></table></figure><p>进入克隆的仓库</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> vcpkg</span><br></pre></td></tr></table></figure><p>运行安装脚本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bootstrap-vcpkg.sh</span><br></pre></td></tr></table></figure><p>配置环境变量</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取安装位置</span></span><br><span class="line"><span class="built_in">pwd</span></span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250112162428231.png" alt="image-20250112162428231"></p><p>博主这里的安装位置为</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/ecs-user/vcpkg/vcpkg</span><br></pre></td></tr></table></figure><p>修改文件<code>.bashrc</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure><p>添加环境变量**(/home/ecs-user/vcpkg/vcpkg记得改成你自己的)**</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/home/ecs-user/vcpkg/vcpkg:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250112162610585.png" alt="image-20250112162610585"></p><p>更新环境变量</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><p>查看是否安装成功</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~</span><br><span class="line">vcpkg</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250112162752574.png" alt="image-20250112162752574"></p><p>vcpkg安装相关库</p><p>更新 vcpkg 的库索引</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vcpkg update</span><br></pre></td></tr></table></figure><p>安装 <code>cJSON</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vcpkg install cjson</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;安装vcpkg&quot;&gt;安装vcpkg&lt;/h2&gt;
&lt;p&gt;安装可能会用到的依赖&lt;/p&gt;
&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span</summary>
        
      
    
    
    
    <category term="Linux平台开发" scheme="https://www.wikunkun.asia/categories/Linux%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="Linux" scheme="https://www.wikunkun.asia/tags/Linux/"/>
    
    <category term="C/C++" scheme="https://www.wikunkun.asia/tags/C-C/"/>
    
  </entry>
  
  <entry>
    <title>VSCode连接Linux服务器进行远程C++开发</title>
    <link href="https://www.wikunkun.asia/posts/18ae5e5d.html"/>
    <id>https://www.wikunkun.asia/posts/18ae5e5d.html</id>
    <published>2025-01-07T03:21:01.000Z</published>
    <updated>2025-04-27T09:05:24.469Z</updated>
    
    <content type="html"><![CDATA[<h2 id="工具">工具</h2><ul><li><a href="https://code.visualstudio.com/">VSCode</a></li><li>一台云服务器 (本文用阿里云 ECS 服务器)</li></ul><h2 id="环境">环境</h2><ul><li><code>windows10</code></li><li><code>Ubuntu22.04.4</code></li></ul><h2 id="VSCode远程连接Linux服务器">VSCode远程连接Linux服务器</h2><h3 id="配置SSH连接">配置SSH连接</h3><p>搜索<code>SSH</code>，安装<code>Remote - SSH</code>插件</p><p><img src="https://lambda-image-1.pages.dev/image-20250107112516138.png" alt="image-20250107112516138"></p><p>右键底部勾选远程主机</p><p><img src="https://lambda-image-1.pages.dev/image-20250107112730755.png" alt="image-20250107112730755"></p><p>开始连接</p><p><img src="https://lambda-image-1.pages.dev/image-20250107112830492.png" alt="image-20250107112830492"></p><p>点击配置SSH主机</p><p><img src="https://lambda-image-1.pages.dev/image-20250107114630289.png" alt="image-20250107114630289"></p><p>点击第一个文件</p><p><img src="https://lambda-image-1.pages.dev/image-20250107114648392.png" alt="image-20250107114648392"></p><p>配置SSH文件，修改红框的内容</p><p><img src="https://lambda-image-1.pages.dev/image-20250107122255673.png" alt="image-20250107122255673"></p><p>连接刚刚配置好的Linux服务器</p><p><img src="https://lambda-image-1.pages.dev/image-20250107122326372.png" alt="image-20250107122326372"></p><p>点击Linux</p><p><img src="https://lambda-image-1.pages.dev/image-20250107114940513.png" alt="image-20250107114940513"></p><p>输入密码</p><p><img src="https://lambda-image-1.pages.dev/image-20250107115011504.png" alt="image-20250107115011504"></p><p>至此已经连接成功</p><p><img src="https://lambda-image-1.pages.dev/image-20250107122508091.png" alt="image-20250107122508091"></p><h3 id="配置免密码登录">配置免密码登录</h3><p><img src="https://lambda-image-1.pages.dev/image-20250107123427722.png" alt="image-20250107123427722"></p><p>绑定密钥对</p><p><img src="https://lambda-image-1.pages.dev/image-20250107123441870.png" alt="image-20250107123441870"></p><p>没有密钥的话就创建密钥，然后选择创建好的密钥</p><p><img src="https://lambda-image-1.pages.dev/image-20250107123458390.png" alt="image-20250107123458390"></p><p>把私钥放到相关的文件夹</p><p><img src="https://lambda-image-1.pages.dev/image-20250107124357607.png" alt="image-20250107124357607"></p><p>一般是<code>C:\Users\Administrator\.ssh</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250107124435396.png" alt="image-20250107124435396"></p><p>文件夹内容</p><p><img src="https://lambda-image-1.pages.dev/image-20250107131451184.png" alt="image-20250107131451184"></p><p>修改之前<code>VSCODE</code>中的<code>SSH</code>配置，添加<code>IdentityFile</code></p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Read more about SSH config files: https://linux.die.net/man/5/ssh_config</span></span><br><span class="line">Host xxxxx</span><br><span class="line">    <span class="comment">#HostName为主机的IP地址</span></span><br><span class="line">    HostName xx.xx.xx.xx</span><br><span class="line">    <span class="comment">#User为登录Linux的用户</span></span><br><span class="line">    <span class="keyword">User</span> <span class="title">ecs-user</span></span><br><span class="line">    <span class="comment">#Port为连接的端口号</span></span><br><span class="line">    Port <span class="number">22</span></span><br><span class="line">    <span class="comment"># pem 文件的位置</span></span><br><span class="line">    IdentityFile C:\Users\Administrator\.ssh\lambda.pem </span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250107124637238.png" alt="image-20250107124637238"></p><h2 id="C-C-编程">C/C++编程</h2><h3 id="安装环境">安装环境</h3><p>确保安装了<code>gcc</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -v</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250107134650138.png" alt="image-20250107134650138"></p><p>安装<code>GDB 调试器</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update # 更新软件包源 </span><br><span class="line">sudo apt-get install build-essential gdb</span><br></pre></td></tr></table></figure><h3 id="VSCode中安装并配置开发插件">VSCode中安装并配置开发插件</h3><p>安装C++开发插件</p><p><img src="https://lambda-image-1.pages.dev/image-20250107131833820.png" alt="image-20250107131833820"></p><p>配置自动提示，<code>CTRL+,</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250107132016756.png" alt="image-20250107132016756"></p><p>输入以下内容</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;workbench.iconTheme&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-icons&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;editor.mouseWheelZoom&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;cSpell.languageSettings&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;workbench.colorTheme&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Default Dark+&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;cmake.configureOnOpen&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;editor.minimap.enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;C_Cpp.autocomplete&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Default&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;[cpp]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;editor.quickSuggestions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;comments&quot;</span><span class="punctuation">:</span> <span class="string">&quot;on&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;strings&quot;</span><span class="punctuation">:</span> <span class="string">&quot;on&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;other&quot;</span><span class="punctuation">:</span> <span class="string">&quot;on&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;[c]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;editor.quickSuggestions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;comments&quot;</span><span class="punctuation">:</span> <span class="string">&quot;on&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;strings&quot;</span><span class="punctuation">:</span> <span class="string">&quot;on&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;other&quot;</span><span class="punctuation">:</span> <span class="string">&quot;on&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;explorer.confirmDelete&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 这个根据自己的情况来进行配置</span></span><br><span class="line">    <span class="attr">&quot;remote.SSH.remotePlatform&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;学习公费服务器&quot;</span><span class="punctuation">:</span> <span class="string">&quot;linux&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="配置编译功能">配置编译功能</h3><p>先打开一个<code>.cpp</code>文件</p><p><img src="https://lambda-image-1.pages.dev/image-20250107132319602.png" alt="image-20250107132319602"></p><p>选择<strong>C/C++:g++生成活动任务</strong></p><p><img src="https://lambda-image-1.pages.dev/image-20250107133256998.png" alt="image-20250107133256998"></p><p>上述操作将自动在.vscode文件夹下生成tasks.json文件。当然你也可以自己创建该文件</p><p><img src="https://lambda-image-1.pages.dev/image-20250107133333601.png" alt="image-20250107133333601"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;tasks&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="comment">//这个是C++的编译配置</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cppbuild&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="comment">// 记住这个，等下有用</span></span><br><span class="line"><span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C/C++: g++ 生成活动文件&quot;</span><span class="punctuation">,</span> </span><br><span class="line"><span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/g++&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="string">&quot;-fdiagnostics-color=always&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;-g&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;-o&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;fileDirname&#125;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;problemMatcher&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="string">&quot;$gcc&quot;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;group&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;detail&quot;</span><span class="punctuation">:</span> <span class="string">&quot;编译器: /usr/bin/g++&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="comment">//这个是C语言的编译配置</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cppbuild&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C/C++: gcc 生成活动文件&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/gcc&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="string">&quot;-fdiagnostics-color=always&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;-g&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;-o&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;fileDirname&#125;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;problemMatcher&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="string">&quot;$gcc&quot;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;group&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;kind&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;isDefault&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;detail&quot;</span><span class="punctuation">:</span> <span class="string">&quot;编译器: /usr/bin/gcc&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>点击要编译的文件</p><p><img src="https://lambda-image-1.pages.dev/image-20250107133411882.png" alt="image-20250107133411882"></p><p>编译文件</p><p><img src="https://lambda-image-1.pages.dev/image-20250107132623763.png" alt="image-20250107132623763"></p><p>点击<strong>C/C++:g++生成活动任务</strong></p><p><img src="https://lambda-image-1.pages.dev/image-20250107133500037.png" alt="image-20250107133500037"></p><p>生成成功</p><p><img src="https://lambda-image-1.pages.dev/image-20250107133524895.png" alt="image-20250107133524895"></p><p>运行编译后的文件</p><p><img src="https://lambda-image-1.pages.dev/image-20250107133551994.png" alt="image-20250107133551994"></p><p>输入<code>./main</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250107133617247.png" alt="image-20250107133617247"></p><p>查看运行结果</p><p><img src="https://lambda-image-1.pages.dev/image-20250107133643574.png" alt="image-20250107133643574"></p><h3 id="调试Debug">调试Debug</h3><p><img src="https://lambda-image-1.pages.dev/image-20250107133741714.png" alt="image-20250107133741714"></p><p>选择<code>C++(GDB/LLDB)</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250107133823725.png" alt="image-20250107133823725"></p><p>自动创建了文件<code>launch.json</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250107134925725.png" alt="image-20250107134925725"></p><p>点击添加配置，选择<code>C/C++ (gdb) 启动</code></p><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250112134959092.png" alt="image-20250112134959092"></p><p>修改<code>launch.json</code></p><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250112135428158.png" alt="image-20250112135428158"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// 使用 IntelliSense 了解相关属性。 </span></span><br><span class="line">    <span class="comment">// 悬停以查看现有属性的描述。</span></span><br><span class="line">    <span class="comment">// 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(gdb) 启动&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cppdbg&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="comment">//这是运行时添加的额外参数</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;stopAtEntry&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;fileDirname&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;environment&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;externalConsole&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;MIMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gdb&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;setupCommands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;为 gdb 启用整齐打印&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;-enable-pretty-printing&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;ignoreFailures&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;将反汇编风格设置为 Intel&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;-gdb-set disassembly-flavor intel&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;ignoreFailures&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="comment">//preLaunchTask位进行调试之前需要执行的任务,即编译构建生成</span></span><br><span class="line">            <span class="attr">&quot;preLaunchTask&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C/C++: g++ 生成活动文件&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;miDebuggerPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/gdb&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250107135753874.png" alt="image-20250107135753874"></p><p>在需要调试的文件中按<code>F5</code>启动调试</p><p><img src="https://lambda-image-1.pages.dev/image-20250107135927264.png" alt="image-20250107135927264"></p><p>这里可以进行调试的相关操作</p><p><img src="https://lambda-image-1.pages.dev/image-20250107140024813.png" alt="image-20250107140024813"></p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;工具&quot;&gt;工具&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://code.visualstudio.com/&quot;&gt;VSCode&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;一台云服务器 (本文用阿里云 ECS 服务器)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2</summary>
        
      
    
    
    
    <category term="Linux平台开发" scheme="https://www.wikunkun.asia/categories/Linux%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="Linux" scheme="https://www.wikunkun.asia/tags/Linux/"/>
    
    <category term="远程开发" scheme="https://www.wikunkun.asia/tags/%E8%BF%9C%E7%A8%8B%E5%BC%80%E5%8F%91/"/>
    
    <category term="C/C++" scheme="https://www.wikunkun.asia/tags/C-C/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot中拦截请求的方式</title>
    <link href="https://www.wikunkun.asia/posts/e02212fc.html"/>
    <id>https://www.wikunkun.asia/posts/e02212fc.html</id>
    <published>2025-01-05T03:08:46.000Z</published>
    <updated>2025-02-13T10:39:02.418Z</updated>
    
    <content type="html"><![CDATA[<h2 id="工具">工具</h2><ul><li><a href="https://www.jetbrains.com/idea/">IDEA专业版</a></li></ul><h2 id="环境">环境</h2><ul><li>windows10</li><li><a href="https://maven.org.cn/">Maven3.9.5</a></li><li>jdk1.8</li></ul><h2 id="Filter（过滤器）">Filter（过滤器）</h2><p><strong>Filter</strong>是<strong>Spring</strong>中的拦截机制之一,位于<strong>Servlet 容器层</strong>,作用于 HTTP 请求和响应的生命周期,最早执行，位于拦截器和切面之前.</p><p>可以有多个过滤器,多个过滤器时，按 <code>FilterRegistrationBean</code> 的顺序或注册顺序执行</p><p><img src="https://lambda-image-1.pages.dev/Filter(%E8%BF%87%E6%BB%A4%E5%99%A8).drawio.png" alt="Filter(过滤器).drawio"></p><p>过滤器可以拿到<strong>请求数据</strong>：<code>ServletRequest</code>（如请求 URL、Headers、Body 等）。<strong>响应数据</strong>：<code>ServletResponse</code>（如设置响应的状态码、Headers 等）。常用于:①请求/响应的日志记录。②安全认证与授权（如检查 Header 的 Token）。③设置编码格式（如 <code>request.setCharacterEncoding(&quot;UTF-8&quot;)</code>）。④处理跨域请求（CORS）。⑤请求/响应的流操作（如压缩响应内容）。</p><h3 id="过滤器的生命周期">过滤器的生命周期</h3><ul><li><p>init()： 初始化Filter 实例，Filter 的生命周期与 Servlet 是相同的，也就是当 Web 容器（tomcat）启动时，调用 init() 方法初始化实例，Filter只会初始化一次。需要设置初始化参数的时候，可以写到init()方法中。</p></li><li><p>doFilter()： 业务处理，拦截要执行的请求，对请求和响应进行处理，一般需要处理的业务操作都在这个方法中实现</p></li><li><p>destroy() ： 销毁实例，关闭容器时调用 destroy() 销毁 Filter 的实例。</p></li></ul><h3 id="过滤器的使用">过滤器的使用</h3><p>首先实现 <code>javax.servlet.Filter</code> 接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: Lambda</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 自定义过滤器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2025/1/5 上午11:37</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">// 初始化逻辑（可选）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Initializing MyFilter&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="comment">// 前置处理逻辑</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Request processing in MyFilter&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 继续调用下一个过滤器或目标资源</span></span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 后置处理逻辑（响应处理）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Response processing in MyFilter&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 释放资源（可选）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Destroying MyFilter&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这里我们可以获取到请求的内容<code>ServletRequest</code>,响应的内容<code>ServletResponse</code>,获取请求的内容很简单,只要直接操作<code>ServletRequest</code>就行,但获取响应内容,单靠<code>ServletResponse</code>现在这样还是不行的,以下是<code>ServletResponse</code>无法获取响应内容的原因</p><ul><li>ServletResponse 的工作方式</li></ul><p><code>ServletResponse</code> 是用于<strong>写入响应</strong>（而不是读取）的接口。它的主要职责是向客户端发送数据，例如 HTML、JSON、文件流等。数据一旦写入到输出流（<code>OutputStream</code> 或 <code>Writer</code>），会被直接发送到客户端或缓存，默认情况下不保留在服务端。并且写入不可逆,数据写入输出流后，系统假定它已发送，原始数据不会被存储在内存中。因此，无法通过 <code>ServletResponse</code> 直接读取已写入的数据。</p><ul><li>ServletOutputStream 是一个单向流</li></ul><p><code>ServletResponse</code> 提供的 <code>ServletOutputStream</code> 和 <code>PrintWriter</code> 都是面向输出的<strong>单向流</strong>，设计目的是将数据从服务器发送到客户端。单向流的特点是数据写入后无法直接读取。并且没有“回读”机制,一旦数据写入流中，就会流向网络层或缓冲区，<code>ServletOutputStream</code> 本身没有能力缓存或重现这些数据。</p><ul><li>数据流的发送路径</li></ul><p>HTTP 响应的处理流程大致如下：①<strong>服务器端生成响应内容：</strong> 通过 <code>ServletResponse</code> 的流接口将数据写入。②<strong>数据发送到客户端：</strong> 通过网络传输，数据被发送到客户端（如浏览器）。③<strong>客户端接收并渲染响应：</strong> 客户端解析 HTTP 响应头和主体并进行处理。</p><p>在这个流程中，<code>ServletResponse</code> 的作用是数据的“发送者”，它不负责存储或记录已发送的数据。</p><ul><li>ServletResponse 的设计原则</li></ul><p><code>ServletResponse</code> 遵循了 Java 的 <strong>单一职责原则</strong> 和 <strong>流式处理</strong> 设计理念：①单一职责：<code>ServletResponse</code> 的职责是生成和发送 HTTP 响应，而不是存储数据。②流式处理：通过流的方式节约内存，尤其是在处理大数据量的响应时，可以避免内存溢出。</p><p>从以上几个方面表明<code>ServletResponse</code>中是无法获取到响应数据的，那么改如何获取到响应的数据呢？虽然无法直接通过 <code>ServletResponse</code> 获取内容，但可以通过以下方式实现：①<strong>包装响应对象：</strong> 使用 <code>HttpServletResponseWrapper</code>，将数据写入一个临时缓冲区，捕获输出内容。②<strong>代理输出流：</strong> 自定义 <code>ServletOutputStream</code> 或 <code>PrintWriter</code>，将所有写入的数据同时记录到缓冲区中，供后续读取。</p><p>以下是捕获响应内容的示例代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.ServletOutputStream;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponseWrapper;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CapturingResponseWrapper</span> <span class="keyword">extends</span> <span class="title class_">HttpServletResponseWrapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">ByteArrayOutputStream</span> <span class="variable">buffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PrintWriter</span>(<span class="built_in">this</span>.buffer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CapturingResponseWrapper</span><span class="params">(HttpServletResponse response)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ServletOutputStream <span class="title function_">getOutputStream</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServletOutputStreamWrapper</span>(<span class="built_in">this</span>.buffer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PrintWriter <span class="title function_">getWriter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.writer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">flushBuffer</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 确保字符流中的内容写入缓冲区</span></span><br><span class="line">            <span class="built_in">this</span>.writer.flush();</span><br><span class="line">            <span class="comment">// 确保缓冲区数据完整</span></span><br><span class="line">            <span class="built_in">this</span>.buffer.flush();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Error flushing buffer&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getContent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 确保所有数据写入缓冲区</span></span><br><span class="line">        <span class="built_in">this</span>.flushBuffer();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="built_in">this</span>.buffer.toByteArray(), StandardCharsets.UTF_8);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ServletOutputStreamWrapper</span> <span class="keyword">extends</span> <span class="title class_">ServletOutputStream</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> ByteArrayOutputStream outputStream;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ServletOutputStreamWrapper</span><span class="params">(ByteArrayOutputStream outputStream)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.outputStream = outputStream;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> b)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.outputStream.write(b);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isReady</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setWriteListener</span><span class="params">(javax.servlet.WriteListener writeListener)</span> &#123;</span><br><span class="line">            <span class="comment">// No-op</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>修改之前的<code>MyFilter</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: Lambda</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 自定义过滤器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2025/1/5 上午11:37</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">// 初始化逻辑（可选）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Initializing MyFilter&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="comment">// 前置处理逻辑</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Request processing in MyFilter&quot;</span>);</span><br><span class="line">        <span class="type">CapturingResponseWrapper</span> <span class="variable">capturingResponseWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CapturingResponseWrapper</span>((HttpServletResponse) response);</span><br><span class="line">        <span class="comment">// 继续调用下一个过滤器或目标资源</span></span><br><span class="line">        chain.doFilter(request, capturingResponseWrapper);</span><br><span class="line">        <span class="comment">//打印响应的内容</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> capturingResponseWrapper.getContent();</span><br><span class="line">        System.out.println(<span class="string">&quot;Response content &quot;</span> + content);</span><br><span class="line">        <span class="comment">// 后置处理逻辑（响应处理）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Response processing in MyFilter&quot;</span>);</span><br><span class="line">        <span class="comment">//获取完响应的内容后记得把数据重新写入ServletResponse</span></span><br><span class="line">        response.getWriter().write(content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 释放资源（可选）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Destroying MyFilter&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到已经获取到了响应的内容</p><p><img src="https://lambda-image-1.pages.dev/image-20250105122316109.png" alt="image-20250105122316109"></p><h3 id="注册过滤器">注册过滤器</h3><h4 id="通过-Component-注解">通过 <code>@Component</code> 注解</h4><p>将自定义过滤器声明为 Spring 的组件：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: Lambda</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 自定义过滤器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2025/1/5 上午11:37</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="comment">// 初始化逻辑（可选）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Initializing MyFilter&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="comment">// 前置处理逻辑</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Request processing in MyFilter&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 继续调用下一个过滤器或目标资源</span></span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 后置处理逻辑（响应处理）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Response processing in MyFilter&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 释放资源（可选）</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Destroying MyFilter&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>特点：自动注册，不需要额外配置。默认对所有请求生效。</p><h4 id="通过-FilterRegistrationBean">通过 <code>FilterRegistrationBean</code></h4><p>如果需要更细粒度的控制（如设置特定 URL 映射或顺序），使用 <code>FilterRegistrationBean</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.web.servlet.FilterRegistrationBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FilterConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FilterRegistrationBean&lt;MyFilter&gt; <span class="title function_">myFilterRegistration</span><span class="params">()</span> &#123;</span><br><span class="line">        FilterRegistrationBean&lt;MyFilter&gt; registrationBean = <span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 注册自定义过滤器</span></span><br><span class="line">        registrationBean.setFilter(<span class="keyword">new</span> <span class="title class_">MyFilter</span>());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 设置过滤器路径</span></span><br><span class="line">        registrationBean.addUrlPatterns(<span class="string">&quot;/api/*&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 设置过滤器顺序（值越小，优先级越高）</span></span><br><span class="line">        registrationBean.setOrder(<span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> registrationBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Interceptor（拦截器）">Interceptor（拦截器）</h2><p>拦截器也是Spring的拦截机制之一，作用范围在 <strong>Spring MVC 层</strong>，作用于处理器（Controller）的调用。基于 <code>HandlerInterceptor</code> 接口。调用顺序在过滤器之后，切面之前执行。内部的调用顺序按 <code>WebMvcConfigurer</code> 中注册顺序执行。可以拿到的数据：①<strong>请求数据</strong>：<code>HttpServletRequest</code>，<code>HttpServletResponse</code>。②<strong>处理器信息</strong>：目标 <code>Handler</code>（通常是 Controller 方法）。功能：①<strong>请求预处理</strong>：在请求到达 Controller 之前进行处理。②<strong>响应后处理</strong>：在 Controller 返回结果后但尚未生成响应时进行处理。③<strong>异常处理</strong>：捕获 Controller 发生的异常。④<strong>会话管理</strong>：验证用户会话、检查权限等。</p><h3 id="拦截器生命周期">拦截器生命周期</h3><p>我们主要接触的生命周期只有<code>preHandle</code>,<code>postHandler</code>，<code>afterCompletion</code></p><p><img src="https://lambda-image-1.pages.dev/%E6%8B%A6%E6%88%AA%E5%99%A8.drawio.png" alt="拦截器.drawio"></p><h3 id="拦截器的使用">拦截器的使用</h3><p>实现 <code>HandlerInterceptor</code> 接口，创建一个拦截器</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lambda.projectcore.aspect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理器方法调用前执行</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;preHandle: 请求被拦截&quot;</span>);</span><br><span class="line">        <span class="comment">// 可以通过返回 false 来阻止请求继续</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理器方法调用后执行（但视图未渲染）</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;postHandle: 方法执行完成&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 请求处理完成后执行（包括视图渲染后）</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;afterCompletion: 请求完成&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>拦截器中获取响应的内容</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.MethodParameter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.server.ServerHttpRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.server.ServerHttpResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.RequestContextHolder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.ServletRequestAttributes;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.method.annotation.ResponseBodyAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InterceptResponse</span> <span class="keyword">implements</span> <span class="title class_">ResponseBodyAdvice</span>&lt;Object&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">MAX_LENGTH</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">supports</span><span class="params">(MethodParameter methodParameter, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; aClass)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">beforeBodyWrite</span><span class="params">(Object body, MethodParameter methodParameter, MediaType mediaType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; aClass, ServerHttpRequest serverHttpRequest, ServerHttpResponse serverHttpResponse)</span> &#123;</span><br><span class="line"></span><br><span class="line">        String result;</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            result = objectMapper.writeValueAsString(body);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;JSON转换失败&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">length</span> <span class="operator">=</span> result.length();</span><br><span class="line">        result = result.substring(<span class="number">0</span>, length);</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">httpServletRequest</span> <span class="operator">=</span> ((ServletRequestAttributes)</span><br><span class="line">                RequestContextHolder.getRequestAttributes()).getRequest();</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">httpSession</span> <span class="operator">=</span> httpServletRequest.getSession(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//放到缓存里，以便于可以在HandlerInterceptor拦截里取出并打印出返回结果</span></span><br><span class="line">        httpSession.setAttribute(<span class="string">&quot;body&quot;</span>, result);</span><br><span class="line">        <span class="keyword">return</span> body;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改<code>CustomInterceptor</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理器方法调用前执行</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;preHandle: 请求被拦截&quot;</span>);</span><br><span class="line">        <span class="comment">// 可以通过返回 false 来阻止请求继续</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理器方法调用后执行（但视图未渲染）</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;postHandle: 方法执行完成&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 请求处理完成后执行（包括视图渲染后）</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;afterCompletion: 请求完成&quot;</span>);</span><br><span class="line">        <span class="type">HttpSession</span> <span class="variable">httpSession</span> <span class="operator">=</span> request.getSession();</span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> (String) httpSession.getAttribute(<span class="string">&quot;body&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;afterCompletion: 响应内容：&quot;</span> + result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到，获取到了响应的内容</p><p><img src="https://lambda-image-1.pages.dev/image-20250105133042363.png" alt="image-20250105133042363"></p><h3 id="注册拦截器">注册拦截器</h3><p>在 Spring 中，需要将拦截器注册到拦截器链中，可以通过实现 <code>WebMvcConfigurer</code> 接口来完成。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lambda.projectcore.aspect;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CustomInterceptor customInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(customInterceptor)</span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>)         <span class="comment">// 拦截所有请求</span></span><br><span class="line">                .excludePathPatterns(<span class="string">&quot;/login&quot;</span>, <span class="string">&quot;/static/**&quot;</span>); <span class="comment">// 排除特定路径</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;工具&quot;&gt;工具&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.jetbrains.com/idea/&quot;&gt;IDEA专业版&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2</summary>
        
      
    
    
    
    <category term="后端开发" scheme="https://www.wikunkun.asia/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="Java" scheme="https://www.wikunkun.asia/tags/Java/"/>
    
    <category term="SpringBoot" scheme="https://www.wikunkun.asia/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>宝可梦道具列表</title>
    <link href="https://www.wikunkun.asia/posts/85880b56.html"/>
    <id>https://www.wikunkun.asia/posts/85880b56.html</id>
    <published>2024-12-22T14:22:28.000Z</published>
    <updated>2024-12-23T03:45:40.964Z</updated>
    
    <content type="html"><![CDATA[<table><thead><tr><th>图片</th><th style="text-align:left">名称</th><th style="text-align:left">价格</th><th style="text-align:left">获取途径</th><th style="text-align:left">地区</th><th style="text-align:left">效果</th></tr></thead><tbody><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50qhWUSrKLZBu5RTEtIvlJNb.png" alt="AgAABm2M50qhWUSrKLZBu5RTEtIvlJNb"></td><td style="text-align:left">奇迹种子</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">学院</td><td style="text-align:left">孕育生命的种子。携带后，草属性的招式威力就会提高 1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rC_CtYfu9Co6rsODcj4CF9.png" alt="AgAABm2M50rC_CtYfu9Co6rsODcj4CF9"></td><td style="text-align:left">木炭</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">焚烧用的燃料。携带后，火属性的招式威力就会提高 1.2倍 。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50qADugP5gZKtb51C2NJu6Q0.png" alt="AgAABm2M50qADugP5gZKtb51C2NJu6Q0"></td><td style="text-align:left">神秘水珠</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">水滴形状的宝石。携带后，水属性的招式威力就会提高 1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rL0PRd5eRDUopCAYInZvTD.png" alt="AgAABm2M50rL0PRd5eRDUopCAYInZvTD"></td><td style="text-align:left">丝绸围巾</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">手感不错的围巾。携带后，一般属性的招式威力就会提高 1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oMIcxveiBF8LSk9S2SVAbJ.png" alt="AgAABm2M50oMIcxveiBF8LSk9S2SVAbJ"></td><td style="text-align:left">锐利鸟嘴</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">又长又尖的鸟嘴。携带后，飞行属性的招式威力就会提高 1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50ofSAZagDZAUpDaZu7nZHnB.png" alt="AgAABm2M50ofSAZagDZAUpDaZu7nZHnB"></td><td style="text-align:left">银粉</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">银色光辉的粉末。携带后，虫属性的招式威力就会提高 1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rDSot92N9Fz4iLK15sB6AL.png" alt="AgAABm2M50rDSot92N9Fz4iLK15sB6AL"></td><td style="text-align:left">力量头带</td><td style="text-align:left">8000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">力如泉涌的头带。携带后，物理招式的威力就会少量提高。 （1.1倍）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50q9qAWf-ZRNyJN89ea2dupS.png" alt="AgAABm2M50q9qAWf-ZRNyJN89ea2dupS"></td><td style="text-align:left">博识眼镜</td><td style="text-align:left">8000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">装着很厚镜片的眼睛。携带后，特殊招式的威力就会少量提高。 （1.1倍）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rKgWekQYlFyoXtrDnH3gNc.png" alt="AgAABm2M50rKgWekQYlFyoXtrDnH3gNc"></td><td style="text-align:left">拳击手套</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">保护拳头的手套。携带后，拳击招式的威力会提高 （1.1倍） ，且变得拳击时不会接  触到对手。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oB1BSPHxxPaKaIVt-mlp4q.png" alt="AgAABm2M50oB1BSPHxxPaKaIVt-mlp4q"></td><td style="text-align:left">达人带</td><td style="text-align:left">30000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">用惯了的黑色带子。携带后，效果绝佳时的招式威力就会少量提高。 （1.2倍）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pPPZNRwpdLwpseFhodK_ph.png" alt="AgAABm2M50pPPZNRwpdLwpseFhodK_ph"></td><td style="text-align:left">气势头带</td><td style="text-align:left">10000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">携带后，即使受到可能会导致昏厥的招式，有时 （10%） 也能仅以1HP撑过去1次。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50qblOjZyHpFh6IhIdJpmooX.png" alt="AgAABm2M50qblOjZyHpFh6IhIdJpmooX"></td><td style="text-align:left">气势披带</td><td style="text-align:left">50000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">携带后，在HP全满时，即使受到可能会导致昏厥的招式，也能仅以1HP撑过去1次。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/Dream_%E8%AE%B2%E7%A9%B6%E5%A4%B4%E5%B8%A6_Sprite.png" alt="Dream_讲究头带_Sprite" style="zoom:56%;" /></td><td style="text-align:left">讲究头带</td><td style="text-align:left">100000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">有点讲究的头带。虽然携带后攻击会提高 1.5倍 ，但只能使出相同的招式。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oVEnylDdJAJb9LU_6UYMLN.png" alt="AgAABm2M50oVEnylDdJAJb9LU_6UYMLN"></td><td style="text-align:left">讲究眼镜</td><td style="text-align:left">100000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">有点讲究的头带。虽然携带后特攻会提高 1.5倍 ，但只能使出相同的招式。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50o0_0wTPkBMBpicNTpklxnv.png" alt="AgAABm2M50o0_0wTPkBMBpicNTpklxnv"></td><td style="text-align:left">讲究围巾</td><td style="text-align:left">100000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">有点讲究的头带。虽然携带后速度会提高 1.5倍 ，但只能使出相同的招式。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50r4j4eqVuZKjYw6OELyLFa0.png" alt="AgAABm2M50r4j4eqVuZKjYw6OELyLFa0"></td><td style="text-align:left">生命宝珠</td><td style="text-align:left">50000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">携带后，虽然每次攻击时 HP减少最大HP的1/10 ，但招式的威力会提高 1.3倍</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oOXnh3EsFD_am8fAZvjgL9.png" alt="AgAABm2M50oOXnh3EsFD_am8fAZvjgL9"></td><td style="text-align:left">特性护具</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">可爱而有个性的盾。携带后，特性不会被对手改变。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pa3hpBNhtBcrSOti80nY3v.png" alt="AgAABm2M50pa3hpBNhtBcrSOti80nY3v"></td><td style="text-align:left">清净护具</td><td style="text-align:left">30000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">光芒晶莹剔透的坠饰。携带后，不会因为对手的招式或特性而被降低能力。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oGYtQQny9DAomlk6kh0eWd.png" alt="AgAABm2M50oGYtQQny9DAomlk6kh0eWd"></td><td style="text-align:left">凸凸头盔</td><td style="text-align:left">50000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">让宝可梦携带后，能对触碰到自己的对手造成 HP的1/6的 伤害</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oHvnClUSBM-6b34jMXgTq3.png" alt="AgAABm2M50oHvnClUSBM-6b34jMXgTq3"></td><td style="text-align:left">进化奇石</td><td style="text-align:left">50000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">进化的神奇石块。携带后，还能进化的宝可梦的防御和特防就会提高 1.5倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rNVg3YSthEMbMPNY55g6GQ.png" alt="AgAABm2M50rNVg3YSthEMbMPNY55g6GQ"></td><td style="text-align:left">突击背心</td><td style="text-align:left">50000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">会变得富有攻击性的背心。虽然携带后特防会提高 1.5倍 ，但会无法使出变化招式。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pe6n-iab9O5559LWdb4AYP.png" alt="AgAABm2M50pe6n-iab9O5559LWdb4AYP"></td><td style="text-align:left">先制之爪</td><td style="text-align:left">8000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">又轻又尖锐的爪子。携带后，有时 （20%） 能比对手先一步行动。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oFR9wInKpAL45oy_z2SMnt.png" alt="AgAABm2M50oFR9wInKpAL45oy_z2SMnt"></td><td style="text-align:left">锐利之爪</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">尖锐的爪子。携带后，招式会变得容易击中要害。 （1阶段）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oQSPBmNktF0YRorB4xOVTX.png" alt="AgAABm2M50oQSPBmNktF0YRorB4xOVTX"></td><td style="text-align:left">紧缠钩爪</td><td style="text-align:left">10000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">携带后，绑紧以及紧束等会持续造成伤害的招式的回合数会增加。 （5回合变为7回  合）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rA26M245xMm7tuA6MlcS6A.png" alt="AgAABm2M50rA26M245xMm7tuA6MlcS6A"></td><td style="text-align:left">王者之证</td><td style="text-align:left">10000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">携带后进行攻击，在造成伤害时，有时 （10%） 会让对手畏缩。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oUDxvACSVGgrCD--4JlkLv.png" alt="AgAABm2M50oUDxvACSVGgrCD--4JlkLv"></td><td style="text-align:left">弱点保险</td><td style="text-align:left">50000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">被针对弱点时，攻击和特攻就会大幅提高。 （2阶段）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50otodcTElVDno_kTmWRV89x.png" alt="AgAABm2M50otodcTElVDno_kTmWRV89x"></td><td style="text-align:left">打空保险</td><td style="text-align:left">30000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">招式因命中率影响而落空时，速度会大幅提高。 （2阶段）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50p9lk9OphhIKLjBUYB23q8r.png" alt="AgAABm2M50p9lk9OphhIKLjBUYB23q8r"></td><td style="text-align:left">爽喉喷雾</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">使用声音相关的招式时，特攻会提高 1阶段。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rqqN9Yvr5O37YcSIsy9U1l.png" alt="AgAABm2M50rqqN9Yvr5O37YcSIsy9U1l"></td><td style="text-align:left">红线</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">桌台市（学院）</td><td style="text-align:left">长长的鲜红色细线。携带后，在自己着迷时能让对手也着迷。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rHKiUcXMFJWL-I0lN_BoWC.png" alt="AgAABm2M50rHKiUcXMFJWL-I0lN_BoWC"></td><td style="text-align:left">磁铁</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">强力的磁铁。携带后，电属性的招式威力就会提高 1.2倍 。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rbjgGX7pJJ4afksm8r-OkX.png" alt="AgAABm2M50rbjgGX7pJJ4afksm8r-OkX"></td><td style="text-align:left">硬石头</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">绝对不会裂开的石头。携带后，岩石属性的招式威力就会提高 1.2倍 。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rp3z3he3RNb7bGWtvLTkjI.png" alt="AgAABm2M50rp3z3he3RNb7bGWtvLTkjI"></td><td style="text-align:left">毒针</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">有毒的小针。携带后，毒属性的招式威力就会提高 1.2倍 。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50q07gtBu8BM2IcZFkOaw2pE.png" alt="AgAABm2M50q07gtBu8BM2IcZFkOaw2pE"></td><td style="text-align:left">咒术之符</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">古怪可怕的咒符。携带后，幽灵属性的招式威力就会提高 1.2倍 。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50q93LkZNTNEfLWI3IizVuOX.png" alt="AgAABm2M50q93LkZNTNEfLWI3IizVuOX"></td><td style="text-align:left">龙之牙</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">坚硬锐利的牙齿。携带后，龙属性的威力就会提高 1.2倍 。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50ouTHM7zcpEyJ2M3cYglu2r.png" alt="AgAABm2M50ouTHM7zcpEyJ2M3cYglu2r"></td><td style="text-align:left">一般宝石</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">一般属性的宝石。携带后，一般属性的招式威力进会增强1次。 （1.3倍）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50o3UGJ-sSVEM4FYAsGC-3G6.png" alt="AgAABm2M50o3UGJ-sSVEM4FYAsGC-3G6"></td><td style="text-align:left">吃剩的东西</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">携带后，宝可梦的HP会在战斗期间缓缓回复。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50r8jnOWInVHG42nITYqxsyd.png" alt="AgAABm2M50r8jnOWInVHG42nITYqxsyd"></td><td style="text-align:left">大根茎</td><td style="text-align:left">10000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">携带后，吸取HP的招式可以比平时更多地回复自己的HP。 （1.3倍）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rVo6TpUw5Dmb_vE3qqhzoH.png" alt="AgAABm2M50rVo6TpUw5Dmb_vE3qqhzoH"></td><td style="text-align:left">光粉</td><td style="text-align:left">30000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">闪闪发光的粉末。携带后，光芒会迷惑对手，从而使其招式变得不容易命中。 （0.9  倍）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50p5dX9KKLdHdIE6_o0iZLPU.png" alt="AgAABm2M50p5dX9KKLdHdIE6_o0iZLPU"></td><td style="text-align:left">光之粘土</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">当携带它的宝可梦使出光墙或反射壁时，效果会比平时持续得更长。 （5回合延迟至8  回合）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oRb-d7HT5LGb8qsyjA746P.png" alt="AgAABm2M50oRb-d7HT5LGb8qsyjA746P"></td><td style="text-align:left">万能伞</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">携带它的宝可梦在下雨或日照很时，不会受到天气的影响。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pJ1lO2t01JUbtvSscQmWSk.png" alt="AgAABm2M50pJ1lO2t01JUbtvSscQmWSk"></td><td style="text-align:left">大地膜</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">当携带它的宝可梦利用招式或特性展开场地时，场地的持续时间会比平时更长。 （5  回合延迟至8回合）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rADsrnkOZNU5o6lOaonx8A.png" alt="AgAABm2M50rADsrnkOZNU5o6lOaonx8A"></td><td style="text-align:left">气球</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">让宝可梦携带后，宝可梦会浮在空中。收到攻击就会破裂。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50o-GxV2yBVPIYu3Zrc43gH7.png" alt="AgAABm2M50o-GxV2yBVPIYu3Zrc43gH7"></td><td style="text-align:left">美丽空壳</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">携带该道具的宝可梦必定可以交换，不受处于无法逃走、束缚和扎根状态的影响。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50p-B8jh9xdJWKcxQ28OO91y.png" alt="AgAABm2M50p-B8jh9xdJWKcxQ28OO91y"></td><td style="text-align:left">白色香叶</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">当携带它的宝可梦能力降低时，仅能回到之前的状态1次。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50olRmwanTNPsKkZk9WtAvW1.png" alt="AgAABm2M50olRmwanTNPsKkZk9WtAvW1"></td><td style="text-align:left">心灵香草</td><td style="text-align:left">10000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">当携带它的宝可梦无法自由使出招式时，仅会回复1次。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pcXxr3S3ZF1q3vqlCysP7P.png" alt="AgAABm2M50pcXxr3S3ZF1q3vqlCysP7P"></td><td style="text-align:left">强力香草</td><td style="text-align:left">30000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">携带它的宝可梦仅有一次机会可以在第1回合使出需要蓄力的招式。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oZzD3W-0hDXpOvkh1Cu2v6.png" alt="AgAABm2M50oZzD3W-0hDXpOvkh1Cu2v6"></td><td style="text-align:left">模仿香草</td><td style="text-align:left">30000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">携带它的宝可梦仅有1次机会可以在对手提高能力时，对其进行模仿并提升同样的能  力。 （露营学习蛋遗传技能）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pmSDIocyNHm5XyRYP__r15.png" alt="AgAABm2M50pmSDIocyNHm5XyRYP__r15"></td><td style="text-align:left">球根</td><td style="text-align:left">5000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">一次性使用的雪球。携带它的宝可梦如果受到水属性招式的伤害，特攻就会提高 （1  阶段） 。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rsdXXtw0RBT6Uak1YbA6x8.png" alt="AgAABm2M50rsdXXtw0RBT6Uak1YbA6x8"></td><td style="text-align:left">充电电池</td><td style="text-align:left">5000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">一次性使用的雪球。携带它的宝可梦如果受到电属性招式的伤害，攻击就会提高 （1  阶段） 。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pd41FlHX5KO4YHOtKJkeID.png" alt="AgAABm2M50pd41FlHX5KO4YHOtKJkeID"></td><td style="text-align:left">光苔</td><td style="text-align:left">5000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">一次性使用的雪球。携带它的宝可梦如果受到水属性招式的伤害，特防就会提高 （1  阶段） 。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pwU-pin1ZKjpDVgun0dKMQ.png" alt="AgAABm2M50pwU-pin1ZKjpDVgun0dKMQ"></td><td style="text-align:left">雪球</td><td style="text-align:left">5000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">一次性使用的雪球。携带它的宝可梦如果受到冰属性招式的伤害，攻击就会提高 （1  阶段） 。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pVYijwCGBOPIK3Pmz3lOzS.png" alt="AgAABm2M50pVYijwCGBOPIK3Pmz3lOzS"></td><td style="text-align:left">炽热岩石</td><td style="text-align:left">8000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">携带它的宝可梦让日照变强烈的话，晴天的时间就会比平时更长。 （5回合延迟至8回  合）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rDuAcmwoVHqJiQtsgrp3xl.png" alt="AgAABm2M50rDuAcmwoVHqJiQtsgrp3xl"></td><td style="text-align:left">潮湿岩石</td><td style="text-align:left">8000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">携带它的宝可梦将天气变为下雨的话，下雨的时间就会比平时更长。 （5回合延迟至8  回合）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rEpA5F86JHWYSVwfyr-fYM.png" alt="AgAABm2M50rEpA5F86JHWYSVwfyr-fYM"></td><td style="text-align:left">沙沙岩石</td><td style="text-align:left">8000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">携带它的宝可梦刮起沙暴的话，沙暴的时间就会比平时更长。 （5回合延迟至8回合）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50q2U-vJ5zBPwYnFnxgbMj5B.png" alt="AgAABm2M50q2U-vJ5zBPwYnFnxgbMj5B"></td><td style="text-align:left">冰冷岩石</td><td style="text-align:left">8000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">携带它的宝可梦将天气变为下雨的话，下雪的时间就会比平时更长。 （5回合延迟至8  回合）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rsOnSax3dCOafMloL9D4G5.png" alt="AgAABm2M50rsOnSax3dCOafMloL9D4G5"></td><td style="text-align:left">电气种子</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">让宝可梦携带后，在电气场地上使用，防御就会提高 （1阶段）。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50ruD1b83LlLvZ2kptcXw9SP.png" alt="AgAABm2M50ruD1b83LlLvZ2kptcXw9SP"></td><td style="text-align:left">精神种子</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">让宝可梦携带后，在精神场地上使用，特防就会提高 （1阶段）。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pV2nQxJ8pJ2bPSAi9NaFFG.png" alt="AgAABm2M50pV2nQxJ8pJ2bPSAi9NaFFG"></td><td style="text-align:left">薄雾种子</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">让宝可梦携带后，在薄雾场地上使用，特防就会提高 （1阶段）。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50qWSQV8VpREVqrEwzVRNTrq.png" alt="AgAABm2M50qWSQV8VpREVqrEwzVRNTrq"></td><td style="text-align:left">青草种子</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">玻瓶市</td><td style="text-align:left">让宝可梦携带后，在青草场地上使用，防御就会提高（1阶段）。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50q2n6F0p8lDwbheG5qNapEn.png" alt="AgAABm2M50q2n6F0p8lDwbheG5qNapEn"></td><td style="text-align:left">柔软沙子</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">手感细腻的沙子。携带后，地面属性的招式威力就会提高1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pLyW7iMYZBooZ-zHxDCsFP.png" alt="AgAABm2M50pLyW7iMYZBooZ-zHxDCsFP"></td><td style="text-align:left">黑色眼镜</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">看上去很奇怪的眼镜。携带后，恶属性的招式威力就会提高1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oB1BSPHxxPaKaIVt-mlp4q.png" alt="AgAABm2M50oB1BSPHxxPaKaIVt-mlp4q"></td><td style="text-align:left">黑带</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">能振作精神的带子。携带后，格斗属性的招式威力就会提高1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50qNkY0YbjRJ6LGalEj06Fs_.png" alt="AgAABm2M50qNkY0YbjRJ6LGalEj06Fs_"></td><td style="text-align:left">不融冰</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">能隔绝热量的冰。携带后，冰属性的招式威力就会提高1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50q7KhxiVr9Fo6vE9RnPjgp9.png" alt="AgAABm2M50q7KhxiVr9Fo6vE9RnPjgp9"></td><td style="text-align:left">弯曲的汤匙</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">注入了念力的汤匙。携带后，超能力属性的招式威力就会提高1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50p5kJqIhOZFj7mb3t-fpu9n.png" alt="AgAABm2M50p5kJqIhOZFj7mb3t-fpu9n"></td><td style="text-align:left">金属膜</td><td style="text-align:left">3000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">特殊的金属膜。携带后，钢属性的招式威力就会提高1.2倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rt70b9aLlEnq7uGf5-zTcR.png" alt="AgAABm2M50rt70b9aLlEnq7uGf5-zTcR"></td><td style="text-align:left">机变骰子</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">只会出现好数字的骰子。携带后，在使用连续招式时，能使出多次招式。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pv36JBLtJHurVsFC3QXVwx.png" alt="AgAABm2M50pv36JBLtJHurVsFC3QXVwx"></td><td style="text-align:left">贝壳之铃</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">当携带它的宝可梦攻击对手并造成伤害时，能回复少量HP(1/8)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rKif86uhBEy5UbJ0cH3pRc.png" alt="AgAABm2M50rKif86uhBEy5UbJ0cH3pRc"></td><td style="text-align:left">节拍器</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">携带后，连续使出相同招式时，威力就会提高。不再使出相同招式时，威力就会复原。（每次20%，上限100%）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pdKmAETv1Bm6Kaj336e7Mm.png" alt="AgAABm2M50pdKmAETv1Bm6Kaj336e7Mm"></td><td style="text-align:left">焦点镜</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">能看见弱点的镜片。携带它的宝可梦的招式会变得容易击中要害。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rQjoKK9MNJhZbFRDympxFB.png" alt="AgAABm2M50rQjoKK9MNJhZbFRDympxFB"></td><td style="text-align:left">广角镜</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">能放大观看物体的镜片。携带后，招式的命中率会少量提高1.1倍。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rhyePGiH1IIKxVK0enrgg1.png" alt="AgAABm2M50rhyePGiH1IIKxVK0enrgg1"></td><td style="text-align:left">对焦镜</td><td style="text-align:left">10000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">当携带它的宝可梦比对手行动迟缓时，招式会变得容易命中。（1.2倍)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50r2trXCUBRIx5dDL3kDCkqV.png" alt="AgAABm2M50r2trXCUBRIx5dDL3kDCkqV"></td><td style="text-align:left">防尘护目镜</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">不单是沙暴的伤害，就连粉末类和孢子类招式的效果也能防御的护目镜。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50qTDvndV49AgpPi0P9xvTpu.png" alt="AgAABm2M50qTDvndV49AgpPi0P9xvTpu"></td><td style="text-align:left">部位护具</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">不会受到触碰攻击对手时本应受到的效果。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rRKqJgzxFNxLKtS0sOFAM2.png" alt="AgAABm2M50rRKqJgzxFNxLKtS0sOFAM2"></td><td style="text-align:left">厚底靴</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">不受脚下陷阱等的影响。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50osRMZ8lUtNuKnob8Dsy0FA.png" alt="AgAABm2M50osRMZ8lUtNuKnob8Dsy0FA"></td><td style="text-align:left">密探斗篷</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">能骗过敌人眼睛的带帽披风。携带后，能隐藏身体，变得不会受到招式的追加效果影响。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rQhshRccpA1a8PEv3XnZIu.png" alt="AgAABm2M50rQhshRccpA1a8PEv3XnZIu"></td><td style="text-align:left">D 红牌</td><td style="text-align:left">30000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">有着神奇力量的卡片。携带后，能让对自己造成伤害的对手退场。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50r-WQzWJOBNRqlf0YLrPxyz.png" alt="AgAABm2M50r-WQzWJOBNRqlf0YLrPxyz"></td><td style="text-align:left">逃脱按键</td><td style="text-align:left">30000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">携带它的宝可梦如果受到招式的伤害，就能逃脱战斗，并和同行的其他宝可梦进行替换。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rhoNqhi0JM_5hQh_wRog6-.png" alt="AgAABm2M50rhoNqhi0JM_5hQh_wRog6-"></td><td style="text-align:left">避难背包</td><td style="text-align:left">30000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">当携带它的宝可梦能力下降时，同行宝可梦就会自动替换上场。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rjmvK5tzVAvaRw_pNNQD4T.png" alt="AgAABm2M50rjmvK5tzVAvaRw_pNNQD4T"></td><td style="text-align:left">胆怯球</td><td style="text-align:left">5000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">让宝可梦携带后，在受到威吓时速度会提高。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pANsNkTRNEeLeFE2Xh2Ou8.png" alt="AgAABm2M50pANsNkTRNEeLeFE2Xh2Ou8"></td><td style="text-align:left">客房服务</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">让宝可梦携带后，在戏法空间使用时，速度会下降。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rVIMJIulVKw79hR8eL5CZD.png" alt="AgAABm2M50rVIMJIulVKw79hR8eL5CZD"></td><td style="text-align:left">黑色铁球</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">携带后，速度会降低。飞行属性以及漂浮宝可梦会被地面招式击中。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oMxifpFvVNlZoyyPQxJjgv.png" alt="AgAABm2M50oMxifpFvVNlZoyyPQxJjgv"></td><td style="text-align:left">剧毒宝珠</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">触碰后会放出毒的神奇宝珠。携带后，在战斗时会变成剧毒状态。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pii9iGhZ9PdYJ7N8ZBmIZL.png" alt="AgAABm2M50pii9iGhZ9PdYJ7N8ZBmIZL"></td><td style="text-align:left">火焰宝珠</td><td style="text-align:left">15000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">触碰后会放出热量的神奇宝珠。携带后，在战斗时会变成灼烧状态。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pxBSOrGEZA94nA_HWKgFw2.png" alt="AgAABm2M50pxBSOrGEZA94nA_HWKgFw2"></td><td style="text-align:left">后攻之尾</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">非常沉重的某种尾巴。携带后，行动会比平时更加迟缓。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rdzc9SU-RD251lIeAboMbn.png" alt="AgAABm2M50rdzc9SU-RD251lIeAboMbn"></td><td style="text-align:left">黑色污泥</td><td style="text-align:left">10000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">携带后，毒属性的宝可梦会缓缓回复(1/16)HP。其他属性的话，HP则会减（1/8每回合）</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50qXM1QOvK5L6L4H6y5ZJ8-4.png" alt="AgAABm2M50qXM1QOvK5L6L4H6y5ZJ8-4"></td><td style="text-align:left">附着针</td><td style="text-align:left">10000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">携带后，每回合都会受到（1/8）伤害。有时也会附着到碰到自己的对手身上。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pwaintpulI35nxq2w9RUYU.png" alt="AgAABm2M50pwaintpulI35nxq2w9RUYU"></td><td style="text-align:left">标靶</td><td style="text-align:left">10000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">原本因宝可梦的属性相克关系而无效的招式现在会变得能够击中自己。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rDfNN_LKhK6oL5E43psrwM.png" alt="AgAABm2M50rDfNN_LKhK6oL5E43psrwM"></td><td style="text-align:left">紧绑束带</td><td style="text-align:left">20000</td><td style="text-align:left">信使鸟包包</td><td style="text-align:left">酿光市</td><td style="text-align:left">能增强绑紧招式的束带。携带后，绑紧招式的威力会变强（1/8增强至1/6）。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pcu-Ym4y1K4aCNKNI0_pSh.png" alt="AgAABm2M50pcu-Ym4y1K4aCNKNI0_pSh"></td><td style="text-align:left">护符金币</td><td style="text-align:left"></td><td style="text-align:left">任务</td><td style="text-align:left">锦汇镇</td><td style="text-align:left">只要携带它的宝可梦在战斗时出场一次，就能获得2倍金币。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pJOYDc2-BHYKaazM2bSwLP.png" alt="AgAABm2M50pJOYDc2-BHYKaazM2bSwLP"></td><td style="text-align:left">咒术之铠</td><td style="text-align:left"></td><td style="text-align:left">交换</td><td style="text-align:left">穴扎镇</td><td style="text-align:left">能让某些特定宝可梦进化的神奇铠甲。蕴含着诅咒的感情。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pTHxwDsPdD6YJvXQvP7_Jb.png" alt="AgAABm2M50pTHxwDsPdD6YJvXQvP7_Jb"></td><td style="text-align:left">庆祝之铠</td><td style="text-align:left"></td><td style="text-align:left">交换</td><td style="text-align:left">穴扎镇</td><td style="text-align:left">能让某些特定宝可梦进化的神奇铠甲。蕴含着祝贺的感情。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oiL6wOB9FBh7bZ474B6um_.png" alt="AgAABm2M50oiL6wOB9FBh7bZ474B6um_"></td><td style="text-align:left">头领凭证</td><td style="text-align:left"></td><td style="text-align:left">掉落</td><td style="text-align:left">竹林</td><td style="text-align:left">像久经岁月的刃器一样的碎片。只有率领着驹刀小兵群体的劈斩司令能携带着。</td></tr><tr><td></td><td style="text-align:left">电珠</td><td style="text-align:left"></td><td style="text-align:left">皮卡丘5%掉落</td><td style="text-align:left"></td><td style="text-align:left">让皮卡丘携带后，攻击和特攻就会提高的神奇之球。</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50ptKcC3V79B2Ln5U3NvBAmk.png" alt="AgAABm2M50ptKcC3V79B2Ln5U3NvBAmk"></td><td style="text-align:left">驱劲能量</td><td style="text-align:left"></td><td style="text-align:left">5%掉落</td><td style="text-align:left">第0区</td><td style="text-align:left">充满能量的胶囊。让有某种特性的宝可梦携带后，其能力会得到提升。(上场时除HP外数值最高的能力会提高30%；若该项能力为速度，则会提高50%)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50ribfWRAJpOz7bwuBlXbVbQ.png" alt="AgAABm2M50ribfWRAJpOz7bwuBlXbVbQ"></td><td style="text-align:left">金珠</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">闪着金光，以纯金制成的珠子。可以在商店高价出售。(5000)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pYudn05-ZPK6nc42eD8JpJ.png" alt="AgAABm2M50pYudn05-ZPK6nc42eD8JpJ"></td><td style="text-align:left">巨大金珠</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">以纯金制成，闪着金光的大珠子。可以在商店高价出售。(20000)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rAzxjAAoxADJvg3FKBaOca.png" alt="AgAABm2M50rAzxjAAoxADJvg3FKBaOca"></td><td style="text-align:left">小蘑菇</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">珍惜的小蘑菇。在一些爱好者中有着相当高的人气(250)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rAFOKWn4hHgZfFw3qKbug5.png" alt="AgAABm2M50rAFOKWn4hHgZfFw3qKbug5"></td><td style="text-align:left">大蘑菇</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">珍惜的大蘑菇。在一些爱好者中有着相当高的人气(2500)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50qy_jTH24pKArHPMmVgazJt.png" alt="AgAABm2M50qy_jTH24pKArHPMmVgazJt"></td><td style="text-align:left">芳香蘑菇</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">能让附近一带芳香四溢的珍稀蘑菇。可以在商店高价出售。(7500)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50qxKCMIbnFBToEqeJbZE0kD.webp" alt="AgAABm2M50qxKCMIbnFBToEqeJbZE0kD"></td><td style="text-align:left">小竹笋</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left">竹林</td><td style="text-align:left">小小的珍贵竹笋。在部分美食家中拥有很高人气。(375)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50rCQB--ae1Am7d_-PuWqWy9.webp" alt="AgAABm2M50rCQB--ae1Am7d_-PuWqWy9"></td><td style="text-align:left">大竹笋</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left">竹林</td><td style="text-align:left">大大的珍贵竹笋。在部分美食家中拥有非常高人气。(1500)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oDJQdCsjVFl6iAlgoOX8z7.png" alt="AgAABm2M50oDJQdCsjVFl6iAlgoOX8z7"></td><td style="text-align:left">星星沙子</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">手感细腻且十分美丽的红色沙子。可以在商店低价出售。(1500)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50pRoHgY775BI7l4JcIcJBD9.png" alt="AgAABm2M50pRoHgY775BI7l4JcIcJBD9"></td><td style="text-align:left">星星碎片</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">闪着红光且十分美丽的宝石碎片。可以在商店高价出售。(6000)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50qyC_EhGbNOL4MnYuVor5I9.png" alt="AgAABm2M50qyC_EhGbNOL4MnYuVor5I9"></td><td style="text-align:left">彗星碎片</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">彗星临近时，掉落到地表上的碎片。可以在商店高价出售。(12500)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oSwdvfB6ZNvbOvJ8OT0yBg.png" alt="AgAABm2M50oSwdvfB6ZNvbOvJ8OT0yBg"></td><td style="text-align:left">珍珠</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">散发着美丽银辉且非常小的珍珠。可以在商店低价出售。(1000)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50owR9w_2pxDZbumJAd4N2WE.png" alt="AgAABm2M50owR9w_2pxDZbumJAd4N2WE"></td><td style="text-align:left">大珍珠</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">散发着美丽银辉且相当大颗的珍珠。可以在商店低价出售。(4000)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50o1yyL3sRNCIK0ejPelCu9E.png" alt="AgAABm2M50o1yyL3sRNCIK0ejPelCu9E"></td><td style="text-align:left">丸子珍珠</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">散发着美丽银辉且非常大颗的珍珠。可以在商店高价出售。(10000)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50p4wTT5cuhAT48-zVJJbFxY.png" alt="AgAABm2M50p4wTT5cuhAT48-zVJJbFxY"></td><td style="text-align:left">甜甜蜜</td><td style="text-align:left"></td><td style="text-align:left">小蜜蜂拾取</td><td style="text-align:left"></td><td style="text-align:left">宝可梦采集的清甜芬芳的花蜜。可在商店里廉价出售。(225)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50ox0qOvyOlDPIriP2hqIe8b.png" alt="AgAABm2M50ox0qOvyOlDPIriP2hqIe8b"></td><td style="text-align:left">美丽之羽</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">仅仅只是漂亮，没有任何效果，极其普通的羽毛。(500)</td></tr><tr><td><img src="https://lambda-image-1.pages.dev/AgAABm2M50oMxv-Rq3dCMbDF4eJ3m5KU.png" alt="AgAABm2M50oMxv-Rq3dCMbDF4eJ3m5KU"></td><td style="text-align:left">贵重骨头</td><td style="text-align:left"></td><td style="text-align:left">拾取</td><td style="text-align:left"></td><td style="text-align:left">在宝可梦考古学上非常珍贵的骨头。可以在商店高价出售。(2500)</td></tr></tbody></table>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;图片&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;名称&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;价格&lt;/th&gt;
&lt;th</summary>
        
      
    
    
    
    <category term="游戏" scheme="https://www.wikunkun.asia/categories/%E6%B8%B8%E6%88%8F/"/>
    
    
    <category term="宝可梦" scheme="https://www.wikunkun.asia/tags/%E5%AE%9D%E5%8F%AF%E6%A2%A6/"/>
    
  </entry>
  
  <entry>
    <title>安装Docker</title>
    <link href="https://www.wikunkun.asia/posts/29c15ce3.html"/>
    <id>https://www.wikunkun.asia/posts/29c15ce3.html</id>
    <published>2024-12-19T02:06:06.000Z</published>
    <updated>2025-05-02T10:12:11.075Z</updated>
    
    <content type="html"><![CDATA[<h2 id="工具">工具</h2><ul><li>一款 <code>SSH</code> 连接工具 (本文用 <code>MobaXterm</code>)</li><li>一台 <code>Linux</code> 机器 (可以用云服务器或者 <code>VMware</code> 虚拟机)</li></ul><h2 id="环境">环境</h2><ul><li><code>Ubuntu22.04.4</code></li></ul><h2 id="检查卸载老版本-Docker">检查卸载老版本 Docker</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get remove docker docker-engine docker.io containerd runc</span><br></pre></td></tr></table></figure><h2 id="更新软件包">更新软件包</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get update</span><br><span class="line"><span class="built_in">sudo</span> apt-get upgrade</span><br></pre></td></tr></table></figure><h2 id="安装-Docker-依赖">安装 Docker 依赖</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get install ca-certificates curl gnupg lsb-release</span><br></pre></td></tr></table></figure><h2 id="添加-docker-密钥">添加 docker 密钥</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | <span class="built_in">sudo</span> apt-key add -</span><br></pre></td></tr></table></figure><h2 id="添加阿里云-docker-软件源">添加阿里云 docker 软件源</h2><p>执行以下命令来添加阿里云 Docker 镜像源：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> add-apt-repository <span class="string">&quot;deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu <span class="subst">$(lsb_release -cs)</span> stable&quot;</span></span><br></pre></td></tr></table></figure><h2 id="安装-Docker"><strong>安装 Docker</strong></h2><p>更新软件包列表并安装 <code>Docker</code> 和 <code>Docker Compose</code> 插件：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt-get update</span><br><span class="line"><span class="built_in">sudo</span> apt install -y docker-ce docker-ce-cli containerd.io docker-compose</span><br></pre></td></tr></table></figure><h2 id="配置用户组">配置用户组</h2><p><strong>非必须操作</strong>，此操作目的是为了以后执行 <code>docker</code> 命令时无需输入 <code>sudo</code> 密码，避免这些重复操作而已</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> usermod -aG docker <span class="variable">$USER</span></span><br><span class="line"><span class="built_in">sudo</span> reboot</span><br></pre></td></tr></table></figure><h2 id="检查-Docker-安装情况">检查 Docker 安装情况</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//这两个命令随便一个都可以</span><br><span class="line">docker ps</span><br><span class="line">docker -v</span><br></pre></td></tr></table></figure><p><a href="https://lambda-image-1.pages.dev/Snipaste_2024-10-13_21-35-55.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Snipaste_2024-10-13_21-35-55"></a></p><p>若出现以上的内容，则表示 docker 安装成功</p><h2 id="配置-Docker-镜像加速">配置 Docker 镜像加速</h2><p>由于一些原因导致 <code>Docker</code> 被墙了，因此我们需要配置镜像加速，如果不配置的话将无法拉取任何镜像文件</p><h3 id="创建目录">创建目录</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /etc/docker</span><br></pre></td></tr></table></figure><h3 id="镜像地址">镜像地址</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/docker/daemon.json &lt;&lt;-<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;registry-mirrors&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;https://docker-0.unsee.tech&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://docker-cf.registry.cyou&quot;</span>,</span><br><span class="line">        <span class="string">&quot;https://docker.1panel.live&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h3 id="重新加载配置">重新加载配置</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl daemon-reload</span><br></pre></td></tr></table></figure><h2 id="重启Docker">重启Docker</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl restart docker</span><br></pre></td></tr></table></figure><h2 id="测试镜像加速是否有效">测试镜像加速是否有效</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull hello-world</span><br></pre></td></tr></table></figure><p><a href="https://lambda-image-1.pages.dev/Snipaste_2024-10-13_21-52-07.png"><img src="https://lambda-image-1.pages.dev/Snipaste_2024-10-13_21-52-07.png" alt="Snipaste_2024-10-13_21-52-07"></a></p><p>出现以上内容表示镜像加速配置成功</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;工具&quot;&gt;工具&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;一款 &lt;code&gt;SSH&lt;/code&gt; 连接工具 (本文用 &lt;code&gt;MobaXterm&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;一台 &lt;code&gt;Linux&lt;/code&gt; 机器 (可以用云服务器或者</summary>
        
      
    
    
    
    <category term="Linux平台开发" scheme="https://www.wikunkun.asia/categories/Linux%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="Linux" scheme="https://www.wikunkun.asia/tags/Linux/"/>
    
    <category term="Docker" scheme="https://www.wikunkun.asia/tags/Docker/"/>
    
    <category term="教程" scheme="https://www.wikunkun.asia/tags/%E6%95%99%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>搭建QQ机器人</title>
    <link href="https://www.wikunkun.asia/posts/a1ff416d.html"/>
    <id>https://www.wikunkun.asia/posts/a1ff416d.html</id>
    <published>2024-12-19T02:03:56.000Z</published>
    <updated>2025-02-13T10:39:02.417Z</updated>
    
    <content type="html"><![CDATA[<h2 id="工具">工具</h2><ul><li>一款 SSH 连接工具 (本文用 MobaXterm)</li><li>一台云服务器 (本文用阿里云 ECS 服务器)</li><li>ApiFox 或 Postman (本文用 ApiFox)</li></ul><h2 id="部署-NapCatQQ">部署 NapCatQQ</h2><ul><li><a href="https://github.com/NapNeko/NapCatQQ">NapCatQQ 地址</a></li><li><a href="https://napneko.github.io/">NapCat 的官方文档</a></li></ul><h2 id="创建挂载目录">创建挂载目录</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p ~/mydata/napcat/config</span><br><span class="line"><span class="built_in">mkdir</span> -p ~/mydata/napcat/QQ</span><br></pre></td></tr></table></figure><h3 id="创建-NapCatQQ-容器">创建 NapCatQQ 容器</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">-e ACCOUNT=&lt;机器人QQ号&gt; \</span><br><span class="line">-e WS_ENABLE=<span class="literal">true</span> \</span><br><span class="line">-p 3001:3001 \</span><br><span class="line">-p 6099:6099 \</span><br><span class="line">-e NAPCAT_GID=$(<span class="built_in">id</span> -g) \</span><br><span class="line">-e NAPCAT_UID=$(<span class="built_in">id</span> -u) \</span><br><span class="line">--name napcat \</span><br><span class="line">-v ~/mydata/napcat/QQ:/app/.config/QQ \</span><br><span class="line">-v ~/mydata/napcat/config:/app/napcat/config \</span><br><span class="line">--restart=always \</span><br><span class="line">docker.1panel.dev/mlikiowa/napcat-docker:latest</span><br></pre></td></tr></table></figure><h3 id="修改云服务器安全组">修改云服务器安全组</h3><p>开放 <code>3001</code> 端口和 <code>6099</code> 端口</p><h3 id="登录-QQ">登录 QQ</h3><p>查看容器内部日志</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f napcat</span><br></pre></td></tr></table></figure><p>扫描日志内出现的二维码登录 QQ</p><p><a href="https://lambda-image-1.pages.dev/Snipaste_2024-10-14_22-32-35.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Snipaste_2024-10-14_22-32-35"></a></p><p>机器人 QQ 账号与扫描的账号不同的情况，会导致 WebSocket 服务未启动</p><p><a href="https://lambda-image-1.pages.dev/Snipaste_2024-10-14_22-41-57.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Snipaste_2024-10-14_22-41-57"></a></p><p>解决方法：修改配置文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更改目录的权限</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> -R 777 ~/mydata/napcat/</span><br><span class="line"><span class="comment"># 进入对应的目录</span></span><br><span class="line"><span class="built_in">cd</span> ~/mydata/napcat/config</span><br></pre></td></tr></table></figure><p><a href="https://lambda-image-1.pages.dev/Snipaste_2024-10-14_22-45-57.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Snipaste_2024-10-14_22-45-57"></a></p><p>打开 onebot11_&lt;刚刚扫描的QQ&gt;.json 这个文件，把 ws 的 enable 改为 true</p><p><a href="https://lambda-image-1.pages.dev/Snipaste_2024-10-14_22-47-50.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Snipaste_2024-10-14_22-47-50"></a></p><p>重启启动 NapCatQQ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart napcat</span><br></pre></td></tr></table></figure><p>重新登录，若 WebSocket 服务未已启动则表示配置成功</p><p><a href="https://lambda-image-1.pages.dev/Snipaste_2024-10-14_22-50-01.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Snipaste_2024-10-14_22-50-01"></a></p><h2 id="连接-NapCatQQ">连接 NapCatQQ</h2><p>打开 ApiFox, 创建项目,新建 WebSocket 接口,输入以下内容，然后连接</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">ws://ip:port</span></span><br></pre></td></tr></table></figure><h2 id="功能测试">功能测试</h2><p>查看 NapCatQQ 的开发文档 , 找到想要测试的功能，比如文本测试一下发送消息功能，用的 OneBot 11 API</p><p><a href="https://lambda-image-1.pages.dev/image-9.png"><img src="https://lambda-image-1.pages.dev/image-9.png" alt="image-9"></a></p><p>访问 <a href="https://napneko.github.io/develop/api#onebot-11-api">OneBot11 的 API 文档</a>或 <a href="https://napneko.github.io/develop/api#go-cqhttp-api">Go-cqhttp 的 API 文档</a> , 找到对应的 API</p><p><a href="https://lambda-image-1.pages.dev/image-11.png"><img src="https://lambda-image-1.pages.dev/image-11.png" alt="image-11"></a></p><p>根据文档构建 JSON 字符串，发送请求，查看是否成功</p><p><a href="https://lambda-image-1.pages.dev/image-13.png"><img src="https://lambda-image-1.pages.dev/image-13.png" alt="image-13"></a></p><p>至此功能测试已经基本完毕，如果想要进行开发的话，发送 Ws 请求到 NapCatQQ 然后查阅文档发送请求即可</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;工具&quot;&gt;工具&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;一款 SSH 连接工具 (本文用 MobaXterm)&lt;/li&gt;
&lt;li&gt;一台云服务器 (本文用阿里云 ECS 服务器)&lt;/li&gt;
&lt;li&gt;ApiFox 或 Postman (本文用</summary>
        
      
    
    
    
    <category term="机器人" scheme="https://www.wikunkun.asia/categories/%E6%9C%BA%E5%99%A8%E4%BA%BA/"/>
    
    
    <category term="教程" scheme="https://www.wikunkun.asia/tags/%E6%95%99%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>Netty实现WebSocket</title>
    <link href="https://www.wikunkun.asia/posts/437d5a1e.html"/>
    <id>https://www.wikunkun.asia/posts/437d5a1e.html</id>
    <published>2024-12-19T02:01:08.000Z</published>
    <updated>2025-02-13T10:39:02.414Z</updated>
    
    <content type="html"><![CDATA[<p>最近要弄安卓的结课设计,里面刚好有要用<code>WebSocket</code>实现一个简易聊天室的选题,正好之前学了<code>WebSocket</code>没有总结笔记,因此写篇博客总结一下</p><h2 id="工具">工具</h2><ul><li><a href="https://www.jetbrains.com/idea/">IDEA专业版</a></li><li><a href="https://apifox.com/">ApiFox</a></li></ul><h2 id="环境">环境</h2><ul><li>windows10</li><li><a href="https://maven.org.cn/">Maven3.9.5</a></li><li>jdk1.8</li></ul><h2 id="创建项目">创建项目</h2><p>名称随意,需要注意只有选择<strong>jdk1.8</strong>和<strong>java8</strong>(<strong>其他版本如果出现问题请自行解决</strong>),点击下一步后的依赖项我们不用管,等下会有我整理好的pom文件</p><p><a href="https://lambda-image-1.pages.dev/image-20241204214712169.png"><img src="https://lambda-image-1.pages.dev/image-20241204214712169.png" alt="image-20241204214712169"></a></p><h2 id="修改Pom文件">修改Pom文件</h2><p>如果对<code>pom</code>文件比较熟悉的话,替换掉<code>properties</code>,<code>dependencies</code>就行</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">spring-boot.version</span>&gt;</span>2.6.3<span class="tag">&lt;/<span class="name">spring-boot.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.8.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--netty--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.netty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>netty-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果不熟悉的话就自己全部复制下列文件,<strong>复制完后必定会报错</strong>,修改<code>artifactId</code>,<code>groupId</code>(<strong>如果这几个都不会改的话,那么请先去学SpringBoot</strong>)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.lambda<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>simple-netty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>simple-netty<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>simple-netty<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-boot.version</span>&gt;</span>2.6.3<span class="tag">&lt;/<span class="name">spring-boot.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.8.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--netty--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.netty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>netty-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring-boot.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="创建WebSocket服务">创建WebSocket服务</h2><p>这个类是我们<code>WebSocket</code>的主要服务类,首先创建包<code>websocket</code>,然后创建类<code>NettyWebSocketServer</code>(博主这里完整的路径为<code>com.lambda.simplenetty.websocket.NettyWebSocketServer</code>)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lambda.simplenetty.websocket;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.netty.bootstrap.ServerBootstrap;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelInitializer;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelOption;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelPipeline;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.EventLoopGroup;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.nio.NioEventLoopGroup;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.socket.SocketChannel;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.socket.nio.NioServerSocketChannel;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.codec.http.HttpObjectAggregator;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.codec.http.HttpServerCodec;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.logging.LogLevel;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.logging.LoggingHandler;</span><br><span class="line"><span class="keyword">import</span> io.netty.handler.stream.ChunkedWriteHandler;</span><br><span class="line"><span class="keyword">import</span> io.netty.util.NettyRuntime;</span><br><span class="line"><span class="keyword">import</span> io.netty.util.concurrent.Future;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.PostConstruct;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.PreDestroy;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NettyWebSocketServer</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * webSocket的端口号</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">Integer</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">8090</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建线程池执行器</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 请求连接的group(负责接受客户端的连接请求)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">EventLoopGroup</span> <span class="variable">bossGroup</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 工作的group(负责处理 IO 操作)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">EventLoopGroup</span> <span class="variable">workerGroup</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>(NettyRuntime.availableProcessors());</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 启动 ws server</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InterruptedException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="built_in">this</span>.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 销毁</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PreDestroy</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        Future&lt;?&gt; future = <span class="built_in">this</span>.bossGroup.shutdownGracefully();</span><br><span class="line">        Future&lt;?&gt; future1 = <span class="built_in">this</span>.workerGroup.shutdownGracefully();</span><br><span class="line">        future.syncUninterruptibly();</span><br><span class="line">        future1.syncUninterruptibly();</span><br><span class="line">        log.info(<span class="string">&quot;关闭 ws server 成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 服务器启动引导对象</span></span><br><span class="line">        <span class="type">ServerBootstrap</span> <span class="variable">serverBootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>();</span><br><span class="line">        serverBootstrap.group(<span class="built_in">this</span>.bossGroup, <span class="built_in">this</span>.workerGroup)</span><br><span class="line">                .channel(NioServerSocketChannel.class)</span><br><span class="line">                .option(ChannelOption.SO_BACKLOG, <span class="number">128</span>)</span><br><span class="line">                .option(ChannelOption.SO_KEEPALIVE, <span class="literal">true</span>)</span><br><span class="line">                .handler(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.INFO)) <span class="comment">// 为 bossGroup 添加 日志处理器</span></span><br><span class="line">                .childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel socketChannel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                        <span class="type">ChannelPipeline</span> <span class="variable">pipeline</span> <span class="operator">=</span> socketChannel.pipeline();</span><br><span class="line">                        <span class="comment">//30秒客户端没有向服务器发送心跳则关闭连接</span></span><br><span class="line"><span class="comment">//                        pipeline.addLast(new IdleStateHandler(30, 0, 0));</span></span><br><span class="line">                        <span class="comment">// 因为使用http协议，所以需要使用http的编码器，解码器</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">HttpServerCodec</span>());</span><br><span class="line">                        <span class="comment">// 以块方式写，添加 chunkedWriter 处理器</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">ChunkedWriteHandler</span>());</span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                         * 说明：</span></span><br><span class="line"><span class="comment">                         *  1. http数据在传输过程中是分段的，HttpObjectAggregator可以把多个段聚合起来；</span></span><br><span class="line"><span class="comment">                         *  2. 这就是为什么当浏览器发送大量数据时，就会发出多次 http请求的原因</span></span><br><span class="line"><span class="comment">                         */</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">HttpObjectAggregator</span>(<span class="number">8192</span>));</span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                         * 说明：</span></span><br><span class="line"><span class="comment">                         *  1. 对于 WebSocket，它的数据是以帧frame 的形式传递的；</span></span><br><span class="line"><span class="comment">                         *  2. 可以看到 WebSocketFrame 下面有6个子类</span></span><br><span class="line"><span class="comment">                         *  3. 浏览器发送请求时： ws://localhost:7000/hello 表示请求的uri</span></span><br><span class="line"><span class="comment">                         *  4. WebSocketServerProtocolHandler 核心功能是把 http协议升级为 ws 协议，保持长连接；</span></span><br><span class="line"><span class="comment">                         *      是通过一个状态码 101 来切换的</span></span><br><span class="line"><span class="comment">                         */</span></span><br><span class="line">                        <span class="comment">//这个是Netty支持WebSocket的处理</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">WebSocketServerProtocolHandler</span>(<span class="string">&quot;/&quot;</span>));</span><br><span class="line">                        <span class="comment">// 自定义handler ，处理业务逻辑</span></span><br><span class="line">                        pipeline.addLast(nettyWebSocketServerHandler);</span><br><span class="line">                        <span class="comment">// 注册全局异常处理器</span></span><br><span class="line">                        pipeline.addLast(nettyGlobalExceptionHandler);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="comment">// 启动服务器，监听端口，阻塞直到启动成功</span></span><br><span class="line">        serverBootstrap.bind(<span class="built_in">this</span>.port).sync();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="代码解释">代码解释</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">Integer</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">8090</span>;</span><br></pre></td></tr></table></figure><p>这个是定义的<code>websocket</code>的启动端口,我们连接<code>websocket</code>时需要指明该端口号(比如该<code>websocket</code>连接字符串,<code>ws://127.0.0.1:8090/</code>,这里<code>127.0.0.1</code>为<code>ip</code>地址,<code>8090</code>为端口号)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 启动 ws server</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> InterruptedException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostConstruct</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="built_in">this</span>.run();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@PostConstruct</code>是<code>SpringBoot</code>中的一个注解,主要功能是在依赖注入完成后执行对应的逻辑,因此这里就是在初始化完成后运行websocket</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 销毁</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PreDestroy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    Future&lt;?&gt; future = <span class="built_in">this</span>.bossGroup.shutdownGracefully();</span><br><span class="line">    Future&lt;?&gt; future1 = <span class="built_in">this</span>.workerGroup.shutdownGracefully();</span><br><span class="line">    future.syncUninterruptibly();</span><br><span class="line">    future1.syncUninterruptibly();</span><br><span class="line">    log.info(<span class="string">&quot;关闭 ws server 成功&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@PreDestroy</code>是<code>SpringBoot</code>中的一个注解,用于在<code>Spring Bean</code>销毁之前执行一些清理或资源释放的操作,因此这里就是在消耗时释放下内存</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 服务器启动引导对象</span></span><br><span class="line">        <span class="type">ServerBootstrap</span> <span class="variable">serverBootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>();</span><br><span class="line">        serverBootstrap.group(<span class="built_in">this</span>.bossGroup, <span class="built_in">this</span>.workerGroup)</span><br><span class="line">                .channel(NioServerSocketChannel.class)</span><br><span class="line">                .option(ChannelOption.SO_BACKLOG, <span class="number">128</span>)</span><br><span class="line">                .option(ChannelOption.SO_KEEPALIVE, <span class="literal">true</span>)</span><br><span class="line">                .handler(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.INFO)) <span class="comment">// 为 bossGroup 添加 日志处理器</span></span><br><span class="line">                .childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel socketChannel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                        <span class="type">ChannelPipeline</span> <span class="variable">pipeline</span> <span class="operator">=</span> socketChannel.pipeline();</span><br><span class="line">                        <span class="comment">//30秒客户端没有向服务器发送心跳则关闭连接(需要的话则把这段打开)</span></span><br><span class="line"><span class="comment">//                        pipeline.addLast(new IdleStateHandler(30, 0, 0));</span></span><br><span class="line">                        <span class="comment">// 因为使用http协议，所以需要使用http的编码器，解码器</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">HttpServerCodec</span>());</span><br><span class="line">                        <span class="comment">// 以块方式写，添加 chunkedWriter 处理器</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">ChunkedWriteHandler</span>());</span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                         * 说明：</span></span><br><span class="line"><span class="comment">                         *  1. http数据在传输过程中是分段的，HttpObjectAggregator可以把多个段聚合起来；</span></span><br><span class="line"><span class="comment">                         *  2. 这就是为什么当浏览器发送大量数据时，就会发出多次 http请求的原因</span></span><br><span class="line"><span class="comment">                         */</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">HttpObjectAggregator</span>(<span class="number">8192</span>));</span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                         * 说明：</span></span><br><span class="line"><span class="comment">                         *  1. 对于 WebSocket，它的数据是以帧frame 的形式传递的；</span></span><br><span class="line"><span class="comment">                         *  2. 可以看到 WebSocketFrame 下面有6个子类</span></span><br><span class="line"><span class="comment">                         *  3. 浏览器发送请求时： ws://localhost:7000/hello 表示请求的uri</span></span><br><span class="line"><span class="comment">                         *  4. WebSocketServerProtocolHandler 核心功能是把 http协议升级为 ws 协议，保持长连接；</span></span><br><span class="line"><span class="comment">                         *      是通过一个状态码 101 来切换的</span></span><br><span class="line"><span class="comment">                         */</span></span><br><span class="line">                        <span class="comment">//这个是Netty支持WebSocket的处理</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">WebSocketServerProtocolHandler</span>(<span class="string">&quot;/&quot;</span>));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="comment">// 启动服务器，监听端口，阻塞直到启动成功</span></span><br><span class="line">        serverBootstrap.bind(<span class="built_in">this</span>.port).sync();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>(这部分是最重要的代码,也是最难的部分,如果不懂的话就直接cv吧)</strong></p><ol><li><strong>创建服务器引导对象</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ServerBootstrap</span> <span class="variable">serverBootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>();</span><br></pre></td></tr></table></figure><p><strong><code>ServerBootstrap</code></strong>：Netty 用于启动服务器的引导类，封装了服务器配置的基本操作。</p><ol><li><strong>配置线程组</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serverBootstrap.group(<span class="built_in">this</span>.bossGroup, <span class="built_in">this</span>.workerGroup)</span><br></pre></td></tr></table></figure><ul><li><strong><code>bossGroup</code></strong>：接收客户端连接的线程组，负责监听端口和接收连接。</li><li><strong><code>workerGroup</code></strong>：处理已建立连接的 I/O 读写线程组。</li></ul><ol><li><strong>指定通道类型</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.channel(NioServerSocketChannel.class)</span><br></pre></td></tr></table></figure><ul><li><strong><code>NioServerSocketChannel</code></strong>：指定使用 NIO（非阻塞 I/O）类型的通道，用于接收客户端连接。</li></ul><ol><li><strong>设置服务器选项</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.option(ChannelOption.SO_KEEPALIVE, <span class="literal">true</span>)</span><br></pre></td></tr></table></figure><ul><li><strong><code>SO_BACKLOG</code></strong>：指定服务器可同时处理的最大连接数。</li><li><strong><code>SO_KEEPALIVE</code></strong>：启用 TCP 保活机制，检测连接是否有效，保持长时间的连接。</li></ul><ol><li><strong>添加日志处理器</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.handler(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.INFO))</span><br></pre></td></tr></table></figure><ul><li><strong><code>LoggingHandler</code></strong>：为 <code>bossGroup</code> 添加日志处理器，记录服务器接收连接的日志，日志级别为 <code>INFO</code>。</li></ul><ol><li><strong>初始化子通道处理器</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel socketChannel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ChannelPipeline</span> <span class="variable">pipeline</span> <span class="operator">=</span> socketChannel.pipeline();</span><br></pre></td></tr></table></figure><ul><li><strong><code>childHandler</code></strong>：为每个连接的 <code>Channel</code> 设置初始化器 <code>ChannelInitializer</code>。</li><li><strong><code>ChannelPipeline</code></strong>：Netty 的处理链，包含多个 <code>ChannelHandler</code>，每个处理器完成不同任务。</li></ul><ol><li><strong>HTTP 编解码器</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipeline.addLast(<span class="keyword">new</span> <span class="title class_">HttpServerCodec</span>());</span><br></pre></td></tr></table></figure><ul><li><strong><code>HttpServerCodec</code></strong>：Netty 提供的 HTTP 请求解码器和响应编码器，处理 HTTP 协议的请求和响应。</li></ul><ol><li><strong>ChunkedWriteHandler</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipeline.addLast(<span class="keyword">new</span> <span class="title class_">ChunkedWriteHandler</span>());</span><br></pre></td></tr></table></figure><ul><li><strong><code>ChunkedWriteHandler</code></strong>：处理大块数据的写操作，支持分块发送数据，避免内存占用过高。</li></ul><ol><li><strong>HttpObjectAggregator</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipeline.addLast(<span class="keyword">new</span> <span class="title class_">HttpObjectAggregator</span>(<span class="number">8192</span>));</span><br></pre></td></tr></table></figure><ul><li><strong><code>HttpObjectAggregator</code></strong>：将多个 HTTP 消息段聚合为一个完整的 HTTP 请求或响应，最大聚合数据为 <code>8192</code> 字节。</li><li>解决了 HTTP 请求分段传输的问题（例如大型 POST 请求）。</li></ul><ol><li><strong>WebSocket 协议升级处理器</strong></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipeline.addLast(<span class="keyword">new</span> <span class="title class_">WebSocketServerProtocolHandler</span>(<span class="string">&quot;/&quot;</span>));</span><br></pre></td></tr></table></figure><ul><li><pre><code>WebSocketServerProtocolHandler<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  ：</span><br><span class="line"></span><br><span class="line">  - 将 HTTP 升级为 WebSocket 协议，处理握手和控制帧。</span><br><span class="line">  - URI 为 `/`，即处理 WebSocket 请求时使用 `ws://localhost:port/`。</span><br><span class="line">  - 使用状态码 `101` 表示协议切换成功。</span><br><span class="line"></span><br><span class="line">## 创建自定义处理器</span><br><span class="line"></span><br><span class="line">在`websocket`包下创建包`<span class="keyword">handler</span>`,然后创建类`NettyWebSocketServerHandler`(博主这里完整的路径为:`com.lambda.simplenetty.websocket.<span class="keyword">handler</span>.NettyWebSocketServerHandler`)</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="keyword">package</span> com.lambda.simplenetty.websocket.<span class="keyword">handler</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelHandler.Sharable;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.ChannelHandlerContext;</span><br><span class="line"><span class="keyword">import</span> io.netty.channel.SimpleChannelInboundHandler;</span><br><span class="line"><span class="keyword">import</span> io.netty.<span class="keyword">handler</span>.codec.http.websocketx.TextWebSocketFrame;</span><br><span class="line"><span class="keyword">import</span> io.netty.<span class="keyword">handler</span>.timeout.IdleState;</span><br><span class="line"><span class="keyword">import</span> io.netty.<span class="keyword">handler</span>.timeout.IdleStateEvent;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//SimpleChannelInboundHandler&lt;T&gt;消息处理完后会自动释放资源,而ChannelInboundHandlerAdapter处理ByteBuf需要自己显式释放消息(TextWebSocketFrame不需要)</span></span><br><span class="line"><span class="comment">//但是ChannelInboundHandlerAdapter适用于处理任意类型的消息,而SimpleChannelInboundHandler&lt;T&gt;泛型 T 指定了要处理的消息类型</span></span><br><span class="line"><span class="comment">//SimpleChannelInboundHandler&lt;T&gt;是而ChannelInboundHandlerAdapter的子类</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Sharable</span><span class="comment">//@Sharable 是 Netty 中的一个注解，用于标识 ChannelHandler 类可以在多个 Channel 中共享（即可以被多个 Channel 实例复用）</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NettyWebSocketServerHandler</span> <span class="keyword">extends</span> <span class="title">SimpleChannelInboundHandler</span>&lt;<span class="title">TextWebSocketFrame</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当连接被建立时调用。</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ctx ctx</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">handlerAdded</span><span class="params">(ChannelHandlerContext ctx)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//可以在这里做些初始化操作</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当 ChannelHandler 被从管道（ChannelPipeline）中移除时，Netty 会调用此方法。它通常在某些连接关闭或客户端断开连接时被触发</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ctx ctx</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">handlerRemoved</span><span class="params">(ChannelHandlerContext ctx)</span> </span>&#123;</span><br><span class="line">        log.warn(<span class="string">&quot;触发 handlerRemoved 掉线![&#123;&#125;]&quot;</span>, ctx.channel().id());</span><br><span class="line">        <span class="comment">//这里做一些下线处理,比如内存释放等</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当客户端的连接关闭或被服务器主动关闭时，Netty 会触发此方法。它是一个生命周期方法，表示客户端连接处于 非活动状态，即连接已经断开或失效</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ctx ctx</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">channelInactive</span><span class="params">(ChannelHandlerContext ctx)</span> </span>&#123;</span><br><span class="line">        log.warn(<span class="string">&quot;触发 channelInactive 掉线![&#123;&#125;]&quot;</span>, ctx.channel().id());</span><br><span class="line">        <span class="comment">//这里做一些下线处理,比如内存释放等</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 处理用户自定义事件或特殊事件</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ctx ChannelHandlerContext</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> evt Object</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">userEventTriggered</span><span class="params">(ChannelHandlerContext ctx, Object evt)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (evt <span class="keyword">instanceof</span> IdleStateEvent) &#123;</span><br><span class="line">            IdleStateEvent idleStateEvent = (IdleStateEvent) evt;</span><br><span class="line">            <span class="comment">// 读空闲</span></span><br><span class="line">            <span class="keyword">if</span> (idleStateEvent.state() == IdleState.READER_IDLE) &#123;</span><br><span class="line">                <span class="comment">// 关闭用户的连接,关闭连接记得做下线操作</span></span><br><span class="line">                log.info(<span class="string">&quot;未读取到用户心跳,正在关闭WebSocket连接,channelId:[&#123;&#125;]&quot;</span>, ctx.channel().id());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">super</span>.userEventTriggered(ctx, evt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取客户端发送的请求报文</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ctx ctx</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> msg 客户端发来的消息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">channelRead0</span><span class="params">(ChannelHandlerContext ctx, TextWebSocketFrame msg)</span> </span>&#123;</span><br><span class="line">        ctx.channel().writeAndFlush(<span class="keyword">new</span> TextWebSocketFrame(String.format(<span class="string">&quot;接收到用户发送来的信息,%s&quot;</span>, msg.text())));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre></li></ul><p>这里最重要的为<code>channelRead0</code>方法,我们主要在这个方法中处理客户端发送过来的消息,发送消息我们用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.channel().writeAndFlush(<span class="keyword">new</span> <span class="title class_">TextWebSocketFrame</span>(<span class="string">&quot;返回的消息&quot;</span>));</span><br></pre></td></tr></table></figure><h2 id="添加自定义处理器">添加自定义处理器</h2><p>修改<code>NettyWebSocketServer</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 服务器启动引导对象</span></span><br><span class="line">        <span class="type">ServerBootstrap</span> <span class="variable">serverBootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>();</span><br><span class="line">        serverBootstrap.group(<span class="built_in">this</span>.bossGroup, <span class="built_in">this</span>.workerGroup)</span><br><span class="line">                .channel(NioServerSocketChannel.class)</span><br><span class="line">                .option(ChannelOption.SO_BACKLOG, <span class="number">128</span>)</span><br><span class="line">                .option(ChannelOption.SO_KEEPALIVE, <span class="literal">true</span>)</span><br><span class="line">                .handler(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.INFO)) <span class="comment">// 为 bossGroup 添加 日志处理器</span></span><br><span class="line">                .childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel socketChannel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                        <span class="type">ChannelPipeline</span> <span class="variable">pipeline</span> <span class="operator">=</span> socketChannel.pipeline();</span><br><span class="line">                        <span class="comment">//30秒客户端没有向服务器发送心跳则关闭连接(需要的话则把这段打开)</span></span><br><span class="line"><span class="comment">//                        pipeline.addLast(new IdleStateHandler(30, 0, 0));</span></span><br><span class="line">                        <span class="comment">// 因为使用http协议，所以需要使用http的编码器，解码器</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">HttpServerCodec</span>());</span><br><span class="line">                        <span class="comment">// 以块方式写，添加 chunkedWriter 处理器</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">ChunkedWriteHandler</span>());</span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                         * 说明：</span></span><br><span class="line"><span class="comment">                         *  1. http数据在传输过程中是分段的，HttpObjectAggregator可以把多个段聚合起来；</span></span><br><span class="line"><span class="comment">                         *  2. 这就是为什么当浏览器发送大量数据时，就会发出多次 http请求的原因</span></span><br><span class="line"><span class="comment">                         */</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">HttpObjectAggregator</span>(<span class="number">8192</span>));</span><br><span class="line">                        <span class="comment">/**</span></span><br><span class="line"><span class="comment">                         * 说明：</span></span><br><span class="line"><span class="comment">                         *  1. 对于 WebSocket，它的数据是以帧frame 的形式传递的；</span></span><br><span class="line"><span class="comment">                         *  2. 可以看到 WebSocketFrame 下面有6个子类</span></span><br><span class="line"><span class="comment">                         *  3. 浏览器发送请求时： ws://localhost:7000/hello 表示请求的uri</span></span><br><span class="line"><span class="comment">                         *  4. WebSocketServerProtocolHandler 核心功能是把 http协议升级为 ws 协议，保持长连接；</span></span><br><span class="line"><span class="comment">                         *      是通过一个状态码 101 来切换的</span></span><br><span class="line"><span class="comment">                         */</span></span><br><span class="line">                        <span class="comment">//这个是Netty支持WebSocket的处理</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">WebSocketServerProtocolHandler</span>(<span class="string">&quot;/&quot;</span>));</span><br><span class="line">                        <span class="comment">//添加自定义处理器</span></span><br><span class="line">                        pipeline.addLast(<span class="keyword">new</span> <span class="title class_">NettyWebSocketServerHandler</span>());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="comment">// 启动服务器，监听端口，阻塞直到启动成功</span></span><br><span class="line">        serverBootstrap.bind(<span class="built_in">this</span>.port).sync();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>在<code>pipeline</code>中添加我们刚才创建的<code>NettyWebSocketServerHandler</code></p><h2 id="启动服务">启动服务</h2><p>接下来我们启动服务,然后打开<code>apifox</code>,新建个<code>websocket</code>接口,然后输入<code>ws://127.0.0.1:8090/</code>,点击连接</p><p><a href="https://lambda-image-1.pages.dev/image-20241204230756954.png"><img src="https://lambda-image-1.pages.dev/image-20241204230756954.png" alt="image-20241204230756954"></a></p><p>然后输入你要发送的消息,点击发送</p><p><a href="https://lambda-image-1.pages.dev/image-20241204231041515.png"><img src="https://lambda-image-1.pages.dev/image-20241204231041515.png" alt="image-20241204231041515"></a></p><p>至此,应该简单的基于<code>Netty</code>的<code>websocket</code>服务器就搭建完成了</p>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;最近要弄安卓的结课设计,里面刚好有要用&lt;code&gt;WebSocket&lt;/code&gt;实现一个简易聊天室的选题,正好之前学了&lt;code&gt;WebSocket&lt;/code&gt;没有总结笔记,因此写篇博客总结一下&lt;/p&gt;
&lt;h2 id=&quot;工具&quot;&gt;工具&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a</summary>
        
      
    
    
    
    <category term="后端开发" scheme="https://www.wikunkun.asia/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="Java" scheme="https://www.wikunkun.asia/tags/Java/"/>
    
    <category term="Netty" scheme="https://www.wikunkun.asia/tags/Netty/"/>
    
    <category term="SpringBoot" scheme="https://www.wikunkun.asia/tags/SpringBoot/"/>
    
  </entry>
  
  <entry>
    <title>安装Linux虚拟机</title>
    <link href="https://www.wikunkun.asia/posts/25452eac.html"/>
    <id>https://www.wikunkun.asia/posts/25452eac.html</id>
    <published>2024-12-19T01:59:38.000Z</published>
    <updated>2025-02-13T10:39:02.417Z</updated>
    
    <content type="html"><![CDATA[<h2 id="工具">工具</h2><ul><li>VMware-Workstation-Pro软件</li><li>Linux镜像</li></ul><h2 id="环境">环境</h2><ul><li>windows10</li></ul><h2 id="创建虚拟机">创建虚拟机</h2><p><strong>先按照以下图片的步骤进行</strong>,新建虚拟机后,选择<strong>自定义</strong>,然后下一步</p><p><a href="https://lambda-image-1.pages.dev/image-20240126155609399.png"><img src="https://lambda-image-1.pages.dev/image-20240126155609399.png" alt="image-20240126155609399"></a></p><p>这里<strong>不需要修改</strong>,直接下一步</p><p><a href="https://lambda-image-1.pages.dev/image-20240126155644271.png"><img src="https://lambda-image-1.pages.dev/image-20240126155644271.png" alt="image-20240126155644271"></a></p><p>选择<strong>稍后安装操作系统</strong>,然后下一步</p><p><a href="https://lambda-image-1.pages.dev/image-20240126155711444.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126155711444"></a></p><p>这里<strong>客户机操作系统</strong>选择<code>Linux</code>,然后版本选择你下载的**<code>Linux</code>镜像**的版本(博主这里为<code>CentOS7</code>)</p><p><a href="https://lambda-image-1.pages.dev/image-20240126155756335.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126155756335"></a></p><p>输入<strong>虚拟机的名称</strong>和<strong>安装的位置</strong></p><p><a href="https://lambda-image-1.pages.dev/image-20240126155908285.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126155908285"></a></p><p>接下来设置的<strong>内核数量</strong>根据自己电脑的情况来设置</p><p><a href="https://lambda-image-1.pages.dev/image-20240126160008911.png"><img src="https://lambda-image-1.pages.dev/image-20240126160008911.png" alt="image-20240126160008911"></a></p><p>博主这里最多14核</p><p><a href="https://lambda-image-1.pages.dev/image-20240126160110139.png"><img src="https://lambda-image-1.pages.dev/image-20240126160110139.png" alt="image-20240126160110139"></a></p><p>这里<strong>内存的设置</strong>也要根据电脑的情况来设置</p><p><a href="https://lambda-image-1.pages.dev/image-20240126160143915.png"><img src="https://lambda-image-1.pages.dev/image-20240126160143915.png" alt="image-20240126160143915"></a></p><p>这里最多分配40G</p><p><a href="https://lambda-image-1.pages.dev/image-20240126160215696.png"><img src="https://lambda-image-1.pages.dev/image-20240126160215696.png" alt="image-20240126160215696"></a></p><p><strong>网络连接</strong>选择<strong>使用网络地址转换(NAT)</strong></p><p><a href="https://lambda-image-1.pages.dev/image-20240126160234822.png"><img src="https://lambda-image-1.pages.dev/image-20240126160234822.png" alt="image-20240126160234822"></a></p><p><strong>I/O控制器类型</strong>选择默认推荐的</p><p><a href="https://lambda-image-1.pages.dev/image-20240126160246467.png"><img src="https://lambda-image-1.pages.dev/image-20240126160246467.png" alt="image-20240126160246467"></a></p><p><strong>磁盘类型</strong>也选择默认推荐的</p><p><a href="https://lambda-image-1.pages.dev/image-20240126160302640.png"><img src="https://lambda-image-1.pages.dev/image-20240126160302640.png" alt="image-20240126160302640"></a></p><p>选择<strong>创建新的虚拟磁盘</strong></p><p><a href="https://lambda-image-1.pages.dev/image-20240126160327687.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126160327687"></a></p><p><strong>指定磁盘的容量</strong>,这个根据个人的电脑情况来设置</p><p><a href="https://lambda-image-1.pages.dev/image-20240126160412211.png"><img src="https://lambda-image-1.pages.dev/image-20240126160412211.png" alt="image-20240126160412211"></a></p><h2 id="安装操作系统">安装操作系统</h2><p>点击<strong>CD/DVD(IDE)</strong></p><p><a href="https://lambda-image-1.pages.dev/image-20240126160438803.png"><img src="https://lambda-image-1.pages.dev/image-20240126160438803.png" alt="image-20240126160438803"></a></p><p>这里需要提前下载了<strong>CentOS 7</strong>的文件(其他的<strong>Linux镜像文件</strong>也可以)</p><p><a href="https://lambda-image-1.pages.dev/image-20240126160526954.png"><img src="https://lambda-image-1.pages.dev/image-20240126160526954.png" alt="image-20240126160526954"></a></p><h2 id="配置虚拟机的网络">配置虚拟机的网络</h2><p>点击<strong>编辑</strong>-&gt;<strong>虚拟网络编辑器</strong></p><p><a href="https://lambda-image-1.pages.dev/image-20240126160601491.png"><img src="https://lambda-image-1.pages.dev/image-20240126160601491.png" alt="image-20240126160601491"></a></p><p>这里推荐勾选上&quot;<strong>使用本地DHCP服务将IP地址分配给虚拟机</strong>&quot;,这样后面配置每个虚拟机的网络的时候可以直接抄,子网IP一般不用管,子网掩码也是</p><p><a href="https://lambda-image-1.pages.dev/image-20240126161019216.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126161019216"></a></p><p><a href="https://lambda-image-1.pages.dev/image-20240126161404577.png"><img src="https://lambda-image-1.pages.dev/image-20240126161404577.png" alt="image-20240126161404577"></a></p><h2 id="安装虚拟机">安装虚拟机</h2><h3 id="安装CentOS操作系统">安装CentOS操作系统</h3><p><a href="https://lambda-image-1.pages.dev/image-20240126161532972.png"><img src="https://lambda-image-1.pages.dev/image-20240126161532972.png" alt="image-20240126161532972"></a></p><p><a href="https://lambda-image-1.pages.dev/image-20240126161557884.png"><img src="https://lambda-image-1.pages.dev/image-20240126161557884.png" alt="image-20240126161557884"></a></p><p>这里要推荐选择&quot;虚拟化主机&quot;不然等虚拟机装好以后连一些基础的命令都没有</p><p><a href="https://lambda-image-1.pages.dev/image-20240126161629542.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126161629542"></a></p><p>这个进去点一下完成就行</p><p><a href="https://lambda-image-1.pages.dev/image-20240126161735294.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126161735294"></a></p><p><a href="https://lambda-image-1.pages.dev/image-20240126161746017.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126161746017"></a></p><p>这里是最重要的一步,这里没有配好,后面就要去配置文件中修改</p><p><a href="https://lambda-image-1.pages.dev/image-20240126161846632.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126161846632"></a></p><p><a href="https://lambda-image-1.pages.dev/image-20240126162104641.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126162104641"></a></p><p>开启以太网后</p><p><a href="https://lambda-image-1.pages.dev/image-20240126162222356.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126162222356"></a></p><p><a href="https://lambda-image-1.pages.dev/image-20240126162533864.png"><img src="https://lambda-image-1.pages.dev/image-20240126162533864.png" alt="image-20240126162533864"></a></p><p>之前直接安装,设置<code>roo</code>t密码就行</p><p><a href="https://lambda-image-1.pages.dev/image-20240126162637001.png"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="image-20240126162637001"></a></p><p>安装完成后需要进行测试,看能不能连上网</p><p>先看看IP地址和我们之前设置的是否一样,输入<code>ifconfig</code>,这边可以看到<code>ens33</code>的<code>ip</code>地址为<code>192.168.190.128</code>,和我们之前设置的一样</p><p><a href="https://lambda-image-1.pages.dev/image-20240126163141718.png"><img src="https://lambda-image-1.pages.dev/image-20240126163141718.png" alt="image-20240126163141718"></a></p><p>之后<code>ping</code>一下百度看看是否能ping通,输入<code>ping www.baidu.com</code>,这边可以看到可以<code>ping</code>通</p><p><a href="https://lambda-image-1.pages.dev/image-20240126163306529.png"><img src="https://lambda-image-1.pages.dev/image-20240126163306529.png" alt="image-20240126163306529"></a></p><p>之后在我们的电脑上(不是虚拟机里面)<code>WIN+R</code>,输入<code>cmd</code></p><p><a href="https://lambda-image-1.pages.dev/image-20240126163404483.png"><img src="https://lambda-image-1.pages.dev/image-20240126163404483.png" alt="image-20240126163404483"></a></p><p>我们需要<code>ping</code>一下虚拟机的IP地址看看能不能<code>ping</code>通,输入<code>ping 192.168.190.128</code>(这个ip地址输入你自己虚拟的的ip地址),可以看到我们这边可以<code>ping</code>通虚拟机,至此虚拟机的网络检测没有问题</p><p><a href="https://lambda-image-1.pages.dev/image-20240126163535692.png"><img src="https://lambda-image-1.pages.dev/image-20240126163535692.png" alt="image-20240126163535692"></a></p><h3 id="安装Ubuntu操作系统">安装Ubuntu操作系统</h3><h4 id="安装">安装</h4><p>选择<code>Try or Install Ubuntu Server</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112223453743.png" alt="image-20250112223453743"></p><p>选择<code>English</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112223544302.png" alt="image-20250112223544302"></p><p>选择<code>Continue without updating</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112223612360.png" alt="image-20250112223612360"></p><p>选择<code>Done</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112223641719.png" alt="image-20250112223641719"></p><p>选择默认的第一个<code>Ubuntu Server</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112223722920.png" alt="image-20250112223722920"></p><p>网络配置，使用 DHCP 或者静态IP,选择第一个,然后回车</p><p><img src="https://lambda-image-1.pages.dev/image-20250112223833908.png" alt="image-20250112223833908"></p><p>选择<code>Edit IPv4</code>然后回车</p><p><img src="https://lambda-image-1.pages.dev/image-20250112223859058.png" alt="image-20250112223859058"></p><p>选择<code>Manual</code>然后回车</p><p><img src="https://lambda-image-1.pages.dev/image-20250112223937375.png" alt="image-20250112223937375"></p><p>填写相关信息</p><p><img src="https://lambda-image-1.pages.dev/image-20250112224328676.png" alt="image-20250112224328676"></p><p>选择<code>Done</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112224344188.png" alt="image-20250112224344188"></p><p><code>Proxy address</code>不用配置</p><p><img src="https://lambda-image-1.pages.dev/image-20250112224406000.png" alt="image-20250112224406000"></p><p>设置镜像源地址，这个可以配置阿里云(<a href="http://mirrors.aliyun.com/ubuntu/">http://mirrors.aliyun.com/ubuntu/</a>)，下载加速**(非必须)**</p><p><img src="https://lambda-image-1.pages.dev/image-20250112224643708.png" alt="image-20250112224643708"></p><p>选择<code>Done</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112224728740.png" alt="image-20250112224728740"></p><p>选择<code>Done</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112224749999.png" alt="image-20250112224749999"></p><p>选择<code>Continue</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112224826478.png" alt="image-20250112224826478"></p><p>设置计算机名和用户以及密码</p><p><img src="https://lambda-image-1.pages.dev/image-20250112225005717.png" alt="image-20250112225005717"></p><p>选择<code>Continue</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112225024198.png" alt="image-20250112225024198"></p><p>按空格键选择<code>OpenSSH</code>,然后<code>Done</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112225100288.png" alt="image-20250112225100288"></p><p>选择<code>Done</code>,然后等待安装</p><p><img src="https://lambda-image-1.pages.dev/image-20250112225148628.png" alt="image-20250112225148628"></p><p>选择<code>Rebot Now</code></p><p><img src="https://lambda-image-1.pages.dev/image-20250112225501309.png" alt="image-20250112225501309"></p><p>输入账号密码登录</p><p><img src="https://lambda-image-1.pages.dev/image-20250112225649923.png" alt="image-20250112225649923"></p><p>检查网络是否正常</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping www.baidu.com</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250112225742502.png" alt="image-20250112225742502"></p><h4 id="设置免秘钥登录-非必须">设置免秘钥登录(非必须)</h4><p>编辑<code>/etc/ssh/sshd_config</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure><p>设置<code>PubkeyAuthentication</code>与<code>PasswordAuthentication</code>为<code>yes</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PubkeyAuthentication <span class="built_in">yes</span></span><br><span class="line">PasswordAuthentication <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250112231147015.png" alt="image-20250112231147015"></p><p>生成密钥</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250112231540820.png" alt="image-20250112231540820"></p><p>进入<code>.ssh</code>目录,可以看到密钥已经生成了</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> .ssh</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250112231646764.png" alt="image-20250112231646764"></p><p>但是这个密钥是<code>openssh</code>的，使用<code>MobaXterm</code>去连接的时候可能会导入密钥失败，这时就需要使用工具转换一下密钥</p><p>安装 putty 工具</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install -y putty</span><br></pre></td></tr></table></figure><p>密钥转化</p><p><strong><code>puttygen id_rsa -o ubuntu_id_rsa</code></strong></p><ul><li><strong><code>puttygen</code></strong>:<ul><li>一个用于生成和转换 SSH 密钥的工具，通常随 PuTTY 工具包一起提供。</li><li>它可以生成 PuTTY 专用格式（PPK）密钥，并支持将其他格式的密钥转换为 PPK 格式，或者反向转换。</li></ul></li><li><strong><code>id_rsa</code></strong>:<ul><li>输入文件，表示一个已有的 SSH 私钥文件（通常是 OpenSSH 格式）。</li></ul></li><li><strong><code>-o ubuntu_id_rsa</code></strong>:<ul><li><code>-o</code> 参数指定输出文件。</li><li><code>ubuntu_id_rsa</code> 是输出文件的名称，表示将 <code>id_rsa</code> 转换后保存为新的文件。</li></ul></li></ul><p><strong><code>puttygen ubuntu_id_rsa -O private-openssh -o ubuntu_id_rsa.pem</code></strong></p><ul><li><strong><code>puttygen</code></strong>:<ul><li>再次调用 <code>puttygen</code> 工具。</li></ul></li><li><strong><code>ubuntu_id_rsa</code></strong>:<ul><li>输入文件，表示一个 PuTTY 格式的私钥文件（PPK 格式）。</li></ul></li><li><strong><code>-O private-openssh</code></strong>:<ul><li>指定输出格式为 OpenSSH 的私钥格式。</li></ul></li><li><strong><code>-o ubuntu_id_rsa.pem</code></strong>:<ul><li>指定输出文件名称为 <code>ubuntu_id_rsa.pem</code>。</li></ul></li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#id_rsa为上面生成的文件</span></span><br><span class="line">puttygen id_rsa -o ubuntu_id_rsa</span><br><span class="line">puttygen ubuntu_id_rsa -O private-openssh -o ubuntu_id_rsa.pem</span><br></pre></td></tr></table></figure><p>将公钥导入指定文件</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> id_rsa.pub  &gt; authorized_keys</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-20250112232018680.png" alt="image-20250112232018680"></p><p>将密钥(<code>ubuntu_id_rsa.pem</code>)导出到本地</p><p><img src="https://lambda-image-1.pages.dev/image-20250112232511589.png" alt="image-20250112232511589"></p><h4 id="补充">补充</h4><p><strong>安装 ifconfig</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install net-tools</span><br></pre></td></tr></table></figure><p>查看IP</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br></pre></td></tr></table></figure><p><strong>开启root用户登录</strong></p><p>运行下方的命令,然后输入密码</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> passwd root</span><br></pre></td></tr></table></figure><p>修改sshd配置</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure><p>找到<code>#PermitRootLogin prohibit-password</code>,在下方添加以下内容</p><p><img src="https://lambda-image-1.pages.dev/image-20250112230406265.png" alt="image-20250112230406265"></p><p>重启<code>sshd</code>服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl restart sshd</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;工具&quot;&gt;工具&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;VMware-Workstation-Pro软件&lt;/li&gt;
&lt;li&gt;Linux镜像&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;环境&quot;&gt;环境&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;windows10&lt;/li&gt;
&lt;/ul&gt;
&lt;h2</summary>
        
      
    
    
    
    <category term="虚拟化技术" scheme="https://www.wikunkun.asia/categories/%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="Linux" scheme="https://www.wikunkun.asia/tags/Linux/"/>
    
    <category term="教程" scheme="https://www.wikunkun.asia/tags/%E6%95%99%E7%A8%8B/"/>
    
    <category term="虚拟机" scheme="https://www.wikunkun.asia/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"/>
    
    <category term="VMware" scheme="https://www.wikunkun.asia/tags/VMware/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu上安装V2rayA</title>
    <link href="https://www.wikunkun.asia/posts/20241127.html"/>
    <id>https://www.wikunkun.asia/posts/20241127.html</id>
    <published>2024-12-19T01:57:22.983Z</published>
    <updated>2025-02-13T10:39:02.425Z</updated>
    
    <content type="html"><![CDATA[<p>之前因为一些原因,需要在<code>Linux</code>上使用魔法,网上查询了很多关于这方面的资料,但是大部分都是 <code>Clash</code> 的,但是由于一些原来,导致现在<code>Clash</code>不可用,后面又去查了很多相关的资料,最终选择了<code>V2rayA</code>, 以下是 <code>V2rayA</code> 在<code>Ubuntu</code>上的安装教程</p><h2 id="工具">工具</h2><ul><li>一款 <code>SSH</code> 连接工具 (本文用 <code>MobaXterm</code>)</li><li>一台云服务器 (本文用阿里云 ECS 服务器)</li></ul><h2 id="环境">环境</h2><ul><li><code>Ubuntu22.04.4</code></li></ul><h2 id="安装V2ray">安装V2ray</h2><p>复制以下内容，并执行</p><h3 id="添加公钥">添加公钥</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -qO - https://apt.v2raya.org/key/public-key.asc | <span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/apt/keyrings/v2raya.asc</span><br></pre></td></tr></table></figure><h3 id="添加软件源">添加软件源</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;deb [signed-by=/etc/apt/keyrings/v2raya.asc] https://apt.v2raya.org/ v2raya main&quot;</span> | <span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/apt/sources.list.d/v2raya.list</span><br></pre></td></tr></table></figure><h3 id="更新">更新</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update</span><br></pre></td></tr></table></figure><h3 id="安装">安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install v2raya v2ray</span><br></pre></td></tr></table></figure><h3 id="配置">配置</h3><p>修改 /etc/default/v2raya 配置文件让 v2raya 使用 v2ray-core**(这一步非必须)**</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/default/v2raya</span><br></pre></td></tr></table></figure><p>添加配置两行配置</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">V2RAYA_V2RAY_BIN=/usr/local/v2ray-core/v2ray</span><br><span class="line">V2RAYA_V2RAY_CONFDIR=/usr/local/v2ray-core</span><br></pre></td></tr></table></figure><p>设置开机自启</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> --now v2raya</span><br></pre></td></tr></table></figure><p>–now 参数表示设置为开机启动并立即启动v2raya</p><h3 id="查看服务状态">查看服务状态</h3><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo<span class="keyword"> system</span>ctl status v2raya</span><br></pre></td></tr></table></figure><h3 id="使用-V2rayA">使用 V2rayA</h3><h4 id="访问-V2rayA">访问 V2rayA</h4><p>访问 <a href="http://ip:2017">http://ip:2017</a>, 在第一次进入页面时，你需要创建一个管理员账号，请妥善保管你的用户名密码，如果遗忘，可以使用 <code>sudo v2raya --reset-password</code> 命令重置。</p><h4 id="获取机场订阅-url">获取机场订阅 url</h4><p>可以试试看这些 <a href="https://github.com/sharkDoor/vpn-free-nodes">https://github.com/sharkDoor/vpn-free-nodes</a></p><h4 id="导入订阅-url-或-节点-url">导入订阅 url 或 节点 url</h4><p>根据以上指引获取到订阅 url 或节点 url 后，就可以导入订阅了，详细步骤参考以下截图。</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">订阅 URL 类似这样子: https://xxx.xxxx.com/api_version<span class="number">2</span>/xxxxxxxx?<span class="keyword">sub</span><span class="operator">=</span><span class="number">3</span>&amp;extend<span class="operator">=</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line">节点 URL 类似这样子:</span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">vmess:</span>//ew<span class="number">0</span>KICAxxxxxxxxxxbGN<span class="number">85</span>bm/<span class="number">5</span>pawMDJ<span class="number">8</span>MS<span class="number">4</span>xxxxxxxBsYy<span class="number">1</span>zZy<span class="number">5</span>nZXR<span class="number">4</span>bHgu</span><br><span class="line"><span class="symbol">trojan:</span>//<span class="number">224253</span>xxxxxx<span class="number">210</span>fca<span class="title">@xxxxp</span>:<span class="number">10060</span>#xxxxxx</span><br><span class="line"><span class="symbol">ss:</span>//xxxxxxxx<span class="operator">=</span><span class="title">@service.xxxxx.com</span>:<span class="number">50003</span>#xxxxxxx<span class="variable">%82</span><span class="variable">%2</span>B<span class="variable">%E7</span><span class="variable">%A7</span><span class="variable">%BB</span><span class="variable">%E5</span><span class="variable">%8</span>A<span class="variable">%A8</span></span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/import-servers.png" alt="import-servers"></p><h4 id="更新订阅">更新订阅</h4><p>有时候导入 URL 的时候会自动的更新订阅，有时候不会</p><p><img src="https://lambda-image-1.pages.dev/update-scribu.png" alt="update-scribu"></p><h4 id="测试节点的速度">测试节点的速度</h4><p>之后点击刚刚订阅的节点,然后把这里的节点全部勾选,<code>PING</code>来测试节点的速度</p><p><img src="https://lambda-image-1.pages.dev/image-1.png" alt="image-1"></p><h4 id="连接节点">连接节点</h4><p>选择一个延迟低的节点</p><p><img src="https://lambda-image-1.pages.dev/image-2.png" alt="image-2"></p><p>然后点击左上方的就绪</p><p><img src="https://lambda-image-1.pages.dev/image-4.png" alt="image-4"></p><p>启动后选择的节点颜色会变成蓝色</p><h4 id="测试是否成功">测试是否成功</h4><p>首先查看我们的代理端口 (魔法端口)</p><p>点击右上角的<strong>设置</strong> , 然后在弹出来的窗口上点击<strong>地址与端口</strong></p><p><img src="https://lambda-image-1.pages.dev/image-5.png" alt="image-5"></p><p>然后再 <code>Linux</code> 上执行以下命令 (端口改为上面的 <code>http</code> 端口，比如我这里的是 <strong>20171</strong>, 因此我的命令就为 curl -v -x <a href="http://127.0.0.1:20171">http://127.0.0.1:20171</a> <a href="https://www.google.com">https://www.google.com</a>)</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -v -x http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span>:端口 https:<span class="regexp">//</span>www.google.com</span><br></pre></td></tr></table></figure><p><img src="https://lambda-image-1.pages.dev/image-6.png" alt="image-6">执行完后如果能看到一堆内容，则代表成功</p><h4 id="配置代理">配置代理</h4><p>上面我们测试时请求 <a href="https://www.google.com">https://www.google.com</a> 是需要我们指定代理端口的，如果我们直接请求，是<strong>不会走代理</strong>，可以去执行下 curl <a href="https://www.google.com">https://www.google.com</a> 这个试试，你会发现执行后根本看不到任何内容，因为这个请求压根就没有经过我们的节点转发，现在这种请求是，我们访问一些网站要走代理的话，必须要手动的指定代理，这样太麻烦了，因此接下来我们需要配置下 <code>V2rayA</code> 让他自动的对我们的请求进行转发</p><p>点击左上角的<strong>设置</strong>，把<strong>系统代理</strong>部分改成<strong>大陆白名单模式</strong> , 并且记得勾选开启 <strong>IP 转发</strong> , 然后<strong>保存</strong></p><p><img src="https://lambda-image-1.pages.dev/image-7.png" alt="image-7"></p><p>之后我们继续执行 <code>curl https://www.google.com</code> 就可以正常的访问了</p>]]></content>
    
    
    <summary type="html">本文记录了博主目前用Docker部署过的全部内容</summary>
    
    
    
    <category term="Linux平台开发" scheme="https://www.wikunkun.asia/categories/Linux%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="Linux" scheme="https://www.wikunkun.asia/tags/Linux/"/>
    
    <category term="网络代理" scheme="https://www.wikunkun.asia/tags/%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86/"/>
    
    <category term="V2ray" scheme="https://www.wikunkun.asia/tags/V2ray/"/>
    
    <category term="工具安装" scheme="https://www.wikunkun.asia/tags/%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85/"/>
    
  </entry>
  
  <entry>
    <title>MarkDown中的数学符号</title>
    <link href="https://www.wikunkun.asia/posts/ebcd8e7e.html"/>
    <id>https://www.wikunkun.asia/posts/ebcd8e7e.html</id>
    <published>2024-12-18T14:03:01.000Z</published>
    <updated>2025-02-13T10:47:20.312Z</updated>
    
    <content type="html"><![CDATA[<p>因为有时会在Markdown中编写数学公式,但是自己又老是记不住一些公式的对应写法,因此特意把目前用过的内容记录下来</p><h2 id="排版环境">排版环境</h2><h3 id="align">align</h3><p>用于对齐多个公式,带有编号</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align}<br>x+y=1<br>\\y=0<br>\end{align}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align&#125;</span><br><span class="line">x+y=1</span><br><span class="line"><span class="keyword">\\</span>y=0</span><br><span class="line"><span class="keyword">\end</span>&#123;align&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="align-2">align*</h3><p>用于对齐多个公式,不带有编号</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>x+y=1<br>\\y=0<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">x+y=1</span><br><span class="line"><span class="keyword">\\</span>y=0</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="gather">gather</h3><p>用于对齐多个公式，公式居中对齐,带有编号</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{gather}<br>x+y=1<br>\\y=0<br>\end{gather}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;gather&#125;</span><br><span class="line">x+y=1</span><br><span class="line"><span class="keyword">\\</span>y=0</span><br><span class="line"><span class="keyword">\end</span>&#123;gather&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="gather-2">gather*</h3><p>用于对齐多个公式，公式居中对齐,不带有编号</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{gather*}<br>x+y=1<br>\\y=0<br>\end{gather*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;gather*&#125;</span><br><span class="line">x+y=1</span><br><span class="line"><span class="keyword">\\</span>y=0</span><br><span class="line"><span class="keyword">\end</span>&#123;gather*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="matrix">matrix</h3><p>用于对齐多个公式，公式居中对齐</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{matrix}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f \\<br>g &amp; h &amp; i<br>\end{matrix}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;matrix&#125;</span><br><span class="line">a <span class="built_in">&amp;</span> b <span class="built_in">&amp;</span> c <span class="keyword">\\</span></span><br><span class="line">d <span class="built_in">&amp;</span> e <span class="built_in">&amp;</span> f <span class="keyword">\\</span></span><br><span class="line">g <span class="built_in">&amp;</span> h <span class="built_in">&amp;</span> i</span><br><span class="line"><span class="keyword">\end</span>&#123;matrix&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="pmatrix">pmatrix</h3><p>用于排版带不同括号样式的矩阵pmatrix–&gt;圆括号</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{pmatrix}<br>a &amp; b \\<br>c &amp; d<br>\end{pmatrix}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;pmatrix&#125;</span><br><span class="line">a <span class="built_in">&amp;</span> b <span class="keyword">\\</span></span><br><span class="line">c <span class="built_in">&amp;</span> d</span><br><span class="line"><span class="keyword">\end</span>&#123;pmatrix&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="bmatrix">bmatrix</h3><p>用于排版带不同括号样式的矩阵bmatrix–&gt;方括号</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{bmatrix}<br>a &amp; b \\<br>c &amp; d<br>\end{bmatrix}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;bmatrix&#125;</span><br><span class="line">a <span class="built_in">&amp;</span> b <span class="keyword">\\</span></span><br><span class="line">c <span class="built_in">&amp;</span> d</span><br><span class="line"><span class="keyword">\end</span>&#123;bmatrix&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="vmatrix">vmatrix</h3><p>用于排版带不同括号样式的矩阵vmatrix–&gt;竖线</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{vmatrix}<br>a &amp; b \\<br>c &amp; d<br>\end{vmatrix}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;vmatrix&#125;</span><br><span class="line">a <span class="built_in">&amp;</span> b <span class="keyword">\\</span></span><br><span class="line">c <span class="built_in">&amp;</span> d</span><br><span class="line"><span class="keyword">\end</span>&#123;vmatrix&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="cases">cases</h3><p>用于分段函数的定义</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{cases}<br>x^2 &amp;  x \geq 0 \\<br>-x &amp;  x &lt; 0<br>\end{cases}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;cases&#125;</span><br><span class="line">x<span class="built_in">^</span>2 <span class="built_in">&amp;</span>  x <span class="keyword">\geq</span> 0 <span class="keyword">\\</span></span><br><span class="line">-x <span class="built_in">&amp;</span>  x &lt; 0</span><br><span class="line"><span class="keyword">\end</span>&#123;cases&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="array">array</h3><p>用于排版表格和数组</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{array}{ccc}<br>a &amp; b &amp; c \\<br>d &amp; e &amp; f \\<br>g &amp; h &amp; i<br>\end{array}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;array&#125;&#123;ccc&#125;</span><br><span class="line">a <span class="built_in">&amp;</span> b <span class="built_in">&amp;</span> c <span class="keyword">\\</span></span><br><span class="line">d <span class="built_in">&amp;</span> e <span class="built_in">&amp;</span> f <span class="keyword">\\</span></span><br><span class="line">g <span class="built_in">&amp;</span> h <span class="built_in">&amp;</span> i</span><br><span class="line"><span class="keyword">\end</span>&#123;array&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="基本符号">基本符号</h2><h3 id="四则运算">四则运算</h3><h4 id="加法">加法</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>+<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">+</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="减法">减法</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>－<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">－</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="乘法">乘法</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\times<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\times</span></span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="除法">除法</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\div<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\div</span></span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="斜线除法">斜线除法</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\frac{a}{b}<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\frac</span>&#123;a&#125;&#123;b&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="正负号">正负号</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\pm<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\pm</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="负正号">负正号</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\mp<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\mp</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="点乘">点乘</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\cdot<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\cdot</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="指数和对数">指数和对数</h3><h4 id="指数">指数</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>a^b<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line">a<span class="built_in">^</span>b</span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="对数">对数</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\log x \\<br>\ln x<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\log</span> x <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\ln</span> x</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="根号和其他开方">根号和其他开方</h3><h4 id="平方根">平方根</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\sqrt{x}<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\sqrt</span>&#123;x&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="n-次根">n 次根</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\sqrt[n]{x}<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\sqrt</span>[n]&#123;x&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="极限、求和与积分">极限、求和与积分</h3><h4 id="极限">极限</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\lim_{x \to \infty} f(x)<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\lim</span><span class="built_in">_</span>&#123;x <span class="keyword">\to</span> <span class="keyword">\infty</span>&#125; f(x)</span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="求和">求和</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\sum_{i=1}^{n} a_i<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\sum</span><span class="built_in">_</span>&#123;i=1&#125;<span class="built_in">^</span>&#123;n&#125; a<span class="built_in">_</span>i</span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="积分">积分</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\int_0^1 f(x) , dx<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\int</span><span class="built_in">_</span>0<span class="built_in">^</span>1 f(x) <span class="keyword">\,</span> dx</span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="偏导数">偏导数</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\frac{\partial}{\partial x} f(x)<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\frac</span>&#123;<span class="keyword">\partial</span>&#125;&#123;<span class="keyword">\partial</span> x&#125; f(x) </span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="关系符号">关系符号</h3><h4 id="等于-不等于-大于-小于-大于等于-小于等于">等于,不等于,大于,小于,大于等于,小于等于</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>＝ \\<br>\neq \\<br>＞ \\<br>＜ \\<br>\geq \\<br>\leq \\<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">＝ <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\neq</span> <span class="keyword">\\</span></span><br><span class="line">&gt; <span class="keyword">\\</span></span><br><span class="line">&lt; <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\geq</span> <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\leq</span> <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="远远小于">远远小于</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\ll<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\ll</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="远远大于">远远大于</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\gg<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\gg</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="近似等于">近似等于</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\approx<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\approx</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="同义等号">同义等号</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\equiv<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\equiv</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="恒等于">恒等于</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\triangleq<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\triangleq</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="集合符号">集合符号</h3><h4 id="包含于-不包含于">包含于,不包含于</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\in \\<br>\notin<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\in</span> <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\notin</span></span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="属于全集-不属于全集">属于全集,不属于全集</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\subset \\<br>\supset<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\subset</span> <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\supset</span></span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="逻辑符号">逻辑符号</h3><h4 id="与-或-非-蕴含-等价">与,或,非,蕴含,等价</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\land \\<br>\lor \\<br>\neg \\<br>\Rightarrow \\<br>\Leftrightarrow<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\land</span> <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\lor</span> <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\neg</span> <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\Rightarrow</span> <span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\Leftrightarrow</span></span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="其他常见符号">其他常见符号</h3><h4 id="无穷大">无穷大</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\infty<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\infty</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="空集合">空集合</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\emptyset<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\emptyset</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="自然数、整数、实数">自然数、整数、实数</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\mathbb{N} \\<br>\mathbb{Z} \\<br>\mathbb{R}<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\mathbb</span>&#123;N&#125; <span class="keyword">\\</span><span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathbb</span>&#123;Z&#125; <span class="keyword">\\</span><span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\mathbb</span>&#123;R&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="任意常数符号">任意常数符号</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>C<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line">C</span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="对称差">对称差</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\oplus<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\oplus</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="函数符号">函数符号</h3><h4 id="三角函数">三角函数</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\sin x \\<br>\cos x \\<br>\tan x \\<br>\cot x \\<br>\sec x \\<br>\csc x<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\sin</span> x <span class="keyword">\\</span><span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\cos</span> x <span class="keyword">\\</span><span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\tan</span> x <span class="keyword">\\</span><span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\cot</span> x <span class="keyword">\\</span><span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\sec</span> x <span class="keyword">\\</span><span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\csc</span> x</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="反三角函数">反三角函数</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\arcsin x \\<br>\arccos x \\<br>\arctan x<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\arcsin</span> x <span class="keyword">\\</span><span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\arccos</span> x <span class="keyword">\\</span><span class="keyword">\\</span></span><br><span class="line"><span class="keyword">\arctan</span> x </span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="箭头符号">箭头符号</h3><h4 id="右箭头">右箭头</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\to<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\to</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="左箭头">左箭头</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\gets<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\gets</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="上箭头">上箭头</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\uparrow<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\uparrow</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="下箭头">下箭头</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\downarrow<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\downarrow</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="特殊组合符号">特殊组合符号</h3><h4 id="直和">直和</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\oplus<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\oplus</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="张量积">张量积</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\otimes<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\otimes</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h4 id="点积">点积</h4><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{equation*}<br>\odot<br>\end{equation*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;equation*&#125;</span><br><span class="line"><span class="keyword">\odot</span></span><br><span class="line"><span class="keyword">\end</span>&#123;equation*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="下标和上标表达式">下标和上标表达式</h2><h3 id="单字符符号的下标">单字符符号的下标</h3><p>如果符号是单个字符，可以直接使用 <code>_</code> 加下标</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>x_1<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">x<span class="built_in">_</span>1</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="多字符符号的下标">多字符符号的下标</h3><p>如果下标包含多个字符或表达式，需要使用花括号 <code>&#123;&#125;</code> 将下标内容括起来</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>x_{10} \\<br>a_{i+1} \\<br>b_{n^2}<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">x<span class="built_in">_</span>&#123;10&#125; <span class="keyword">\\</span> </span><br><span class="line">a<span class="built_in">_</span>&#123;i+1&#125; <span class="keyword">\\</span></span><br><span class="line">b<span class="built_in">_</span>&#123;n<span class="built_in">^</span>2&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="给符号加上下标和上标">给符号加上下标和上标</h3><p>同时添加上下标时，上标用 <code>^</code>，下标用 <code>_</code>，两者可以组合使用</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>x_i^2 \\<br>a_{i+1}^n<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">x<span class="built_in">_</span>i<span class="built_in">^</span>2 <span class="keyword">\\</span></span><br><span class="line">a<span class="built_in">_</span>&#123;i+1&#125;<span class="built_in">^</span>n</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="文字内容作为下标">文字内容作为下标</h3><p>同时添加上下标时，上标用 <code>^</code>，下标用 <code>_</code>，两者可以组合使用</p><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>x_{min} \\<br>y_{max}<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">x<span class="built_in">_</span>&#123;min&#125; <span class="keyword">\\</span><span class="keyword">\\</span> </span><br><span class="line">y<span class="built_in">_</span>&#123;max&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="其他">其他</h2><h3 id="下划线">下划线</h3><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\underline{文本内容}<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="keyword">\underline</span>&#123;文本内容&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="水平空白命令">水平空白命令</h3><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>start\hspace{1cm}end<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line">start<span class="keyword">\hspace</span>&#123;1cm&#125;end</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="加粗">加粗</h3><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>&amp;\textbf{这是加粗的文本} \<br>&amp;这是未加粗的文本<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;align*&#125;</span><br><span class="line"><span class="built_in">&amp;</span><span class="keyword">\textbf</span>&#123;这是加粗的文本&#125; <span class="keyword">\\</span></span><br><span class="line"><span class="built_in">&amp;</span>这是未加粗的文本</span><br><span class="line"><span class="keyword">\end</span>&#123;align*&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="希腊字母">希腊字母</h2><h3 id="小写希腊字母">小写希腊字母</h3><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-2">表格</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>$$<br>\begin{align*}<br>\alpha \\<br>\beta \\<br>\gamma \\<br>\delta \\<br>\epsilon \\<br>\zeta \\<br>\eta \\<br>\theta \\<br>\iota \\<br>\kappa \\<br>\lambda \\<br>\mu \\<br>\nu \\<br>\xi \\<br>\pi \\<br>\rho \\<br>\sigma \\<br>\tau \\<br>\upsilon \\<br>\phi \\<br>\chi \\<br>\psi \\<br>\omega \\<br>\Gamma<br>\end{align*}<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><table><thead><tr><th>符号</th><th>LaTeX 命令</th></tr></thead><tbody><tr><td>α</td><td><code>\alpha</code></td></tr><tr><td>β</td><td><code>\beta</code></td></tr><tr><td>γ</td><td><code>\gamma</code></td></tr><tr><td>δ</td><td><code>\delta</code></td></tr><tr><td>ε</td><td><code>\epsilon</code></td></tr><tr><td>ζ</td><td><code>\zeta</code></td></tr><tr><td>η</td><td><code>\eta</code></td></tr><tr><td>θ</td><td><code>\theta</code></td></tr><tr><td>ι</td><td><code>\iota</code></td></tr><tr><td>κ</td><td><code>\kappa</code></td></tr><tr><td>λ</td><td><code>\lambda</code></td></tr><tr><td>μ</td><td><code>\mu</code></td></tr><tr><td>ν</td><td><code>\nu</code></td></tr><tr><td>ξ</td><td><code>\xi</code></td></tr><tr><td>ο</td><td><code>o</code> (普通字母)</td></tr><tr><td>π</td><td><code>\pi</code></td></tr><tr><td>ρ</td><td><code>\rho</code></td></tr><tr><td>σ</td><td><code>\sigma</code></td></tr><tr><td>τ</td><td><code>\tau</code></td></tr><tr><td>υ</td><td><code>\upsilon</code></td></tr><tr><td>φ</td><td><code>\phi</code></td></tr><tr><td>χ</td><td><code>\chi</code></td></tr><tr><td>ψ</td><td><code>\psi</code></td></tr><tr><td>ω</td><td><code>\omega</code></td></tr><tr><td>Γ</td><td><code>\Gamma</code></td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;因为有时会在Markdown中编写数学公式,但是自己又老是记不住一些公式的对应写法,因此特意把目前用过的内容记录下来&lt;/p&gt;
&lt;h2 id=&quot;排版环境&quot;&gt;排版环境&lt;/h2&gt;
&lt;h3</summary>
        
      
    
    
    
    <category term="数学" scheme="https://www.wikunkun.asia/categories/%E6%95%B0%E5%AD%A6/"/>
    
    
    <category term="Markdown" scheme="https://www.wikunkun.asia/tags/Markdown/"/>
    
    <category term="演示" scheme="https://www.wikunkun.asia/tags/%E6%BC%94%E7%A4%BA/"/>
    
  </entry>
  
</feed>
